<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/page/9/index.html">
<meta property="og:site_name" content="Hexo">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/page/9/"/>

  <title> Hexo </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Hexo</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/01/17/后缀表达式的转换与求值/" itemprop="url">
                  后缀表达式的转换与求值
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-01-17T22:05:16+08:00" content="2015-01-17">
              2015-01-17
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/算法分析/" itemprop="url" rel="index">
                    <span itemprop="name">算法分析</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="中缀转后缀"><a href="#中缀转后缀" class="headerlink" title="中缀转后缀"></a>中缀转后缀</h2><p>　　类似于<code>(2+3)</code>这样的表达式称为中缀表达式，将这样的表达式转换为后缀表达式就是<code>2 3+</code>，其结果也就是<code>5</code>。使用后缀表达式更容易对表达式进行求值，通常我们可以将中缀表达式转换成为后缀表达式，再利用后缀表达式进行求值。<br>　　为此，我们定义一个<code>Calculator</code>类：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;functional&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">class</span> Calculator</div><div class="line">&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    Calculator() = <span class="keyword">default</span>;</div><div class="line">    <span class="function"><span class="keyword">double</span> <span class="title">calculatePostfix</span><span class="params">( <span class="keyword">const</span> <span class="built_in">string</span> &amp; )</span> <span class="keyword">const</span></span>;</div><div class="line">    <span class="function"><span class="built_in">string</span> <span class="title">infixToPostfix</span><span class="params">( <span class="keyword">const</span> <span class="built_in">string</span> &amp; )</span> <span class="keyword">const</span></span>;</div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isOperator</span><span class="params">( <span class="keyword">char</span> ops )</span> <span class="keyword">const</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> binops.find( ops ) != binops.cend();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isDigit</span><span class="params">( <span class="keyword">char</span> dig )</span> <span class="keyword">const</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> digits.find( dig ) != <span class="built_in">string</span>::npos;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">const</span> <span class="built_in">string</span> digits = <span class="string">".0123456789"</span>;</div><div class="line">    <span class="keyword">const</span> <span class="built_in">map</span>&lt;<span class="keyword">char</span>, function&lt;<span class="keyword">double</span> (<span class="keyword">double</span>, <span class="keyword">double</span>)&gt;&gt; binops = &#123;</div><div class="line">        &#123; <span class="string">'+'</span>, plus&lt;<span class="keyword">double</span>&gt;() &#125;, &#123; <span class="string">'-'</span>, minus&lt;<span class="keyword">double</span>&gt;() &#125;,</div><div class="line">        &#123; <span class="string">'*'</span>, multiplies&lt;<span class="keyword">double</span>&gt;() &#125;, &#123; <span class="string">'/'</span>, divides&lt;<span class="keyword">double</span>&gt;() &#125;</div><div class="line">    &#125;;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>　　我们可以使用<code>Calculator</code>的<code>infixToPostfix()</code>成员函数将中缀表达式转换成为后缀表达式。将中缀表达式转换成为后缀表达式的过程为：</p>
<ul>
<li>从做到右依次处理每个运算符或数值。</li>
<li>在处理的过程忽略<code>(</code>运算符。</li>
<li>若遇到数值则直接将数值拼接到结果中。</li>
<li>若遇到<code>)</code>运算符，则从栈中弹出运算符，并将运算符拼接到结果中。</li>
<li>遇到除了<code>(</code>和<code>)</code>之外的运算符，则将运算符压入栈底。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">string</span> Calculator::infixToPostfix( <span class="keyword">const</span> <span class="built_in">string</span> &amp;infix ) <span class="keyword">const</span> &#123;</div><div class="line">    <span class="built_in">string</span> postfix;</div><div class="line">    <span class="built_in">stack</span>&lt;<span class="keyword">char</span>&gt; operators;</div><div class="line">    <span class="keyword">int</span> left = <span class="number">0</span>, right = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>( <span class="built_in">string</span>::size_type i = <span class="number">0</span>; i &lt; infix.size(); ++i ) &#123;</div><div class="line">        <span class="keyword">if</span>( isDigit( infix[i] ) ) &#123;</div><div class="line">            <span class="keyword">size_t</span> offset;</div><div class="line">            stod( infix.substr( i ), &amp;offset );</div><div class="line">            postfix.append( infix.substr( i, offset ) );</div><div class="line">            postfix.append( <span class="string">" "</span> );</div><div class="line">            i += (offset - <span class="number">1</span>);</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>( isOperator( infix[i] ) ) &#123;</div><div class="line">            operators.push( infix[i] );</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>( infix[i] == <span class="string">')'</span> )&#123;</div><div class="line">            postfix.push_back( operators.top() );</div><div class="line">            operators.pop();</div><div class="line">            postfix.append( <span class="string">" "</span> );</div><div class="line">            ++right;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>( infix[i] == <span class="string">'('</span> ) &#123;</div><div class="line">            ++left;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>( infix[i] != <span class="string">' '</span> ) &#123;</div><div class="line">            <span class="keyword">throw</span> runtime_error( <span class="built_in">string</span>(<span class="string">"Invalid character: "</span>) + infix[i] );</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// if parentheses's number can't match, we throw exception</span></div><div class="line">    <span class="keyword">if</span>( left != right ) &#123;</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; left &lt;&lt; <span class="string">" "</span> &lt;&lt; right &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">        <span class="keyword">throw</span> runtime_error( <span class="string">"Invalid expression: Parentheses number can't match."</span> );   </div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> postfix;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="后缀的求值"><a href="#后缀的求值" class="headerlink" title="后缀的求值"></a>后缀的求值</h2><p>　　前面我们已经可以将中缀表达式转换成为后缀表达式了，那么现在就可以直接对后缀表达式进行求值。<br>　　实际的处理算法为：</p>
<ul>
<li>从左到右依次处理每个数值或运算符。</li>
<li>若是数值，则将数值压入栈底。</li>
<li>若是运算符，则从栈中弹出两个数值，根据运算符对两个数值做算术运算，并将所得到的结果压入栈底。</li>
</ul>
<p>　　我们实现<code>Calculator</code>的<code>calculatePostfix()</code>成员函数：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">double</span> Calculator::calculatePostfix( <span class="keyword">const</span> <span class="built_in">string</span> &amp;postfix ) <span class="keyword">const</span> &#123;</div><div class="line">    <span class="built_in">stack</span>&lt;<span class="keyword">double</span>&gt; operands;</div><div class="line">    <span class="keyword">for</span>( <span class="built_in">string</span>::size_type i = <span class="number">0</span>; i &lt; postfix.size(); ++i ) &#123;</div><div class="line">        <span class="keyword">if</span>( isOperator( postfix[i] ) ) &#123;</div><div class="line">            <span class="keyword">double</span> first = operands.top();</div><div class="line">            operands.pop();</div><div class="line">            <span class="keyword">double</span> second = operands.top();</div><div class="line">            operands.pop();</div><div class="line">            <span class="keyword">if</span>( postfix[i] == <span class="string">'/'</span> &amp;&amp; first == <span class="number">0.0</span> ) &#123;</div><div class="line">                <span class="keyword">throw</span> runtime_error( <span class="string">"Invalid expression: can't devided by zero!"</span> );</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">auto</span> ops = binops.find( postfix[i] );</div><div class="line">                operands.push( (ops-&gt;second)( second, first ) );</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>( isDigit( postfix[i] ) ) &#123;</div><div class="line">            <span class="keyword">size_t</span> offset;</div><div class="line">            operands.push( stod( postfix.substr( i ), &amp;offset ) );</div><div class="line">            i += offset;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>( postfix[i] != <span class="string">' '</span> ) &#123;</div><div class="line">            <span class="keyword">throw</span> runtime_error( <span class="built_in">string</span>(<span class="string">"Invalid character: "</span>) + postfix[i] );</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> operands.top();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>　　好了，现在我们可以编写一个测试程序，用来验证前面的算法：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></div><div class="line">&#123;</div><div class="line">    Calculator calculator;</div><div class="line">    <span class="built_in">string</span> infix;</div><div class="line"></div><div class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"Enter the infix expression :\n&gt;&gt;&gt; "</span>;</div><div class="line">    <span class="keyword">while</span>( getline( <span class="built_in">cin</span>, infix ) ) &#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            <span class="built_in">string</span> postfix = calculator.infixToPostfix( infix );</div><div class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">"The corresponding postfix expression is :"</span> &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">            <span class="built_in">cout</span> &lt;&lt; postfix &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">"The result is : "</span> &lt;&lt; calculator.calculatePostfix( postfix ) &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">        &#125; <span class="keyword">catch</span>( <span class="keyword">const</span> exception &amp;e ) &#123;</div><div class="line">            <span class="built_in">cerr</span> &lt;&lt; e.what() &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span> &lt;&lt; <span class="string">"Enter the infix expression :\n&gt;&gt;&gt; "</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>　　运行程序，可以看到：<br><img src="/images/data-structure/oop.png" alt=""><br>　　可以看到，程序首先将中缀表达式转换成为后缀表达式，再对后缀表达式进行求值。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="http://www.amazon.com/Algorithms-Parts-1-4-Fundamentals-Structure/dp/0201350882" target="_blank" rel="external">Algorithms in C++ 3rd Edition by Robert Sedgewick</a><br><a href="http://book.douban.com/subject/25708312/" target="_blank" rel="external">C++ Primer 5th Edition</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/01/14/union-find算法/" itemprop="url">
                  Union-Find算法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-01-14T22:11:05+08:00" content="2015-01-14">
              2015-01-14
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/算法分析/" itemprop="url" rel="index">
                    <span itemprop="name">算法分析</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Union-Find算法"><a href="#Union-Find算法" class="headerlink" title="Union-Find算法"></a>Union-Find算法</h2><p>　　在一个连通网络中，如果存在链路，使得一个节点能通过这条链路到达另一个节点，那么我们就说这两个节点之间是连通的。在连通性问题中，通常需要判断给定的两个节点是否已经连通，这个过程称为查找<code>(find)</code>操作，此外，若两个点并没有连通，我们可以创建连通这两个节点的链路，从而使得这两个节点处于连通状态，这个过程称为合并<code>(union)</code>操作。在执行合并操作之后，网络处于新的连接状态，这时，我们就可以根据更新后的网络的状态，来判断给定的其它两个节点之间是否连通了。<br>　　为了简化处理，我们可以使用整数来给网络中的节点进行编号。首先，我们给出一个测试程序，程序每次都会要求用户输入一对整数，并且执行以下操作：</p>
<ul>
<li>判断这对整数代表的节点是否处于连通状态，这就是查找操作。</li>
<li>若这两个点没有连通，那么执行合并操作，使得这两个点处于连通状态。 <figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"UnionFind.hpp"</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="function">UnionFind <span class="title">uf</span><span class="params">(<span class="number">10000</span>)</span></span>;                     <span class="comment">// 10000 nodes</span></div><div class="line">    <span class="keyword">int</span> p, q;</div><div class="line">    <span class="keyword">while</span>( <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; p &gt;&gt; q ) &#123;</div><div class="line">        <span class="keyword">if</span>( uf.find( p, q ) ) &#123;</div><div class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"connection "</span> &lt;&lt; p &lt;&lt; <span class="string">"-"</span> &lt;&lt; q &lt;&lt; <span class="string">" already exist!"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            uf.unite( p, q );</div><div class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"new connection: "</span> &lt;&lt; p &lt;&lt; <span class="string">"-"</span> &lt;&lt; q &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>　　我们可以使用简单的输入来测试程序，输入的两个整数代表两个节点，若这两个节点尚未连通，那么程序就会负责连通这两个点，若这两个点已经连通，则输出提示信息：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">4 5</div><div class="line">new connection: 4-5</div><div class="line">2 4</div><div class="line">new connection: 2-4</div><div class="line">2 5</div><div class="line">connection 2-5 already exist!</div><div class="line">3 1</div><div class="line">new connection: 3-1</div><div class="line">3 4</div><div class="line">new connection: 3-4</div><div class="line">1 2</div><div class="line">connection 1-2 already exist!</div></pre></td></tr></table></figure></p>
<p>　　我们可以用下图<code>1.1</code>来表示对节点执行合并操作的过程，从中可以看到，节点之间的连通是具有传递性，最后，图中的<code>5</code>个节点都处于互通的状态：<br><img src="/images/data-structure/uf1.png" alt=""></p>
<h2 id="Quick-Find算法"><a href="#Quick-Find算法" class="headerlink" title="Quick-Find算法"></a>Quick-Find算法</h2><p>　　在<code>Quick-Find</code>算法中，我们使用数组来表示所有节点的集合，在一开始，数组中的元素的值各不相同，这表示所有的节点均不连通，很显然，要是数组中存在相同的元素值，那么就表示这些元素所代表节点是互通的。由此，判断两个节点是否连通(即查找操作)就变得相当简单，只需要判断数组中的这两项元素的值是否相同，相同就表示它们是连通的。此外，要是这两个节点(假设为<code>A</code>节点和<code>B</code>节点)并不连通，那么就要执行合并操作，这时我们需要历遍整个数组，使得所有与<code>A</code>节点连通的节点都与<code>B</code>节点连通。<br>　　<code>Quick-Find</code>算法中，查找操作的复杂度为<code>O(1)</code>，而合并操作的复杂度为<code>O(N)</code>，<code>N</code>表示数组的长度，即所有节点的数目。<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// UnionFind.hpp</span></div><div class="line"><span class="keyword">class</span> UnionFind</div><div class="line">&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    UnionFind( <span class="keyword">int</span> n ) </div><div class="line">        : num( n ), arr&#123; <span class="keyword">new</span> <span class="keyword">int</span>[num] &#125; &#123;</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; num; ++i ) &#123;</div><div class="line">            arr[i] = i;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">find</span><span class="params">( <span class="keyword">int</span> p, <span class="keyword">int</span> q )</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> arr[p] == arr[q];</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">unite</span><span class="params">( <span class="keyword">int</span> p, <span class="keyword">int</span> q )</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>( !find( p, q ) ) &#123;</div><div class="line">            <span class="keyword">int</span> origin = arr[p];</div><div class="line">            <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; num; ++i ) &#123;</div><div class="line">                <span class="keyword">if</span>( arr[i] == origin ) &#123;</div><div class="line">                    arr[i] = arr[q];</div><div class="line">                &#125;</div><div class="line">            &#125; </div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="keyword">int</span> num;                            <span class="comment">// number of nodes</span></div><div class="line">    <span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;<span class="keyword">int</span>[]&gt; arr;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>　　图<code>1.2</code>表示了<code>Quick-Find</code>算法合并节点的过程，需要注意，节点中的数字表示节点的编号(即数组元素的下标)，而不是数组元素的值。执行一次合并操作，我们需要历遍所有节点，假定所有节点的数目为<code>N</code>，而我们执行<code>M</code>次合并操作，那么从计算机的角度来讲，总共需要执行<code>MN</code>条指令。例如，图<code>1.2</code>表示执行了<code>M=4</code>次合并操作，假定总的节点数目<code>N=10000</code>，则总共大概需要执行<code>40000</code>次指令。<br><img src="/images/data-structure/uf2.png" alt=""></p>
<h2 id="Quick-Union算法"><a href="#Quick-Union算法" class="headerlink" title="Quick-Union算法"></a>Quick-Union算法</h2><p>　　在<code>Quick-Union</code>算法中，同样使用数组来表示所有节点，数组的下标表示节点的编号。但每个节点可以指向同一连通集中的另一节点，例如，假定<code>arr[1]</code>的值为<code>2</code>，那么就表示编号为<code>1</code>的节点指向编号为<code>2</code>的节点，那么这两个节点就是连通的。<br><img src="/images/data-structure/uf3.png" alt=""><br>　　如果节点指向其它的节点，我们可以顺着这条链路找到链路的最后一个节点，最后的这个节点将指向其自身。根据这个原理，我们可以发现，如果两个节点处于同一个连通集中，那么我们顺着这两个节点指向的链路，最后到达的将是同一个节点，由此可以判断两个节点是否处于同一个连通集中(连通集中的所有节点两两之间直接地或间接地连通)。<br>　　在<code>Quick-Union</code>算法中，判断两个节点是否处于同一个连通集，我们需要历遍两个节点所在的链路，同样，要是两个节点并不在同一个连通集中，则需要执行合并操作，例如，节点<code>1</code>和节点<code>2</code>处于同一连通集，节点<code>3</code>和节点<code>4</code>处于同一连通集：<br><img src="/images/data-structure/uf4.png" alt=""><br>　　为了合并两个节点，使得这两个节点处于同一连通集，我们需要分别顺着这两个节点所在的链路历遍到链路的最后一个节点，并且使其中一个节点指向另外一个节点。例如，假定我们需要合并节点<code>1</code>和节点<code>4</code>，由于节点<code>2</code>和节点<code>3</code>分别是两条链路的最后一个节点，那么我们可以让节点<code>2</code>指向节点<code>3</code>，这样，<code>4</code>个节点就将处于同一个连通集：<br><img src="/images/data-structure/uf6.png" alt=""><br>　　从节点<code>1</code>和节点<code>4</code>分别进行历遍，那么节点<code>3</code>就成为这两条链路共同的最后一个节点。由此可得，只要顺着两个节点所在的链路分别历遍到最后一个节点，再判断链路末端的两个节点是否是同一个节点，我们就可以轻易判断任意两个节点是否处于同一连通集了。<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// UnionFind.hpp</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">class</span> UnionFind</div><div class="line">&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    UnionFind( <span class="keyword">int</span> n ) </div><div class="line">        : num( n ), arr&#123; <span class="keyword">new</span> <span class="keyword">int</span>[num] &#125; &#123;</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; num; ++i ) &#123;</div><div class="line">            arr[i] = i;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">find</span><span class="params">( <span class="keyword">int</span> p, <span class="keyword">int</span> q )</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> find( p ) == find( q );</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">unite</span><span class="params">( <span class="keyword">int</span> p, <span class="keyword">int</span> q )</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> pRoot = find( p );</div><div class="line">        <span class="keyword">int</span> qRoot = find( q );</div><div class="line">        <span class="keyword">if</span>( pRoot != qRoot ) &#123;</div><div class="line">            arr[pRoot] = qRoot;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">( <span class="keyword">int</span> n )</span> </span>&#123;</div><div class="line">        <span class="keyword">while</span>( n != arr[n] ) &#123;</div><div class="line">            n = arr[n];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> n;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> num;</div><div class="line">    <span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;<span class="keyword">int</span>[]&gt; arr;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>　　图<code>1.3</code>表示<code>Quick-Union</code>算法合并节点的过程。实际上，链路的最后一个节点可以看成是树的根节点，这个节点将指向其自身，以此，可以将整个连通集看成是一棵树，由于顺着同一连通集中的所有节点向上历遍，那么最后都会到达根节点，据此可判断任意两个节点是否处于同一棵树中(也即同一连通集中)。<br><img src="/images/data-structure/uf7.png" alt=""><br>　　与<code>Quick-Find</code>算法相比，<code>Quick-Union</code>算法的合并操作并不需要历遍整个数组，因此显得相对快一些。为了分析<code>Quick-Union</code>算法的性能，我们需要考虑最坏的情况，在最坏的情况下，<code>Quick-Union</code>算法所形成的树将呈直线形状。例如，假定我们运行前面的测试程序，输入以下内容：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">0 1</div><div class="line">new connection: 0-1</div><div class="line">0 2</div><div class="line">new connection: 0-2</div><div class="line">0 3</div><div class="line">new connection: 0-3</div><div class="line">0 4</div><div class="line">new connection: 0-4</div><div class="line">0 5</div><div class="line">new connection: 0-5</div></pre></td></tr></table></figure></p>
<p>　　那么此时将形成图<code>1.4</code>所示的直线状的树：<br><img src="/images/data-structure/uf8.png" alt=""><br>　　此时，每次若需要查找节点<code>0</code>，我们就需要对直线状的树历遍一次。如果根据这种方式构建出一颗具有<code>N</code>个节点的直线树，那么平均每次需要执行的历遍操作次数为：<br>$T = \frac{0+1+2+ \cdots + (N-1)}{N} = \frac{N-1}{2}$<br>　　按照这种方式构造出具有<code>N</code>个节点的直线状的树，那么我们需要输入<code>N</code>对整数，总的历遍操作次数为：<br>$T_{total} = \frac{N(N-1)}{2}$</p>
<h2 id="Weighted-Quick-Union算法"><a href="#Weighted-Quick-Union算法" class="headerlink" title="Weighted Quick-Union算法"></a>Weighted Quick-Union算法</h2><p>　　在合并两棵树的过程，我们是使一棵树的根节点指向另一棵树的根节点，这时可以选择将大树连接到小树上，也可以将小树连接到大树上。图<code>1.5</code>表示了这个过程。这时我们可以发现，要是将大树连到小树，那么合并之后的树的高度将会增加<code>1</code>，而要是将小树连接到大树上，那么合并后的树的高度将不变。<br>　　为了防止<code>Quick-Union</code>算法出现最坏情况，在合并两棵树的过程，我们需要尽量阻止树的高度增加。为此，可以为每棵树增加一个计数器，用来存储树的节点数目，在合并两棵树时，就可以通过判断两棵树的节点数目，从而将小树连接到大树上，尽量阻止树高度的增加。这种算法就称为<code>Weighted Quick-Union</code>算法。<br><img src="/images/data-structure/uf9.png" alt=""><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// UnionFind.hpp</span></div><div class="line"><span class="keyword">class</span> UnionFind</div><div class="line">&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    UnionFind( <span class="keyword">int</span> n ) </div><div class="line">        : num( n ), size&#123; <span class="keyword">new</span> <span class="keyword">int</span>[num] &#125;, arr&#123; <span class="keyword">new</span> <span class="keyword">int</span>[num] &#125; &#123;</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; num; ++i ) &#123;</div><div class="line">            size[i] = <span class="number">1</span>;</div><div class="line">            arr[i] = i;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">find</span><span class="params">( <span class="keyword">int</span> p, <span class="keyword">int</span> q )</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> find( p ) == find( q );</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">unite</span><span class="params">( <span class="keyword">int</span> p, <span class="keyword">int</span> q )</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> pRoot = find( p );</div><div class="line">        <span class="keyword">int</span> qRoot = find( q );</div><div class="line">        <span class="keyword">if</span>( pRoot != qRoot ) &#123;</div><div class="line">            <span class="keyword">if</span>( size[pRoot] &lt; size[qRoot] ) &#123;</div><div class="line">                arr[pRoot] = qRoot;</div><div class="line">                size[qRoot] += size[pRoot];</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                arr[qRoot] = pRoot;</div><div class="line">                size[pRoot] += size[qRoot];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">( <span class="keyword">int</span> n )</span> </span>&#123;</div><div class="line">        <span class="keyword">while</span>( n != arr[n] ) &#123;</div><div class="line">            n = arr[n];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> n;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> num;</div><div class="line">    <span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;<span class="keyword">int</span>[]&gt; size;</div><div class="line">    <span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;<span class="keyword">int</span>[]&gt; arr;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>　　使用<code>Weighted Quick-Union</code>算法，在最坏情况下，假定树总共有$2^N$个节点，那么我们从任意叶节点开始，最多需要<code>N</code>次历遍就能到达根节点，实际上判断两个节点是否存在于同一棵树中的操作的其时间复杂度为<code>O(log N)</code>。<br>\par 假定存在两棵树<code>A</code>和<code>B</code>，其节点数分别为$N_1$和$N_2$，且$N_1 \leq N_2$，对<code>A</code>和<code>B</code>进行合并，那么在合并之后，通常<code>A</code>的高度将会增加<code>1</code>，而<code>B</code>的高度将保持不变，合并之后的树总节点树为$N_1+N_2$。可以证明，在合并后的树中，从任意叶节点到达根节点，最多需要$\log(N_1+N_2)$次操作，因为$1+\log N_1 = \log(N_1+N_1) \leq \log(N_1+N_2)$。</p>
<h2 id="路径压缩的Weighted-Quick-Union算法"><a href="#路径压缩的Weighted-Quick-Union算法" class="headerlink" title="路径压缩的Weighted Quick-Union算法"></a>路径压缩的Weighted Quick-Union算法</h2><p>　　在<code>Weighted Quick-Union</code>算法所形成的树，只有少量的节点远离根节点，实际上这个算法非常高效，但我们还可以做得更好。在<code>Weighted Quick-Union</code>算法中，从叶节点历遍到根节点，在最坏情况下是<code>O(log N)</code>时间操作，我们可以对此进行改进，使得这个操作接近常量时间。<br>　　当从叶节点开始历遍到根节点的过程中，我们可以改变每两个节点中其中一个节点的指向，使其指向其前面的第二个节点，从而使路径缩短一半。正如图<code>1.6</code>所示，我们对直线形状的树执行折半路径压缩之后，路径缩短了将近一半，从而使树的高度减小，使树变得更扁平。<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">( <span class="keyword">int</span> n )</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span>( ; n != arr[n]; n = arr[n] ) &#123;</div><div class="line">        arr[n] = arr[arr[n]];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> n;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><img src="/images/data-structure/uf10.png" alt=""><br>　　除了折半路径压缩算法之外，还可以使用完全路径压缩算法。假定我们从叶节点历遍到根节点的过程中，能使所有的节点都指向根节点，那么整棵树将变得更加扁平，这种方法称为完全路径压缩。<br>　　图<code>1.7</code>显示了使用这个算法来合并节点的过程，在树中顺着叶节点历遍到根节点的过程中，会使得路径中的所有节点直接与根节点连接，从而使树变得更加扁平。<br><img src="/images/data-structure/uf11.png" alt=""><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">( <span class="keyword">int</span> n )</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> root = n;</div><div class="line">    <span class="keyword">while</span>( root != arr[root] ) &#123;</div><div class="line">         root = arr[root];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> t;</div><div class="line">    <span class="keyword">for</span>( <span class="keyword">int</span> i = n; i != arr[i]; i = t ) &#123;</div><div class="line">        t = arr[i];</div><div class="line">        arr[i] = root;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> root;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>　　尽管通过路径压缩使得整棵树变得更加扁平，但却需要执行了一下额外的操作，实际上<code>Weighted Quick-Union</code>算法与路径压缩的<code>Weighted Quick-Union</code>算法相比，执行性能非常接近。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="http://www.amazon.com/Algorithms-Parts-1-4-Fundamentals-Structure/dp/0201350882" target="_blank" rel="external">Algorithms in C++ 3rd Edition by Robert Sedgewick</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/01/14/latex语法高亮/" itemprop="url">
                  Latex 之代码语法高亮
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-01-14T15:15:03+08:00" content="2015-01-14">
              2015-01-14
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/文字排版/" itemprop="url" rel="index">
                    <span itemprop="name">文字排版</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="代码显示"><a href="#代码显示" class="headerlink" title="代码显示"></a>代码显示</h2><p>　　我们可以使用<code>Latex</code>来排版文章和书籍，特别是可以用<code>Latex</code>来排版学习笔记，可以取得很不错的效果。实际上，用<code>Latex</code>中插入代码，可以取得代码语法高亮的效果。<br>　　首先，我们展示以下默认的排版效果，创建一个<code>.tex</code>文件，写入以下内容：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">\documentclass&#123;ctexart&#125;</div><div class="line">\usepackage&#123;listings&#125;</div><div class="line">\begin&#123;document&#125;</div><div class="line">\begin&#123;lstlisting&#125;</div><div class="line">#include &lt;iostream&gt;</div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">    std::cout &lt;&lt; "Hello, World!" &lt;&lt; std::endl;</div><div class="line">&#125;  </div><div class="line">\end&#123;lstlisting&#125;</div><div class="line">\end&#123;document&#125;</div></pre></td></tr></table></figure></p>
<p>　　那么排版效果没有什么显著特点：<br><img src="/images/latex/1.png" alt=""><br>　　可以为<code>lstlisting</code>环境指定可选参数<code>language=c++</code>，用来设定代码使用的语言：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">\documentclass&#123;ctexart&#125;</div><div class="line">\usepackage&#123;listings&#125;</div><div class="line">\begin&#123;document&#125;</div><div class="line">\begin&#123;lstlisting&#125;[language=c++]</div><div class="line">#include &lt;iostream&gt;</div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">    std::cout &lt;&lt; "Hello, World!" &lt;&lt; std::endl;</div><div class="line">&#125;  </div><div class="line">\end&#123;lstlisting&#125;</div><div class="line">\end&#123;document&#125;</div></pre></td></tr></table></figure></p>
<p>　　可以看到，这时排版效果中的关键字是黑体：<br><img src="/images/latex/2.png" alt=""></p>
<h2 id="语法高亮"><a href="#语法高亮" class="headerlink" title="语法高亮"></a>语法高亮</h2><p>　　可能你已经想到要怎样让关键字显示其它颜色了，我们可以定制<code>lstlisting</code>环境：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">\documentclass&#123;ctexart&#125;</div><div class="line">\usepackage&#123;listings&#125;</div><div class="line">\usepackage&#123;xcolor&#125;</div><div class="line">\lstset&#123;</div><div class="line">    columns=fixed,       </div><div class="line">    numbers=left,                                        % 在左侧显示行号</div><div class="line">    frame=none,                                          % 不显示背景边框</div><div class="line">    backgroundcolor=\color[RGB]&#123;245,245,244&#125;,            % 设定背景颜色</div><div class="line">    keywordstyle=\color[RGB]&#123;40,40,255&#125;,                 % 设定关键字颜色</div><div class="line">    numberstyle=\footnotesize\color&#123;darkgray&#125;,           % 设定行号格式</div><div class="line">    commentstyle=\it\color[RGB]&#123;0,96,96&#125;,                % 设置代码注释的格式</div><div class="line">    stringstyle=\rmfamily\slshape\color[RGB]&#123;128,0,0&#125;,   % 设置字符串格式</div><div class="line">    showstringspaces=false,                              % 不显示字符串中的空格</div><div class="line">    language=c++,                                        % 设置语言</div><div class="line">&#125;</div><div class="line"></div><div class="line">\begin&#123;document&#125;     </div><div class="line">&#123;\setmainfont&#123;Courier New Bold&#125;                          % 设置代码字体                   </div><div class="line">\begin&#123;lstlisting&#125;</div><div class="line">#include &lt;iostream&gt;</div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">    std::cout &lt;&lt; "Hello, World!" &lt;&lt; std::endl;</div><div class="line">&#125;  </div><div class="line">\end&#123;lstlisting&#125;&#125;</div><div class="line">\end&#123;document&#125;</div></pre></td></tr></table></figure></p>
<p>　　可以看到，关键字、注释和字符串都改变了颜色：<br><img src="/images/latex/3.png" alt=""></p>
<h2 id="拓展关键字"><a href="#拓展关键字" class="headerlink" title="拓展关键字"></a>拓展关键字</h2><p>　　尽管我们已经指定了代码的编程语言是<code>C++</code>，但是<code>C++</code>中很多关键字仍不被支持，同样，<code>C++11</code>中新的关键字也无法实现代码高亮。<br>　　我们可以为<code>lstlisting</code>环境增加更多的关键字，使其支持<code>C++11</code>的关键字：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">\documentclass&#123;ctexart&#125;</div><div class="line">\usepackage&#123;listings&#125;</div><div class="line">\usepackage&#123;xcolor&#125;</div><div class="line"></div><div class="line">% 定义可能使用到的颜色</div><div class="line">\definecolor&#123;CPPLight&#125;  &#123;HTML&#125; &#123;686868&#125;</div><div class="line">\definecolor&#123;CPPSteel&#125;  &#123;HTML&#125; &#123;888888&#125;</div><div class="line">\definecolor&#123;CPPDark&#125;   &#123;HTML&#125; &#123;262626&#125;</div><div class="line">\definecolor&#123;CPPBlue&#125;   &#123;HTML&#125; &#123;4172A3&#125;</div><div class="line">\definecolor&#123;CPPGreen&#125;  &#123;HTML&#125; &#123;487818&#125;</div><div class="line">\definecolor&#123;CPPBrown&#125;  &#123;HTML&#125; &#123;A07040&#125;</div><div class="line">\definecolor&#123;CPPRed&#125;    &#123;HTML&#125; &#123;AD4D3A&#125;</div><div class="line">\definecolor&#123;CPPViolet&#125; &#123;HTML&#125; &#123;7040A0&#125;</div><div class="line">\definecolor&#123;CPPGray&#125;  &#123;HTML&#125; &#123;B8B8B8&#125;</div><div class="line"></div><div class="line">\lstset&#123;</div><div class="line">    columns=fixed,       </div><div class="line">    numbers=left,                                        % 在左侧显示行号</div><div class="line">    frame=none,                                          % 不显示背景边框</div><div class="line">    backgroundcolor=\color[RGB]&#123;245,245,244&#125;,            % 设定背景颜色</div><div class="line">    keywordstyle=\color[RGB]&#123;40,40,255&#125;,                 % 设定关键字颜色</div><div class="line">    numberstyle=\footnotesize\color&#123;darkgray&#125;,           % 设定行号格式</div><div class="line">    commentstyle=\it\color[RGB]&#123;0,96,96&#125;,                % 设置代码注释的格式</div><div class="line">    stringstyle=\rmfamily\slshape\color[RGB]&#123;128,0,0&#125;,   % 设置字符串格式</div><div class="line">    showstringspaces=false,                              % 不显示字符串中的空格</div><div class="line">    language=c++,                                        % 设置语言</div><div class="line">    morekeywords=&#123;alignas,continute,friend,register,true,alignof,decltype,goto,</div><div class="line">    reinterpret_cast,try,asm,defult,if,return,typedef,auto,delete,inline,short,</div><div class="line">    typeid,bool,do,int,signed,typename,break,double,long,sizeof,union,case,</div><div class="line">    dynamic_cast,mutable,static,unsigned,catch,else,namespace,static_assert,using,</div><div class="line">    char,enum,new,static_cast,virtual,char16_t,char32_t,explict,noexcept,struct,</div><div class="line">    void,export,nullptr,switch,volatile,class,extern,operator,template,wchar_t,</div><div class="line">    const,false,private,this,while,constexpr,float,protected,thread_local,</div><div class="line">    const_cast,for,public,throw,std&#125;,</div><div class="line">&#125;</div><div class="line">\begin&#123;document&#125;     </div><div class="line">&#123;\setmainfont&#123;Courier New Bold&#125;                          % 设置代码字体                   </div><div class="line">\begin&#123;lstlisting&#125;</div><div class="line">#include <span class="tag">&lt;<span class="name">iostream</span>&gt;</span></div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">    constexpr int MAX = 100;</div><div class="line">&#125;  </div><div class="line">\end&#123;lstlisting&#125;&#125;</div><div class="line">\end&#123;document&#125;</div></pre></td></tr></table></figure></p>
<p>　　可以看到，<code>C++11</code>中的关键字<code>constexpr</code>显示高亮：<br><img src="/images/latex/4.png" alt=""><br>　　<br>　　除此之外，我们还可以使标准库的容器也实现代码高亮：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line">\documentclass&#123;ctexart&#125;</div><div class="line">\usepackage&#123;listings&#125;</div><div class="line">\usepackage&#123;xcolor&#125;</div><div class="line"></div><div class="line">% 定义可能使用到的颜色</div><div class="line">\definecolor&#123;CPPLight&#125;  &#123;HTML&#125; &#123;686868&#125;</div><div class="line">\definecolor&#123;CPPSteel&#125;  &#123;HTML&#125; &#123;888888&#125;</div><div class="line">\definecolor&#123;CPPDark&#125;   &#123;HTML&#125; &#123;262626&#125;</div><div class="line">\definecolor&#123;CPPBlue&#125;   &#123;HTML&#125; &#123;4172A3&#125;</div><div class="line">\definecolor&#123;CPPGreen&#125;  &#123;HTML&#125; &#123;487818&#125;</div><div class="line">\definecolor&#123;CPPBrown&#125;  &#123;HTML&#125; &#123;A07040&#125;</div><div class="line">\definecolor&#123;CPPRed&#125;    &#123;HTML&#125; &#123;AD4D3A&#125;</div><div class="line">\definecolor&#123;CPPViolet&#125; &#123;HTML&#125; &#123;7040A0&#125;</div><div class="line">\definecolor&#123;CPPGray&#125;  &#123;HTML&#125; &#123;B8B8B8&#125;</div><div class="line"></div><div class="line">\lstset&#123;</div><div class="line">    columns=fixed,       </div><div class="line">    numbers=left,                                        % 在左侧显示行号</div><div class="line">    frame=none,                                          % 不显示背景边框</div><div class="line">    backgroundcolor=\color[RGB]&#123;245,245,244&#125;,            % 设定背景颜色</div><div class="line">    keywordstyle=\color[RGB]&#123;40,40,255&#125;,                 % 设定关键字颜色</div><div class="line">    numberstyle=\footnotesize\color&#123;darkgray&#125;,           % 设定行号格式</div><div class="line">    commentstyle=\it\color[RGB]&#123;0,96,96&#125;,                % 设置代码注释的格式</div><div class="line">    stringstyle=\rmfamily\slshape\color[RGB]&#123;128,0,0&#125;,   % 设置字符串格式</div><div class="line">    showstringspaces=false,                              % 不显示字符串中的空格</div><div class="line">    language=c++,                                        % 设置语言</div><div class="line">    morekeywords=&#123;alignas,continute,friend,register,true,alignof,decltype,goto,</div><div class="line">    reinterpret_cast,try,asm,defult,if,return,typedef,auto,delete,inline,short,</div><div class="line">    typeid,bool,do,int,signed,typename,break,double,long,sizeof,union,case,</div><div class="line">    dynamic_cast,mutable,static,unsigned,catch,else,namespace,static_assert,using,</div><div class="line">    char,enum,new,static_cast,virtual,char16_t,char32_t,explict,noexcept,struct,</div><div class="line">    void,export,nullptr,switch,volatile,class,extern,operator,template,wchar_t,</div><div class="line">    const,false,private,this,while,constexpr,float,protected,thread_local,</div><div class="line">    const_cast,for,public,throw,std&#125;,</div><div class="line">    emph=&#123;map,set,multimap,multiset,unordered_map,unordered_set,</div><div class="line">    unordered_multiset,unordered_multimap,vector,string,list,deque,</div><div class="line">    array,stack,forwared_list,iostream,memory,shared_ptr,unique_ptr,</div><div class="line">    random,bitset,ostream,istream,cout,cin,endl,move,default_random_engine,</div><div class="line">    uniform_int_distribution,iterator,algorithm,functional,bing,numeric,&#125;,</div><div class="line">    emphstyle=\color&#123;CPPViolet&#125;, </div><div class="line">&#125;</div><div class="line">\begin&#123;document&#125;     </div><div class="line">&#123;\setmainfont&#123;Courier New Bold&#125;                          % 设置代码字体                   </div><div class="line">\begin&#123;lstlisting&#125;</div><div class="line">#include <span class="tag">&lt;<span class="name">iostream</span>&gt;</span></div><div class="line">#include <span class="tag">&lt;<span class="name">array</span>&gt;</span></div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">    constexpr int MAX = 100;</div><div class="line">    std::array<span class="tag">&lt;<span class="name">int,</span> <span class="attr">MAX</span>&gt;</span> arr;</div><div class="line">&#125;  </div><div class="line">\end&#123;lstlisting&#125;&#125;</div><div class="line">\end&#123;document&#125;</div></pre></td></tr></table></figure></p>
<p>　　可以看到，<code>array</code>已经可以高亮了：<br><img src="/images/latex/5.png" alt=""></p>
<p>　　</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/12/28/learn/" itemprop="url">
                  2012至2014 我的编程点滴
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-12-28T08:50:02+08:00" content="2014-12-28">
              2014-12-28
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/学习感悟/" itemprop="url" rel="index">
                    <span itemprop="name">学习感悟</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>　　回顾自己过去的两年多时间，在编程语言的学习上花费了比较多时间：一门偏向底层的语言C，面向对象语言C++和Java，一门脚本语言Python和一门函数式语言Scheme。<br>　　Peter Norvig 在<a href="http://norvig.com/21-days.html" target="_blank" rel="external">Teach Yourself Programming in Ten Years</a>中说道，”Learn at least a half dozen programming languages. Include one language that emphasizes class abstractions (like Java or C++), one that emphasizes functional abstraction (like Lisp or ML or Haskell), one that supports syntactic abstraction (like Lisp), one that supports declarative specifications (like Prolog or C++ templates), and one that emphasizes parallelism (like Clojure or Go).”<br>　　大概的意思是“学会至少半打编程语言。包括一门支持类抽象（class abstraction）的语言（如Java或C++），一门支持函数抽象（functional abstraction）的语言（如Lisp或ML），一门支持句法抽象（syntactic abstraction）的语言（如Lisp），一门支持说明性规约（declarative specification）的语言（如Prolog或C++模版），一门支持协程（coroutine）的语言（如Icon或Scheme），以及一门支持并行处理（parallelism）的语言（如Sisal）。”<br>　　总的来说，在C和Java的学习上走了较多弯路，但还好，在C++的学习上则比较顺利，至于Python和Scheme，则是很容易就能学会的。<br>　　至于如何才能少走弯路，方法很简单，就是多跟别人交流。当然，我是来总结经验并且推荐书单的，在如今互联网产业发达，强度如何快速开发软件的时代，看完这些书并不保证能找到工作，<strong>但能保证你的编程能力有很大的提升</strong>。</p>
<p>##关于C<br>　　C语言可以算是大多理工科的必备科目，不过大多数高校仍然以谭浩强的《C程序设计》作为教材，很遗憾，在C语言的教学上，说国内落后国外几十年都不为过。1999年制定了C99标准，2011年指定的C11标准，而国内的教材只覆盖到1989年C89的内容，很多教材甚至都算不上是采用C89标准的。<br>　　第一本：<a href="http://book.douban.com/subject/2250163/" target="_blank" rel="external">Programming in C Third Edition</a><br>　　这是我看过的第一本算得上是很好的介绍C语言的书，很简单，用半个月时间就可以学完呐，内容覆盖C99。在C语言上，选书不当，即花费力气又损耗时间。不过我是看过《C和指针》、《C primer plus》和《C大学教程》的，花了好多时间，之所以不推荐这些书，那是学习C语言实际不用很多书，太多书就容易让人被繁文缛节所扰乱。以前一位老师说得好，在C语言上，如果你还无法创建线程，那么你是无法说已经入门了。创建线程需要学习操作系统的编程，所以说C语言的学习应该和操作系统编程联系在一起，脱开操作系统编程而大谈如何精通C语言，都是自欺欺人的。关于操作系统的编程，下面会讲到。<br>　　第二本：<a href="http://book.douban.com/subject/1236999/" target="_blank" rel="external">The C Programming Language Second Edition</a><br>　　这就是大名鼎鼎的C语言白皮书，由C语言之父所写，内容覆盖C89。此书虽说是讲C的，实际上是讲general的编程技巧。所谓gegeral的编程技巧，就是强调思维能力的锻炼，例如，你可以用C来写文本计算器，锻炼了这种能力之后，你就能很容易将这个文本计算器用其它语言来实现。不过，这本书真的会教你写文本计算器，不仅如此，还有链表、二叉树、散列表等数据结构的内容，此外，还设计到Unix的系统编程。<br>　　第三本：<a href="http://book.douban.com/subject/6801697/" target="_blank" rel="external">C Interfaces and Implementations: Techniques for Creating Reusable Software</a><br>　　这是一本数据结构的书，强调如何将接口与实现分离，注重良好的代码风格。作者是ICC编译器的作者，同样，也是注重general编程技巧的。我也刚看此书，学到精彩的第一章，等学完了再来补充，欢迎有志者共同学习啊。<br>　　以上这个书单，都是得了很多教训而总结的，C语言的书我看了不下十本，最后总结只有这三本最有用。以前天真地想等精通了C语言之后再去学习其它语言，实际上<strong>只通过学习C语言是永远无法精通C语言的，计算机领域还广得很</strong>。</p>
<p>##关于C++<br>　　学习完C语言之后，在C++的学习上，可以算是比较顺利的了。不过C语言与C++没有必然的联系，也就是学习C++之前，你不必学习C语言，虽然C89和C++98是兼容的，不过C99和C++11就没有这层关系了。话虽如此，学习C语言还是有助于了解计算机本质的。<br>　　第一本：<a href="http://book.douban.com/subject/1456835/" target="_blank" rel="external">Accelerated C++</a><br>　　之所以说在C++的学习上比较顺利，那是在遇到这本书之后。不过貌似图书馆的英文书向来都不受青睐，付出点时间读英文还是值得的。与<a href="http://book.douban.com/subject/1236999/" target="_blank" rel="external">The C Programming Language</a>一样，这本书同样也注重general的编程技巧。书虽说只有300页左右，不过假若你没有一点编程基础，那就不要着急在一个月内将此书学完，实际上包括做完书本的联系，一个月也很难学完这本书。<br>　　第二本：<a href="http://book.douban.com/subject/25708312/" target="_blank" rel="external">C++ Primer 5th Edition</a><br>　　这本是大二暑假学习的，不到因为有C++的基础，二十天就学完了。此书是介绍C++11的，包括智能指针，无序容器、lambda表达式等等，不过就不会涉及多线程的部分。总得来说，书本详细而不啰嗦，不过大部分的语言旁支末节也不必去记得，等实际编程需要用到时再去细细翻阅。<br>　　第三本：<a href="http://book.douban.com/subject/10440485/" target="_blank" rel="external">The C++ Standard Library Second Edition</a><br>　　也许<a href="http://book.douban.com/subject/25708312/" target="_blank" rel="external">C++ Primer</a>侧重与语言细节的介绍，那么本书则是关于标准库的介绍了，不仅如此，本书还会涵盖<a href="http://book.douban.com/subject/25708312/" target="_blank" rel="external">C++ Primer</a>中未涉及的关于C++11标准库中的内容，例如多线程部分，同时还详细介绍各类容器的应用。<br>　　第四本：<a href="http://book.douban.com/subject/4130141/" target="_blank" rel="external">C++ Concurrency in Action</a><br>　　介绍C++11多线程编程的，读完此书，你就可以创建线程安全的数据结构了。还没学完，等学完了再细细补充。</p>
<h2 id="关于GUI"><a href="#关于GUI" class="headerlink" title="关于GUI"></a>关于GUI</h2><p>　　学了这么多C和C++的书之后，很有可能会像当年痴迷GUI的我一样，提出一个问题：那我将入门利用C和C++来作出具有界面的软件呢？<br>　　第一本：<a href="http://book.douban.com/subject/5273955/" target="_blank" rel="external">Programming Windows 5th Edition Book</a><br>　　这本书不必看完，实际上我也只看到第三章。这就回应了该如何利用C语言来写界面的问题了。这本书会介绍Windows的消息队列，事件处理。对理解GUI编程很有帮助。当然，如果你觉得利用C语言来写界面特别繁琐，那么也可以完全忽略此书，一点都不影响你学习GUI编程。好了，那么如果不学习这本书，那么该如何学习GUI编程呢？嗯嗯，是时候介绍强大的C++ GUI类库Qt了。<br>　　第二本：<a href="http://book.douban.com/subject/2679726/" target="_blank" rel="external">The Book of Qt 4</a><br>　　这本书是介绍Qt4的，实际上你需要使用Qt4版本来学习这本书。最新的Qt已经是5.4了，当然我是先学习这本书，其次再通过Qt的<a href="http://doc.qt.io/qt-5/index.html" target="_blank" rel="external">在线文档</a>来学习Qt5的内容。在Qt5里面，比较好的是可以使用C++11的新特性，例如lambda表达式，可以用来简化代码的编写。<br>　　第三本：<a href="http://book.douban.com/subject/2702157/" target="_blank" rel="external">Foundations of Qt Development</a><br>　　这本书虽然比较旧，不过绝大多数的知识是可以应用在现在的Qt开发中的，学完这本书，你就应该能够知道如何写出带图形界面的计算器程序或小游戏，例如贪吃蛇了。实际上，使用Qt来做图形界面开发特别容易，几乎不需要考虑内存的问题(不过不适当的操作仍然会导致内存泄露发生)。不过，你要是不幸使用上个世纪的开发工具，例如MFC的话，那写界面程序绝对是一种折磨(我曾学了几个星期仍不得要领)。</p>
<h2 id="关于Java"><a href="#关于Java" class="headerlink" title="关于Java"></a>关于Java</h2><p>　　在Java的学习上，走的弯路教多，由于我对GUI比较痴迷，曾试过花了一个月时间学习Swing，这段黑暗史具体就不多说了，不过学习Swing也并不是没有用的，因为大多数GUI的事件处理机制都是差不多的。<br>　　第一本：<a href="http://math.hws.edu/javanotes/" target="_blank" rel="external">Introduction to Programming Using Java, Seventh Edition</a><br>　　这是国外的一本Java教程，作者在网上也公开了免费电子版和配套网站，也是我的第一本Java教程，这是一本有趣的教程，实际上也是锻炼general编程技巧的。书中使用GUI编程较多，如果你的时间有限，那么建议你忽略掉这些部分。从个方面讲，本书仍然是不错的，富含趣味性，讲解深入浅出。<br>　　第二本：<a href="http://book.douban.com/subject/25762168/" target="_blank" rel="external">Core Java Volume I–Fundamentals 9th Edition</a><br>　　Java核心技术，最新版覆盖到Java7的内容。如果你的编程基础比较好，可以直接通过此书学习容器、泛型、多线程的部分。不过，本书对于IO、网络和数据库并没有涉及到。同样的，如果你不喜欢GUI编程，可以跳过Java中GUI部分的学习，当今GUI在Java中形同鸡肋，不学习GUI编程不会对你的Java编程造成任何影响。<br>　　第三本：<a href="http://book.douban.com/subject/25841326/" target="_blank" rel="external">Core Java, Volume II–Advanced Features 9th Edition</a><br>　　Java核心技术卷2，本书涉及到IO、网络和数据库部分。但对于NIO部分仅是稍微提及而未作深入的探讨。重要的也就这几部分，此外，本书中介绍了许多GUI编程，如果不喜欢也可以尽情忽略。<br>　　第四本：<a href="http://book.douban.com/subject/25801524/" target="_blank" rel="external">Java 8 Lambdas</a><br>　　介绍Java8的新特性，lambda表达式和Stream接口，当然，书中讲解的有点抽象，我也只是学到了一半，实际上形成函数式思维还需要借助于其它函数式语言的学习，例如Scheme语言。好了，说到这里，那么就介绍一下函数式语言。</p>
<h2 id="关于Scheme"><a href="#关于Scheme" class="headerlink" title="关于Scheme"></a>关于Scheme</h2><p>　　实际上一开始我是无意学习Scheme的，只是在学习上需要学到就顺便学习了。需要说明的是，学习Scheme时不需要可以记住语法，学习Scheme是用来锻炼思维的，这种思维也可以应用在C++11或Java8这种支持函数式编程的语言上面。<br>　　仅一本：<a href="http://book.douban.com/subject/1148282/" target="_blank" rel="external">Structure and Interpretation of Computer Programs</a><br>　　学到这里，才知道前面学习了那么多语言实际上没有太多必要，在面向对象语言C++和Java中只需要选择一门就可以了。不过我也已经学了，也没什么后悔的了。这本书是麻省理工的计算机入门教程《计算机程序的构造与解析》，当然，我也是刚学。<a href="https://github.com/DeathKing/Learning-SICP" target="_blank" rel="external">在这里</a>你可以找到这本书的公开课视频。这本书是软件工程的入门书，等我学完，再作补充。</p>
<h2 id="关于Python"><a href="#关于Python" class="headerlink" title="关于Python"></a>关于Python</h2><p>　　关于Python，我是新手。为什么学习Python，那是因为Python用来写算法很方便，并且库众多，总能找到一款你喜欢的。<br>　　第一本：<a href="http://www.amazon.com/gp/product/0262525003/ref=pd_lpo_sbs_dp_ss_1?pf_rd_p=1944687702&amp;pf_rd_s=lpo-top-stripe-1&amp;pf_rd_t=201&amp;pf_rd_i=0262519631&amp;pf_rd_m=ATVPDKIKX0DER&amp;pf_rd_r=0P4N4727CCR1712JFE10" target="_blank" rel="external">Introduction to Computation and Programming Using Python</a><br>　　这本书同样是麻省理工的编程入门教程，是关于general编程技巧的，为什么我提及general编程技巧的重要性，那是因为只要掌握了general编程技巧，你可以很轻松就学会其它的编程语言。书中是基于Python2的，不过没关系，本书还介绍了及其学习，动态规划，数据可视化等内容。<br>　　第二本：<a href="http://www.amazon.com/Quick-Python-Book-Second/dp/193518220X/ref=sr_1_30?ie=UTF8&amp;qid=1419735533&amp;sr=8-30&amp;keywords=python" target="_blank" rel="external">The Quick Python Book, Second Edition</a><br>　　这本书是介绍Python3的，我可以保证，只要你有编程基础，这本书可以在不到一个星期之内学完，然后轻松过关。</p>
<h2 id="关于数据结构与算法"><a href="#关于数据结构与算法" class="headerlink" title="关于数据结构与算法"></a>关于数据结构与算法</h2><p>　　数据结构的书学的比较零散，总的来说，除了之前提及的那本<a href="http://book.douban.com/subject/6801697/" target="_blank" rel="external">C Interfaces and Implementations: Techniques for Creating Reusable Software</a>，还有以下两本：<br>　　第一本：<a href="http://www.amazon.com/Algorithms-Parts-1-4-Fundamentals-Structure/dp/0201350882/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1419736108&amp;sr=1-1&amp;keywords=algorithms+in+C%2B%2B" target="_blank" rel="external">Algorithms in C++, Parts 1-4: Fundamentals, Data Structure, Sorting, Searching, Third Edition </a><br>　　对于这本书，其实你也可以学习<a href="http://www.amazon.com/Algorithms-Parts-1-4-Fundamentals-Structures/dp/0201314525/ref=sr_1_2?s=books&amp;ie=UTF8&amp;qid=1419736160&amp;sr=1-2&amp;keywords=algorithms+in+C" target="_blank" rel="external">对应的C语言版本</a>，或者学习<a href="http://www.amazon.com/Algorithms-4th-Robert-Sedgewick/dp/032157351X/ref=sr_1_2?ie=UTF8&amp;qid=1419737520&amp;sr=8-2&amp;keywords=algorithm" target="_blank" rel="external">对应的Java版本</a>，使用何种语言来实现并不是很重要。当然，本书的算法理念很好，不过书中的C++算法在语法上需要自行作出调整就是了。<br>　　第二本：<a href="http://book.douban.com/subject/25750312/" target="_blank" rel="external">Programming Abstractions in C++</a><br>　　这是斯坦福大学本科生的第二门课，文档可以<a href="http://cs.stanford.edu/people/eroberts//CS106BX-Reader.pdf" target="_blank" rel="external">在这里</a>下载到。两本书都是关于C++的，实际上使用C++来实现数据结构和算法是比较好的选择，即支持泛型有没有向Java泛型的语法那样累赘。</p>
<h2 id="关于网络"><a href="#关于网络" class="headerlink" title="关于网络"></a>关于网络</h2><p>　　网络编程的学习，实际上我喜欢直接调用系统的API来学习网络编程。<br>　　第一本：<a href="http://beej.us/guide/bgnet/" target="_blank" rel="external">Beej’s Guide to Network Programming　Using Internet Sockets</a><br>　　这本书会教最基本的Linux网络编程的知识，在学习这本书之前，需要保证你大概学习过《计算机网络》这门课，但，没学过也不要紧。<br>　　第二本：<a href="http://www.amazon.com/Introduction-Network-Programming-Java-Compatible/dp/1447152530/ref=sr_1_9?ie=UTF8&amp;qid=1419738446&amp;sr=8-9&amp;keywords=network+java" target="_blank" rel="external">An Introduction to Network Programming with Java: Java 7 Compatible</a><br>　　这本书对网络的介绍算不上深入，书中介绍了NIO部分比较精彩，学完，就可以知道怎样用Java来写简单的网络程序了。<br>　　网络资源：<a href="http://www.boost.org/doc/libs/1_55_0/doc/html/boost_asio.html" target="_blank" rel="external">Boost.Asio</a><br>　　如果你对C++写网络编程比较感兴趣，那你应该会喜欢<a href="http://www.boost.org/doc/libs/1_55_0/doc/html/boost_asio.html" target="_blank" rel="external">Boost.Asio</a>的。在此之前，需要保证你了解C++11中的大部分新特性，例如智能指针、lambda表达式、<code>std::bind()</code>、多线程和函数对象等相关概念。</p>
<h2 id="关于操作系统"><a href="#关于操作系统" class="headerlink" title="关于操作系统"></a>关于操作系统</h2><p>　　好了，操作系统我选择Linux系统。<br>　　第一本：<a href="http://book.douban.com/subject/6806862/" target="_blank" rel="external">The Linux Command Line: A Complete Introduction</a><br>　　这本书会教你关于Linux系统的命令，熟读此书，在Linux系统上，你就能游刃有余了。<br>　　第二本：<a href="http://book.douban.com/subject/25900403/" target="_blank" rel="external">Advanced Programming in the UNIX Environment</a><br>　　这本是Unix系统编程圣经，自不必多说。书较厚，我看的很少，可惜这学期诸事缠身，到毕业前不一定能看完此书。愿与君共勉！</p>
<h2 id="关于博客"><a href="#关于博客" class="headerlink" title="关于博客"></a>关于博客</h2><p>　　最后，关于<a href="http://cnfeat.com/2014/05/10/2014-05-11-how-to-build-a-blog/" target="_blank" rel="external">如何搭建一个博客</a>。<br>　　以后就可以静静地写博客了。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/12/05/python3入门/" itemprop="url">
                  Python -- 基础语法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-12-05T23:21:27+08:00" content="2014-12-05">
              2014-12-05
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/编程语言/" itemprop="url" rel="index">
                    <span itemprop="name">编程语言</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="编程环境"><a href="#编程环境" class="headerlink" title="编程环境"></a>编程环境</h1><p>　　开始<code>Python</code>学习之旅，首先，在<code>Ubuntu</code>搭建<code>Python3</code>环境：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install python3</div><div class="line">sudo apt-get install idle-python3.4</div></pre></td></tr></table></figure></p>
<p>　　可以在命令行下使用<code>Python3</code>，例如：<br><img src="/images/python/n1.png" alt=""><br>　　在<code>Linux</code>可以按下<code>Ctrl+D</code>来退出<code>Python</code>，在<code>Windows</code>则需要使用<code>Ctrl+Z</code>。除了命令行之外，还可以使用<code>IDLE</code>来编辑代码，运行效果如下：<br><img src="/images/python/p3.png" alt=""><br>　　<code>Python</code>使用<code>&gt;&gt;&gt;</code>作为提示符，可以在其后输入需要执行的命令：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"Hello, World!"</span>)</div><div class="line">Hello, World!</div></pre></td></tr></table></figure></p>
<p>　　此外，可以使用<code>help()</code>来获得帮助信息，例如，如果需要获得<code>abs()</code>函数的帮助信息：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; help(abs)</div><div class="line">Help on built-in function abs in module builtins:</div><div class="line"></div><div class="line">abs(...)</div><div class="line">    abs(number) -&gt; number</div><div class="line">    </div><div class="line">    Return the absolute value of the argument.</div></pre></td></tr></table></figure></p>
<p>　　另一个有用的函数则是<code>dir()</code>，可以用来列举出一个特定类型所具有的成员，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>dir(list)</div><div class="line">[<span class="string">'__add__'</span>, <span class="string">'__class__'</span>, <span class="string">'__contains__'</span>, <span class="string">'__delattr__'</span>, <span class="string">'__delitem__'</span>, <span class="string">'__dir__'</span>, <span class="string">'__doc__'</span>,</div><div class="line"><span class="string">'__eq__'</span>, <span class="string">'__format__'</span>, <span class="string">'__ge__'</span>, <span class="string">'__getattribute__'</span>, <span class="string">'__getitem__'</span>, <span class="string">'__gt__'</span>, <span class="string">'__hash__'</span>, </div><div class="line"><span class="string">'__iadd__'</span>, <span class="string">'__imul__'</span>, <span class="string">'__init__'</span>, <span class="string">'__iter__'</span>, <span class="string">'__le__'</span>, <span class="string">'__len__'</span>, <span class="string">'__lt__'</span>, <span class="string">'__mul__'</span>, </div><div class="line"><span class="string">'__ne__'</span>, <span class="string">'__new__'</span>, <span class="string">'__reduce__'</span>, <span class="string">'__reduce_ex__'</span>, <span class="string">'__repr__'</span>, <span class="string">'__reversed__'</span>, <span class="string">'__rmul__'</span>, </div><div class="line"><span class="string">'__setattr__'</span>, <span class="string">'__setitem__'</span>, <span class="string">'__sizeof__'</span>, <span class="string">'__str__'</span>, <span class="string">'__subclasshook__'</span>, <span class="string">'append'</span>, </div><div class="line"><span class="string">'clear'</span>, <span class="string">'copy'</span>, <span class="string">'count'</span>, <span class="string">'extend'</span>, <span class="string">'index'</span>, <span class="string">'insert'</span>, <span class="string">'pop'</span>, <span class="string">'remove'</span>, <span class="string">'reverse'</span>, <span class="string">'sort'</span>]</div></pre></td></tr></table></figure></p>
<h1 id="基本数据类型"><a href="#基本数据类型" class="headerlink" title="基本数据类型"></a>基本数据类型</h1><p>　　<code>Python</code>中，变量是不具有类型的，对象才会具有类型，因此，在声明变量时不用指明变量的类型，由于变量不具有类型，也就可以将任何类型的对象赋值给变量了，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="number">10</span>                    <span class="comment"># 将 int 对象赋值给变量x </span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = <span class="string">"Senlin"</span>              <span class="comment"># 将 str 对象赋值给变量y</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>z = [<span class="string">"home"</span>, <span class="string">"school"</span>]    <span class="comment"># 将 list 对象赋值给变量z</span></div></pre></td></tr></table></figure></p>
<p>　　此外，使用<code>del</code>可以删除变量，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="number">5</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">del</span> x</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x)</div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">NameError: name <span class="string">'x'</span> <span class="keyword">is</span> <span class="keyword">not</span> defined</div></pre></td></tr></table></figure></p>
<p>　　<code>Python</code>具有<code>4</code>种基本数值类型：整数、浮点数、复数和布尔类型，还定义了<code>+</code>、<code>-</code>、<code>*</code>、<code>/</code>、<code>**</code>、<code>//</code>、<code>%</code>算术运算符，其中，对两个整数使用<code>/</code>操作将返回<strong>浮点数</strong>结果，使用<code>//</code>操作则会对结果进行截断<code>(truncation)</code>，此外，<code>**</code>表示乘幂操作。同时，整数的大小将不会受限，这表示整数可以增长到任意的大小，而浮点数的大小则相当于<code>C</code>语言中的<code>double</code>类型，通常占<code>64</code>位：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">5</span> / <span class="number">2</span></div><div class="line"><span class="number">2.5</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">5</span> // <span class="number">2</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">2</span> ** <span class="number">10</span></div><div class="line"><span class="number">1024</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">100000000</span> ** <span class="number">5</span></div><div class="line"><span class="number">10000000000000000000000000000000000000000</span></div></pre></td></tr></table></figure></p>
<p>　　对浮点数进行运算：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>float(<span class="number">200</span>)</div><div class="line"><span class="number">200.0</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="number">19.9</span> ** <span class="number">49.99</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x</div><div class="line"><span class="number">8.504823197671824e+64</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">10000098.99</span> ** <span class="number">3</span></div><div class="line"><span class="number">1.0000296972939716e+21</span></div></pre></td></tr></table></figure></p>
<p>　　复数运算：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = (<span class="number">10</span> + <span class="number">3j</span>) * (<span class="number">20</span> - <span class="number">9j</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x</div><div class="line">(<span class="number">227</span><span class="number">-30j</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.real</div><div class="line"><span class="number">227.0</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.imag</div><div class="line"><span class="number">-30.0</span></div></pre></td></tr></table></figure></p>
<p>　可以使用内置函数或<code>math</code>和<code>cmath</code>模块中的函数对数值类型进行操作：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">    &gt;&gt;&gt; round(<span class="number">5.49</span>)</div><div class="line">    <span class="number">5</span>  </div><div class="line">    &gt;&gt;&gt; <span class="keyword">import</span> math        <span class="comment"># 导入math模块</span></div><div class="line">    &gt;&gt;&gt; math.ceil(<span class="number">5.49</span>)    <span class="comment"># 向上取整</span></div><div class="line">    <span class="number">6</span></div><div class="line">```　</div><div class="line">　　`bool`类型也可以作为整数来看待，其中，`<span class="keyword">True</span>`表示`<span class="number">1</span>`，`<span class="keyword">False</span>`表示`<span class="number">0</span>`，布尔运算：</div><div class="line">```python</div><div class="line">    &gt;&gt;&gt; x = <span class="keyword">True</span></div><div class="line">    &gt;&gt;&gt; <span class="keyword">not</span> x</div><div class="line">    <span class="keyword">False</span></div><div class="line">    &gt;&gt;&gt; y = x * <span class="number">2</span></div><div class="line">    &gt;&gt;&gt; y</div><div class="line">    <span class="number">2</span></div></pre></td></tr></table></figure></p>
<p>　　此外，<code>Python</code>中的一些对象可以当成<code>bool</code>类型，<code>0</code>或空值会被当成<code>False</code>，而其它值则会被当成<code>True</code>，有以下的一些情况，对象可以被当成<code>bool</code>值对待：</p>
<ul>
<li><code>0</code>、<code>0.0</code>和<code>0+0j</code>为<code>False</code>，其它数字则为<code>True</code>。</li>
<li>空字符串<code>&#39;&#39;</code>为<code>False</code>，其它字符串为<code>True</code>。</li>
<li>空的<code>list</code>为<code>False</code>，其它的<code>list</code>则为<code>True</code>。</li>
<li>空的<code>dict</code>为<code>False</code>，其它的<code>dict</code>则为<code>True</code>。</li>
<li>空的<code>set</code>为<code>False</code>，其它的<code>set</code>则为<code>True</code>。</li>
<li><code>None</code>值为<code>False</code>。<br>此外，<code>Python</code>中使用<code>None</code>来表示空值，例如，若一个函数没有返回值，那么这个函数返回的实际就是<code>None</code>值。<br>　　<code>and</code>和<code>or</code>操作符返回的是对象，<code>and</code>操作符返回第一个<code>False</code>对象或最后一个对象，而<code>or</code>操作符返回第一个<code>True</code>对象或最后一个对象：<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">2</span>] <span class="keyword">and</span> [<span class="number">3</span>, <span class="number">4</span>]                <span class="comment"># 返回最后一个对象</span></div><div class="line">[<span class="number">3</span>, <span class="number">4</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>[] <span class="keyword">and</span> [<span class="number">10</span>]                   <span class="comment"># 返回第一个False对象</span></div><div class="line">[]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">2</span>] <span class="keyword">or</span> [<span class="number">3</span>, <span class="number">4</span>]                 <span class="comment"># 返回第一个True对象</span></div><div class="line">[<span class="number">2</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>[] <span class="keyword">or</span> [<span class="number">10</span>]                    <span class="comment"># 返回最后一个对象</span></div><div class="line">[<span class="number">10</span>]</div></pre></td></tr></table></figure>
</li>
</ul>
<p>　　在<code>Python</code>中，<code>==</code>和<code>!=</code>操作符用来判断两个对象的值是否相同，而<code>is</code>和<code>is not</code>则用来判断两个对象是否是同一个对象(判断两个对象的内存是否相同)：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">10</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = [x, <span class="number">1</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x <span class="keyword">is</span> y[<span class="number">0</span>]                     <span class="comment"># x和y[0]指向同一个对象</span></div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">10</span>]                      <span class="comment"># 将另一个list赋值给x </span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x <span class="keyword">is</span> y[<span class="number">0</span>]                      </div><div class="line"><span class="keyword">False</span>                             <span class="comment"># x和y[0]指向不同的对象</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x == y[<span class="number">0</span>]                     <span class="comment"># x和y[0]中包含的值相同</span></div><div class="line"><span class="keyword">True</span></div></pre></td></tr></table></figure></p>
<h1 id="复杂数据类型"><a href="#复杂数据类型" class="headerlink" title="复杂数据类型"></a>复杂数据类型</h1><h2 id="list"><a href="#list" class="headerlink" title="list"></a>list</h2><p>　　<code>list</code>是能动态增长的数组，允许同时包含不同类型的对象。</p>
<h3 id="索引和取片"><a href="#索引和取片" class="headerlink" title="索引和取片"></a>索引和取片</h3><p>　　<code>Python</code>中的<code>list</code>类型可以包含不同类型的对象，可以使用下标来获得<code>list</code>中的特定元素，也可以获得<code>list</code>的片段。当索引值为正整数时，表示从<code>list</code>的头部开始索引，而若索引值为负数，则表示从<code>list</code>的尾部开始索引，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="string">"senlin"</span>, <span class="number">49</span>, [<span class="string">"home"</span>, <span class="string">"school"</span>], <span class="string">"zhan"</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">0</span>]                             <span class="comment"># 第一个元素</span></div><div class="line"><span class="string">'senlin'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">-1</span>]                            <span class="comment"># 最后一个元素，相当于x[3]</span></div><div class="line"><span class="string">'zhan'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">0</span>:<span class="number">3</span>]                           <span class="comment"># 包含x[0]、x[1]和x[2]</span></div><div class="line">[<span class="string">'senlin'</span>, <span class="number">49</span>, [<span class="string">'home'</span>, <span class="string">'school'</span>]]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">1</span>:<span class="number">-1</span>]                          <span class="comment"># 相当于x[1:3]</span></div><div class="line">[<span class="number">49</span>, [<span class="string">'home'</span>, <span class="string">'school'</span>]]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[:<span class="number">3</span>]                            <span class="comment"># 相当于x[0:3]</span></div><div class="line">[<span class="string">'senlin'</span>, <span class="number">49</span>, [<span class="string">'home'</span>, <span class="string">'school'</span>]]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">2</span>:]                            <span class="comment"># 相当于x[2:4]</span></div><div class="line">[[<span class="string">'home'</span>, <span class="string">'school'</span>], <span class="string">'zhan'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">-1</span>:]                           <span class="comment"># 相当于x[3:4]</span></div><div class="line">[<span class="string">'zhan'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">-2</span>:]                           <span class="comment"># 相当于x[2:4]</span></div><div class="line">[[<span class="string">'home'</span>, <span class="string">'school'</span>], <span class="string">'zhan'</span>]</div></pre></td></tr></table></figure></p>
<p>　　使用下标来访问<code>list</code>中的元素时，需要确保元素是存在的：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = []</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">0</span>]</div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;pyshell#14&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">    x[<span class="number">0</span>]</div><div class="line">IndexError: list index out of range</div></pre></td></tr></table></figure></p>
<p>　　对<code>list</code>执行取片操作时，返回的是新的<code>list</code>，原来的<code>list</code>并不会被修改：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="string">'first'</span>, <span class="string">'second'</span>, <span class="string">'third'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = x[<span class="number">0</span>:<span class="number">2</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(y)</div><div class="line">[<span class="string">'first'</span>, <span class="string">'second'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y[<span class="number">0</span>] = <span class="string">"zero"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(y)</div><div class="line">[<span class="string">'zero'</span>, <span class="string">'second'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x)                              <span class="comment"># x不会被修改</span></div><div class="line">[<span class="string">'first'</span>, <span class="string">'second'</span>, <span class="string">'third'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>z = x[:]                              <span class="comment"># z是x的副本</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(z)</div><div class="line">[<span class="string">'first'</span>, <span class="string">'second'</span>, <span class="string">'third'</span>]</div></pre></td></tr></table></figure></p>
<p>　　可以将<code>list</code>看作是能动态增长的数组，因此，可以修改其包含的元素：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">0</span>] = <span class="number">100</span>                       <span class="comment"># 修改x的第一个元素</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">3</span>:] = []                       <span class="comment"># 保留x的前3个元素</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x</div><div class="line">[<span class="number">100</span>, <span class="number">2</span>, <span class="number">3</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">1</span>:] = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x</div><div class="line">[<span class="number">100</span>, <span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[len(x):] = [<span class="number">-10</span>, <span class="string">'senlin'</span>]     <span class="comment"># 在x的末尾增加元素 </span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x)</div><div class="line">[<span class="number">100</span>, <span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">-10</span>, <span class="string">'senlin'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[:<span class="number">0</span>] = [<span class="string">'home'</span>, <span class="string">'you'</span>]          <span class="comment"># 在x的头部增加元素</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x)</div><div class="line">[<span class="string">'home'</span>, <span class="string">'you'</span>, <span class="number">100</span>, <span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">-10</span>, <span class="string">'senlin'</span>]</div></pre></td></tr></table></figure></p>
<h3 id="增加或删除元素"><a href="#增加或删除元素" class="headerlink" title="增加或删除元素"></a>增加或删除元素</h3><p>　　可以使用内置的函数<code>len()</code>、<code>max()</code>或<code>min()</code>对<code>list</code>进行操作，也可以使用<code>list</code>的方法<code>append()</code>、 <code>count()</code>、<code>extend()</code>、<code>index()</code>、<code>insert()</code>、<code>pop()</code>、<code>remove()</code>、<code>reverse()</code>和<code>sort()</code>对<code>list</code>进行操作：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>len(x)</div><div class="line"><span class="number">5</span>   </div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.reverse()                     <span class="comment"># 倒转x中的元素</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x</div><div class="line">[<span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.append(<span class="number">100</span>)                   <span class="comment"># 在x的末尾增加元素</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x</div><div class="line">[<span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">100</span>]</div></pre></td></tr></table></figure></p>
<p>　　将另一个<code>list</code>并入当前的<code>list</code>末尾，应当使用<code>extend()</code>方法而不能使用<code>append()</code>方法，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = [<span class="string">'one'</span>, <span class="string">'two'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.append(y)                        <span class="comment"># 将y作为一个整体插入到x的尾部</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x)</div><div class="line">[<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, [<span class="string">'one'</span>, <span class="string">'two'</span>]]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.extend(y)                        <span class="comment"># 将y中的元素插入到x的尾部</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x)</div><div class="line">[<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, [<span class="string">'one'</span>, <span class="string">'two'</span>], <span class="string">'one'</span>, <span class="string">'two'</span>]</div></pre></td></tr></table></figure></p>
<p>　　可以使用<code>insert()</code>在两个元素之间插入元素，也可以在<code>list</code>的末尾或头部插入元素，使用<code>list.insert(n, elem)</code>会将元素<code>elem</code>插入到元素<code>list[n]</code>之前，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.insert(len(x), <span class="string">'hello'</span>)          <span class="comment"># 在末尾插入  </span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x)</div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="string">'hello'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.insert(<span class="number">0</span>, <span class="string">'me'</span>)                  <span class="comment"># 在头部插入，新元素插入到x[0]之前</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x)</div><div class="line">[<span class="string">'me'</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="string">'hello'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.insert(<span class="number">2</span>, <span class="string">'senlin'</span>)              <span class="comment"># 在中部插入元素，新元素插入到x[2]之前</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x)</div><div class="line">[<span class="string">'me'</span>, <span class="number">1</span>, <span class="string">'senlin'</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="string">'hello'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.insert(<span class="number">-3</span>, <span class="string">'sun'</span>)                <span class="comment"># 在中部插入元素，新元素插入到x[-3]之前</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x)</div><div class="line">[<span class="string">'me'</span>, <span class="number">1</span>, <span class="string">'senlin'</span>, <span class="string">'sun'</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="string">'hello'</span>]</div></pre></td></tr></table></figure></p>
<p>　　可以使用<code>del</code>命令来删除<code>list</code>中的元素或片段，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">del</span> x[<span class="number">2</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x)</div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">del</span> x[:<span class="number">2</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x)</div><div class="line">[<span class="number">4</span>]</div></pre></td></tr></table></figure></p>
<p>　　<code>remove()</code>方法会删除<code>list</code>中的元素，若元素存在多个副本，则会删除第一个副本，若元素并不存在，则会抛出异常，因此，在删除元素之前，可以使用<code>in</code>操作判断元素是否存在：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">5</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.remove(<span class="number">3</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x)</div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">5</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.remove(<span class="number">3</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x)</div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.remove(<span class="number">3</span>)</div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;pyshell#54&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">    x.remove(<span class="number">3</span>)</div><div class="line">ValueError: list.remove(x): x <span class="keyword">not</span> <span class="keyword">in</span> list</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">if</span> <span class="number">4</span> <span class="keyword">in</span> x:</div><div class="line">	x.remove(<span class="number">4</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x)</div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>]</div></pre></td></tr></table></figure></p>
<h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><p>　　可以使用<code>sort()</code>方法对<code>list</code>进行排序：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">100</span>, <span class="number">300</span>, <span class="number">20</span>, <span class="number">80</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.sort()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x)</div><div class="line">[<span class="number">20</span>, <span class="number">80</span>, <span class="number">100</span>, <span class="number">300</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = [<span class="string">'senlin'</span>, <span class="string">'home'</span>, <span class="string">'python'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y.sort()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(y)</div><div class="line">[<span class="string">'home'</span>, <span class="string">'python'</span>, <span class="string">'senlin'</span>]</div></pre></td></tr></table></figure></p>
<p>　　若<code>list</code>中包含不同类型的元素，则无法使用<code>sort()</code>方法进行排序：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="string">'senlin'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.sort()</div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;pyshell#69&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">    s.sort()</div><div class="line">NameError: name <span class="string">'s'</span> <span class="keyword">is</span> <span class="keyword">not</span> defined</div></pre></td></tr></table></figure></p>
<p>　　可以对包含<code>list</code>元素的<code>list</code>进行排序，但要求<code>list</code>元素中包含相同类型的元素，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">7</span>, <span class="number">5</span>], [<span class="number">3</span>, <span class="number">4</span>], [<span class="number">1</span>, <span class="number">4</span>], [<span class="number">3</span>, <span class="number">2</span>]]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.sort()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x)</div><div class="line">[[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">1</span>, <span class="number">4</span>], [<span class="number">3</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>], [<span class="number">7</span>, <span class="number">5</span>]]</div></pre></td></tr></table></figure></p>
<p>　　这里会先比较每个元素的第一个成员，其次再比较第二个成员。也可以自定义排序准则，这需要为sort()方法传递额外的参数，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">num_of_chars</span><span class="params">(s)</span>:</span>                   <span class="comment"># 返回字符串的长度</span></div><div class="line">	<span class="keyword">return</span> len(s)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>words = [<span class="string">'C'</span>, <span class="string">'Python'</span>, <span class="string">'C++'</span>, <span class="string">'Scheme'</span>, <span class="string">'Java'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>words.sort(key = num_of_chars)         <span class="comment"># 根据字符串的长度来排序</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(words)</div><div class="line">[<span class="string">'C'</span>, <span class="string">'C++'</span>, <span class="string">'Java'</span>, <span class="string">'Python'</span>, <span class="string">'Scheme'</span>]</div></pre></td></tr></table></figure></p>
<p>　　在排序时，也可以按降序排序：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">8</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">87</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.sort(reverse = <span class="keyword">True</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x)</div><div class="line">[<span class="number">87</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">3</span>]</div></pre></td></tr></table></figure></p>
<p>　　此外，还可以使用<code>sorted()</code>函数来对可迭代<code>(iterable)</code>的类型排序，但注意，<code>sorted()</code>并不会改变其排序对象，而会返回有序的<code>list</code>对象：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = (<span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">7</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = sorted(x)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x)                         <span class="comment"># x不会被修改</span></div><div class="line">(<span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">7</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(y)</div><div class="line">[<span class="number">2</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>]</div></pre></td></tr></table></figure></p>
<h3 id="特殊操作"><a href="#特殊操作" class="headerlink" title="特殊操作"></a>特殊操作</h3><p>　　此外，也可以使用<code>in</code>、<code>+</code>和<code>*</code>操作符对<code>list</code>进行操作，其中，<code>+</code>和<code>*</code>操作将会返回新的<code>list</code>而不会修改其操作的<code>list</code>对象：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x + [<span class="number">100</span>, <span class="number">200</span>, <span class="number">300</span>]                        <span class="comment"># 返回新的list，增加新的元素 </span></div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">100</span>, <span class="number">200</span>, <span class="number">300</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x * <span class="number">3</span>                                      <span class="comment"># 返回新的list，元素为原来的3倍</span></div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x                                          <span class="comment"># x不会被修改</span></div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">5</span> <span class="keyword">in</span> x</div><div class="line"><span class="keyword">True</span></div></pre></td></tr></table></figure></p>
<h3 id="最值"><a href="#最值" class="headerlink" title="最值"></a>最值</h3><p>　　使用<code>min()</code>和<code>max()</code>元素来分别得到最小和最大元素，但需要保证<code>list</code>中包含相同类型的元素：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>min([<span class="number">10</span>, <span class="number">30</span>, <span class="number">-6</span>])</div><div class="line"><span class="number">-6</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>max([<span class="number">5</span>, <span class="string">"senlin"</span>])</div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;pyshell#88&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">    max([<span class="number">5</span>, <span class="string">"senlin"</span>])</div><div class="line">TypeError: unorderable types: str() &gt; int()</div></pre></td></tr></table></figure></p>
<h3 id="元素的搜索与统计"><a href="#元素的搜索与统计" class="headerlink" title="元素的搜索与统计"></a>元素的搜索与统计</h3><p>　　若需要判定给定元素在<code>list</code>中的位置，可以使用<code>index()</code>方法，将会返回元素所在的下标，若指定元素并存在，则会抛出异常：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="string">'senlin'</span>, <span class="number">100</span>, <span class="number">1000</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.index(<span class="number">100</span>)</div><div class="line"><span class="number">1</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.index(<span class="number">10</span>)</div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;pyshell#2&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">    x.index(<span class="number">10</span>)</div><div class="line">ValueError: <span class="number">10</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">in</span> list</div></pre></td></tr></table></figure></p>
<p>　　而<code>count()</code>方法则用来判断指定元素出现的次数：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.count(<span class="number">1</span>)</div><div class="line"><span class="number">2</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.count(<span class="number">10</span>)</div><div class="line"><span class="number">0</span></div></pre></td></tr></table></figure></p>
<h3 id="浅拷贝与深拷贝"><a href="#浅拷贝与深拷贝" class="headerlink" title="浅拷贝与深拷贝"></a>浅拷贝与深拷贝</h3><p>　　<code>list</code>是可以嵌套的，例如嵌套的<code>list</code>可以当成二维数组：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>m = [[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], [<span class="number">3</span>, <span class="number">8</span>, <span class="number">7</span>]]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>m[<span class="number">0</span>]</div><div class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>m[<span class="number">2</span>][<span class="number">2</span>]</div><div class="line"><span class="number">7</span></div></pre></td></tr></table></figure></p>
<p>　　当嵌套使用<code>list</code>时，外围的<code>list</code>与内部的<code>list</code>都指向同一块内存，因此，可以使用外围的<code>list</code>或内部的<code>list</code>对这块内存的变量作出修改。例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>inner = [<span class="number">1</span>, <span class="number">2</span>]                 </div><div class="line"><span class="meta">&gt;&gt;&gt; </span>outer = [inner, <span class="number">10</span>]            </div><div class="line"><span class="meta">&gt;&gt;&gt; </span>inner[<span class="number">0</span>] = <span class="number">-10</span>                      <span class="comment"># 修改inner时，outer的内容也会被修改</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>outer                               </div><div class="line">[[<span class="number">-10</span>, <span class="number">2</span>], <span class="number">10</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>outer[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">50</span>                    <span class="comment"># 修改outer时，inner的内容也会被修改</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>inner</div><div class="line">[<span class="number">50</span>, <span class="number">2</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>inner = [<span class="number">-5</span>, <span class="number">-10</span>]                   <span class="comment"># 使inner指向另一块内存</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>outer                               <span class="comment"># outer指向的内存并不会改变</span></div><div class="line">[[<span class="number">50</span>, <span class="number">2</span>], <span class="number">10</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>inner[<span class="number">0</span>] = [<span class="number">800</span>]                    <span class="comment"># 这时修改inner指向的内存，并不会影响到outer</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>outer</div><div class="line">[[<span class="number">50</span>, <span class="number">2</span>], <span class="number">10</span>]</div></pre></td></tr></table></figure></p>
<p>　　可以通过取片操作<code>x[:]</code>、<code>x + []</code>或<code>x * 1</code>操作来返回<code>list</code>的拷贝，但这种拷贝属于<strong>浅拷贝</strong>：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="number">100</span>, <span class="number">50</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = x[:]                              <span class="comment"># x[0]和y[0]均指向同一块内存</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y[<span class="number">1</span>] = <span class="number">-10</span>                            <span class="comment"># 修改y[1]不会影响到x[1]   </span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x</div><div class="line">[[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="number">100</span>, <span class="number">50</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">100</span>                         <span class="comment"># 但修改y[0][0]会间接修改到x[0][0]</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x</div><div class="line">[[<span class="number">100</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="number">100</span>, <span class="number">50</span>]</div></pre></td></tr></table></figure></p>
<p>　　为实现<strong>深拷贝</strong>，可以使用<code>copy</code>模块中的<code>deepcopy()</code>函数：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="number">100</span>, <span class="number">50</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> copy</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = copy.deepcopy(x)                  <span class="comment"># y是x的深度拷贝</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1000</span>                        <span class="comment"># 修改y[0][0]并不会影响到x[0][0]</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y</div><div class="line">[[<span class="number">1000</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="number">100</span>, <span class="number">50</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x</div><div class="line">[[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="number">100</span>, <span class="number">50</span>]</div></pre></td></tr></table></figure></p>
<h3 id="list的迭代"><a href="#list的迭代" class="headerlink" title="list的迭代"></a>list的迭代</h3><p>　　在循环结构中，可以使用<code>zip()</code>来组合两个或多个可迭代的对象，这些可迭代对象中，相同位置的元素将会组合形成<code>tuple</code>对象，作为<code>zip()</code>返回对象中的元素：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]                          <span class="comment"># x包含4个元素</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>]        <span class="comment"># y包含6个元素</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>z = zip(x, y)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list(z)</div><div class="line">[(<span class="number">1</span>, <span class="string">'a'</span>), (<span class="number">2</span>, <span class="string">'b'</span>), (<span class="number">3</span>, <span class="string">'c'</span>), (<span class="number">4</span>, <span class="string">'d'</span>)]      <span class="comment"># z中包含4个元素</span></div></pre></td></tr></table></figure></p>
<p>　　一种对<code>list</code>使用循环的例子：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x_square = []</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> item <span class="keyword">in</span> x:</div><div class="line">	x_square.append( item * item )</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x_square</div><div class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>]</div></pre></td></tr></table></figure></p>
<p>　　可以使用另一种形式的语句进行简化，这种格式通常为：<br><code>new_list = [expression for variable in old_list if expression]</code><br>　　可以对以上例子进行简化，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x_square = [item * item <span class="keyword">for</span> item <span class="keyword">in</span> x]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x_square</div><div class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>]</div></pre></td></tr></table></figure></p>
<p>　　也可以在其后使用<code>if</code>语句，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x_square = [item * item <span class="keyword">for</span> item <span class="keyword">in</span> x <span class="keyword">if</span> item &gt; <span class="number">2</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x_square</div><div class="line">[<span class="number">9</span>, <span class="number">16</span>]</div></pre></td></tr></table></figure></p>
<h2 id="tuple"><a href="#tuple" class="headerlink" title="tuple"></a>tuple</h2><p>　　在创建<code>tuple</code>之后，<code>tuple</code>中的元素是不可修改的，可以使用索引来获得<code>tuple</code>中特定的元素或<code>tuple</code>的片段，但却不能增加、删除或替代<code>tuple</code>中的元素。<code>tuple</code>具有<code>count()</code>和<code>index()</code>方法，<code>tuple</code>主要用来作为<code>dict</code>的键。</p>
<h3 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h3><p>　　可以创建包含一个元素的<code>tuple</code>，但需要显示地使用逗号：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; x = (10)</div><div class="line">&gt;&gt;&gt; type(x)</div><div class="line">&lt;class 'int'&gt;</div><div class="line">&gt;&gt;&gt; y = (10,)</div><div class="line">&gt;&gt;&gt; type(y)</div><div class="line">&lt;class 'tuple'&gt;</div><div class="line">&gt;&gt;&gt; z = ()</div><div class="line">&gt;&gt;&gt; type(z)</div><div class="line">&lt;class 'tuple'&gt;</div></pre></td></tr></table></figure></p>
<p>　　<code>tuple</code>中具有与<code>list</code>中类似的方法，但这些方法都不会对<code>tuple</code>作出修改：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = (<span class="number">5</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">200</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.count(<span class="number">10</span>)</div><div class="line"><span class="number">3</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.index(<span class="number">10</span>)</div><div class="line"><span class="number">2</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = (<span class="string">"senlin"</span>, <span class="number">1000</span>, <span class="string">"zhan"</span>)</div></pre></td></tr></table></figure></p>
<p>　　可以使用<code>+</code>或<code>*</code>操作符从既存的<code>tuple</code>中创建新的<code>tuple</code>对象：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x + (<span class="string">'mei'</span>, <span class="number">5000</span>)</div><div class="line">(<span class="string">'senlin'</span>, <span class="number">100</span>, <span class="number">1000</span>, <span class="string">'mei'</span>, <span class="number">5000</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = (<span class="string">'senlin'</span>, <span class="number">100</span>, <span class="number">1000</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = x + (<span class="string">'python'</span>, <span class="string">'c++'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y</div><div class="line">(<span class="string">'senlin'</span>, <span class="number">100</span>, <span class="number">1000</span>, <span class="string">'python'</span>, <span class="string">'c++'</span>)</div></pre></td></tr></table></figure></p>
<p>　　尽管<code>tuple</code>不能被修改，但<code>tuple</code>中仍可以包含可修改的对象，在这种情况下，通过修改可变对象可以间接对<code>tuple</code>作出修改。若<code>tuple</code>中包含可变对象，则这时<code>tuple</code>将不能作为<code>dict</code>的键：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; inner = [1, 10, 1000]</div><div class="line">&gt;&gt;&gt; y = (inner, 5, 55)</div><div class="line">&gt;&gt;&gt; inner[0] = -100                    # 间接地修改了y</div><div class="line">&gt;&gt;&gt; y                            </div><div class="line">([-100, 10, 1000], 5, 55)</div></pre></td></tr></table></figure></p>
<h3 id="与list间的转换"><a href="#与list间的转换" class="headerlink" title="与list间的转换"></a>与list间的转换</h3><p>　　可以使用<code>tuple()</code>，接受<code>list</code>作为参数，返回与之对应的<code>tuple</code>对象：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>tuple(x)</div><div class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x                       <span class="comment"># x不会被修改</span></div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</div></pre></td></tr></table></figure></p>
<p>　　同样，也可以使用<code>list()</code>，接受<code>tuple</code>作为参数，返回与这个<code>tuple</code>相对应的<code>list</code>对象：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list(x)</div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</div></pre></td></tr></table></figure></p>
<p>　　可以使用<code>list()</code>将字符串转换成为包含字符的<code>list</code>对象：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>list(<span class="string">"senlin"</span>)</div><div class="line">[<span class="string">'s'</span>, <span class="string">'e'</span>, <span class="string">'n'</span>, <span class="string">'l'</span>, <span class="string">'i'</span>, <span class="string">'n'</span>]</div></pre></td></tr></table></figure></p>
<h3 id="装包与解包"><a href="#装包与解包" class="headerlink" title="装包与解包"></a>装包与解包</h3><p>　　<code>tuple</code>可以作为赋值操作符的左操作数：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>(one, second) = (<span class="number">1</span>, <span class="number">2</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>one</div><div class="line"><span class="number">1</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>second</div><div class="line"><span class="number">2</span></div></pre></td></tr></table></figure></p>
<p>　　也可以忽略括号，这时，赋值操作符右侧的值将会装包成为<code>tuple</code>，并在赋值操作符的左侧进行解包，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>one, second = <span class="number">1</span>, <span class="number">2</span></div></pre></td></tr></table></figure></p>
<p>　　可以使用这种方式来交换两个变量的值：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>var1, var2 = <span class="number">10</span>, <span class="number">20</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>var1, var2 = var2, var1</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(var1, var2)</div><div class="line"><span class="number">20</span> <span class="number">10</span></div></pre></td></tr></table></figure></p>
<p>　　此外，可以使用带有<code>*</code>的变量表示一个<code>list</code>，用来包含任意数量的不匹配的元素，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a, b, *c = x</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(a, b, c)</div><div class="line"><span class="number">1</span> <span class="number">2</span> [<span class="number">3</span>, <span class="number">4</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a, *b, c = x</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(a, b, c)</div><div class="line"><span class="number">1</span> [<span class="number">2</span>, <span class="number">3</span>] <span class="number">4</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a, b, c, d, *e = x</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(a, b, c, d, e)</div><div class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> []</div></pre></td></tr></table></figure></p>
<p>　　装包与解包也有着其它的灵活的方式，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>[a, b] = [<span class="number">1</span>, <span class="number">2</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>[c, d] = <span class="number">3</span>, <span class="number">4</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>[e, f] = (<span class="number">5</span>, <span class="number">6</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>(g, h) = <span class="number">7</span>, <span class="number">8</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>i, j = [<span class="number">9</span>, <span class="number">10</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>k, l = (<span class="number">11</span>, <span class="number">12</span>)</div></pre></td></tr></table></figure></p>
<p>　　在循环结构中，也可以使用解包操作，例如，以下的<code>list</code>中元素类型是<code>tuple</code>，每个<code>tuple</code>中包含<code>2</code>个元素，现在需要分别计算每个<code>tuple</code>中元素的乘积，最后再累加这些乘积：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [(<span class="number">1</span>, <span class="number">2</span>), (<span class="number">100</span>, <span class="number">200</span>), (<span class="number">1000</span>, <span class="number">2000</span>)]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>result = <span class="number">0</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> item <span class="keyword">in</span> x:</div><div class="line">	result += item[<span class="number">0</span>]*item[<span class="number">1</span>]	</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>result</div><div class="line"><span class="number">2020002</span></div></pre></td></tr></table></figure></p>
<p>　　这里可以使用<code>tuple</code>的解包操作来实现相同的功能：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [(<span class="number">1</span>, <span class="number">2</span>), (<span class="number">100</span>, <span class="number">200</span>), (<span class="number">1000</span>, <span class="number">2000</span>)]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>result = <span class="number">0</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> t1, t2 <span class="keyword">in</span> x:</div><div class="line">	result += t1 * t2</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>result</div><div class="line"><span class="number">2020002</span></div></pre></td></tr></table></figure></p>
<p>　　在循环结构中，可以使用<code>enumerate()</code>函数，通过<code>list</code>来返回<code>tuple</code>对象，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">-1</span>, <span class="number">-2</span>, <span class="number">-20</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">-20</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i, n <span class="keyword">in</span> enumerate(x):                  <span class="comment"># i表示x中的元素下标，n则表示x中的元素</span></div><div class="line">	<span class="keyword">if</span> n &lt; <span class="number">0</span>:</div><div class="line">		print(<span class="string">'Found a negative number at index '</span>, i)</div><div class="line"></div><div class="line">Found a negative number at index  <span class="number">0</span></div><div class="line">Found a negative number at index  <span class="number">1</span></div><div class="line">Found a negative number at index  <span class="number">2</span></div><div class="line">Found a negative number at index  <span class="number">5</span></div></pre></td></tr></table></figure></p>
<h2 id="set"><a href="#set" class="headerlink" title="set"></a>set</h2><p>　　<code>set</code>表示无序的元素集合，其中每个元素都是唯一的，<code>set</code>中的元素需要是不可变<code>(immutable)</code>并且是可散列的<code>(hashable)</code>，这表示<code>int</code>、<code>float</code>、<code>str</code>和<code>tuple</code>均可作为<code>set</code>中的元素，而<code>list</code>和<code>dict</code>则不能作为<code>set</code>中的元素，并且由于<code>set</code>本身是可变的<code>(mutable)</code>并且是不可散列的，则<code>set</code>不能作为另一个<code>set</code>中的元素。</p>
<h3 id="基本操作-1"><a href="#基本操作-1" class="headerlink" title="基本操作"></a>基本操作</h3><p>　　可以使<code>set</code>增加或删除元素，也可以求两个<code>set</code>的交集和并集：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = set([<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">2</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x</div><div class="line">&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.add(<span class="number">6</span>)                        <span class="comment"># 增加元素 </span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.add(<span class="number">7</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.remove(<span class="number">7</span>)                     <span class="comment"># 删除元素</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x</div><div class="line">&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = set([<span class="number">1</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">8</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>z = x | y                       <span class="comment"># 返回新的set，表示x和y的并集</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>z</div><div class="line">&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>&#125;               </div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x &amp; y                           <span class="comment"># 返回新的set，表示x和y的交集</span></div><div class="line">&#123;<span class="number">1</span>, <span class="number">2</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x ^ y                           <span class="comment"># 返回新的set，表示x和y的并集与交集的差</span></div><div class="line">&#123;<span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>&#125;</div></pre></td></tr></table></figure></p>
<h3 id="frozenset"><a href="#frozenset" class="headerlink" title="frozenset"></a>frozenset</h3><p>　　<code>frozenset</code>是不可变的并且是可散列的，因此，可以将一个<code>frozenset</code>作为<code>set</code>中的元素：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = set([<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = frozenset(x)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y</div><div class="line">frozenset(&#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>&#125;)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y.add(<span class="number">100</span>)                                     <span class="comment"># y是不可变的</span></div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;pyshell#74&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">    y.add(<span class="number">100</span>)</div><div class="line">AttributeError: <span class="string">'frozenset'</span> object has no attribute <span class="string">'add'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.add(y)                                       <span class="comment"># y可以作为x中的元素</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x</div><div class="line">&#123;frozenset(&#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>&#125;), <span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>&#125;</div></pre></td></tr></table></figure></p>
<h2 id="str"><a href="#str" class="headerlink" title="str"></a>str</h2><p>　　<code>Python</code>中使用<code>str</code>来表示字符串，<code>str</code>对象是不可修改的，因此，使用操作符或函数对<code>str</code>进行操作时，将返回一个新的<code>str</code>对象，同时，可以使用索引获得<code>str</code>中的字符或子串时，但不能对其作出修改。　　</p>
<h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串　　"></a>字符串　　</h3><p>　　可以使用<code>&quot;</code>或<code>&#39;</code>作为字符串的界定符：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="string">"The 'python' programming lamguage"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = <span class="string">'The "python" programming language'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x)</div><div class="line">The <span class="string">'python'</span> programming lamguage</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(y)</div><div class="line">The <span class="string">"python"</span> programming language</div></pre></td></tr></table></figure></p>
<p>　　也可以使用<code>&quot;&quot;&quot;</code>或<code>&#39;&#39;&#39;</code>来作为字符串的界定符，这时，字符串的内容中可以包含实际的换行符，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="string">'''You are my</span></div><div class="line">friends.'''</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x)</div><div class="line">You are my</div><div class="line">friends.</div></pre></td></tr></table></figure></p>
<h3 id="格式转换"><a href="#格式转换" class="headerlink" title="格式转换"></a>格式转换</h3><p>　　可以使用<code>input()</code>来读取用户的输入，将返回一个<code>str</code>对象，若需要读取的是整数或浮点数，可以显式使用<code>int()</code>或<code>float()</code>进行格式转换：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>v = int(input(<span class="string">'Enter a integer: '</span>))</div><div class="line">Enter a integer: <span class="number">10</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>int(<span class="string">'fa'</span>, <span class="number">16</span>)                         <span class="comment"># 将16进制数fa转换成为10进制</span></div><div class="line"><span class="number">250</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>int(<span class="string">'76'</span>, <span class="number">8</span>)                          <span class="comment"># 将8进制数76转换成为10进制</span></div><div class="line"><span class="number">62</span></div></pre></td></tr></table></figure></p>
<h3 id="划分与替代"><a href="#划分与替代" class="headerlink" title="划分与替代"></a>划分与替代</h3><p>　　<code>str</code>中包含了<code>split()</code>方法，还可以使用<code>re</code>模块中的函数对<code>str</code>进行操作：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="string">"You     are \tmy \nfriend."</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.split()                           <span class="comment"># 根据空白符来划分字符串</span></div><div class="line">[<span class="string">'You'</span>, <span class="string">'are'</span>, <span class="string">'my'</span>, <span class="string">'friend.'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = <span class="string">'hello-world'</span>.split(<span class="string">'-'</span>)        <span class="comment"># 使用'-'作为划分子串的界定符</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y</div><div class="line">[<span class="string">'hello'</span>, <span class="string">'world'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re                           <span class="comment"># 导入正则表达式模块</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>re.compile(<span class="string">r"[\t ]+"</span>)</div><div class="line">re.compile(<span class="string">'[\\t ]+'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>regexpr = re.compile(<span class="string">r"[\t ]+"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>regexpr.sub(<span class="string">" "</span>, x)</div><div class="line"><span class="string">'You are my \nfriend.'</span></div></pre></td></tr></table></figure></p>
<p>　　可以为<code>split()</code>方法传递额外的参数用于指定划分的次数：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="string">'a,b,c,d'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.split(<span class="string">','</span>, <span class="number">1</span>)                   <span class="comment"># 进行1次划分</span></div><div class="line">[<span class="string">'a'</span>, <span class="string">'b,c,d'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.split(<span class="string">','</span>, <span class="number">3</span>)                   <span class="comment"># 进行3次划分</span></div><div class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.split(<span class="string">','</span>, <span class="number">10</span>)                  <span class="comment"># 进行3次划分</span></div><div class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>]</div></pre></td></tr></table></figure></p>
<p>　　当为<code>split()</code>指定第<code>2</code>个参数时，则需要显式指定第<code>1</code>个参数，这时若使用空白符作为界定符，则需要将<code>None</code>作为第<code>1</code>个参数。<br>　　可以使用<code>print()</code>来输出字符串，此外，可以使用<code>print()</code>来将其它类型数据转换成为字符串：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="number">1.49</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"the variable %s's value is %f"</span> % (<span class="string">"x"</span>, x))</div><div class="line">the variable x<span class="string">'s value is 1.490000</span></div></pre></td></tr></table></figure></p>
<h3 id="合并字符串"><a href="#合并字符串" class="headerlink" title="合并字符串"></a>合并字符串</h3><p>　　<code>join()</code>方法可以将包含字符串的<code>list</code>中所有字符串合并成一个字符串：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">''</span>.join([<span class="string">'hello'</span>, <span class="string">'world'</span>])</div><div class="line"><span class="string">'helloworld'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">' '</span>.join([<span class="string">'hello'</span>, <span class="string">'world'</span>])</div><div class="line"><span class="string">'hello world'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'::'</span>.join([<span class="string">'hello'</span>, <span class="string">'world'</span>])</div><div class="line"><span class="string">'hello::world'</span></div></pre></td></tr></table></figure></p>
<p>　　可以对<code>str</code>对象使用<code>+</code>或<code>*</code>操作符：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="string">'hello'</span> + <span class="string">' world'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x</div><div class="line"><span class="string">'hello world'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'m'</span> * <span class="number">10</span></div><div class="line"><span class="string">'mmmmmmmmmm'</span></div></pre></td></tr></table></figure></p>
<h3 id="移去空白符"><a href="#移去空白符" class="headerlink" title="移去空白符"></a>移去空白符</h3><p>　　可以使用<code>strip()</code>移去字符串首部和尾部的空白符，使用<code>lstrip()</code>则只移去首部的空白符，使用<code>rstrip()</code>则只移去尾部的空白符：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="string">'   hello, world\t\t\n'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.strip()</div><div class="line"><span class="string">'hello, world'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.lstrip()</div><div class="line"><span class="string">'hello, world\t\t\n'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.rstrip()</div><div class="line"><span class="string">'   hello, world'</span></div></pre></td></tr></table></figure></p>
<p>　　<code>string.whitespace</code>常量定义了空白符：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> string</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>string.whitespace</div><div class="line"><span class="string">' \t\n\r\x0b\x0c'</span></div></pre></td></tr></table></figure></p>
<p>　　可以为<code>strip()</code>、<code>lstrip()</code>和<code>rstrip()</code>指定参数，用来表示需要移去的字符：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.strip(<span class="string">'gor'</span>)</div><div class="line"><span class="string">'www.python.'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.strip(<span class="string">'.gorw'</span>)</div><div class="line"><span class="string">'python'</span></div></pre></td></tr></table></figure></p>
<h3 id="字符串搜索"><a href="#字符串搜索" class="headerlink" title="字符串搜索"></a>字符串搜索</h3><p>　　<code>find()</code>方法将需要搜索的字符串作为参数，若需要搜索的字符串存在，则返回字符串第一次出现时其首字母的下标，若需要搜索的字符串不存在，则返回<code>-1</code>，<code>rfind()</code>方法则从字符串的尾部开始搜索，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="string">'helloworldhelloworld'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.find(<span class="string">'ll'</span>)</div><div class="line"><span class="number">2</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.find(<span class="string">'me'</span>)</div><div class="line"><span class="number">-1</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.rfind(<span class="string">'ll'</span>)                   <span class="comment"># 从字符串的尾部开始搜索</span></div><div class="line"><span class="number">12</span></div></pre></td></tr></table></figure></p>
<p>　　<code>find()</code>还可以接受另一参数，表示搜索起始的位置：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="string">'helloworldhelloworld'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.find(<span class="string">'world'</span>, <span class="number">5</span>)              <span class="comment"># 从x[5]开始搜索</span></div><div class="line"><span class="number">5</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.find(<span class="string">'world'</span>, <span class="number">6</span>)              <span class="comment"># 从x[6]开始搜索</span></div><div class="line"><span class="number">15</span></div></pre></td></tr></table></figure></p>
<p>　　此外，<code>find()</code>还可以接受第<code>2</code>个额加的参数，用来表示搜索结束的位置：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="string">'helloworldhelloworld'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.find(<span class="string">'world'</span>, <span class="number">0</span>, <span class="number">9</span>)           <span class="comment"># 表示在x[9]之前搜索</span></div><div class="line"><span class="number">-1</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.find(<span class="string">'world'</span>, <span class="number">0</span>, <span class="number">10</span>)          <span class="comment"># 表示在x[10]之前搜索</span></div><div class="line"><span class="number">5</span></div></pre></td></tr></table></figure></p>
<p>　　<code>index()</code>和<code>rindex()</code>的作用与<code>find()</code>与<code>rfind()</code>类似，但假若搜索的字符串并不存在，则<code>index()</code>和<code>rindex()</code>将抛出<code>ValueError</code>异常。<br>　　<code>count()</code>方法则用来统计字符串出现的次数：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="string">'hellohello'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.count(<span class="string">'he'</span>)</div><div class="line"><span class="number">2</span></div></pre></td></tr></table></figure></p>
<p>　　可以使用<code>startswith()</code>和<code>endswith()</code>方法来判断给定字符串是否作为另一字符串的开头或结尾：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="string">'helloworld'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.startswith(<span class="string">'hello'</span>)</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.endswith(<span class="string">'world'</span>)</div><div class="line"><span class="keyword">True</span></div></pre></td></tr></table></figure></p>
<p>　　此外，<code>startswith()</code>与<code>endswith()</code>可以接受一个包含<code>str</code>对象的<code>tuple</code>作为参数，用来判断字符串是否以<code>tuple</code>中的某一个元素为开头或结尾的：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="string">'hello, world'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.startswith((<span class="string">'h'</span>, <span class="string">'o'</span>))              <span class="comment"># 判断x是否以'h'或'o'开头</span></div><div class="line"><span class="keyword">True</span></div></pre></td></tr></table></figure></p>
<h3 id="字符串替代与修改"><a href="#字符串替代与修改" class="headerlink" title="字符串替代与修改"></a>字符串替代与修改</h3><p>　　由于<code>str</code>是不可变的，因此，通过方法调用来修改<code>str</code>，实际上将会返回一个修改的<code>str</code>对象，例如，可以使用<code>replace()</code>方法来替代字符串：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.replace(<span class="string">"\nfriend"</span>, <span class="string">"brother"</span>)    <span class="comment"># 将"\nfriend"替换成为"brother"</span></div><div class="line"><span class="string">'You     are \tmy brother.'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x                                   <span class="comment"># 原来的字符串并不会改变</span></div><div class="line"><span class="string">'You     are \tmy \nfriend.'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = <span class="string">'helloworldhelloworld'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y.replace(<span class="string">'world'</span>, <span class="string">'senlin'</span>)</div><div class="line"><span class="string">'hellosenlinhellosenlin'</span></div></pre></td></tr></table></figure></p>
<p>　　可以组合使用<code>maketrans()</code>和<code>translate()</code>方法来实现多次替代的过程，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="string">'~x ^ (y % z)'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>table = x.maketrans(<span class="string">'~^()'</span>, <span class="string">'!&amp;[]'</span>)    <span class="comment"># 将~替代成!，将^替代成&amp;，将(和)分别替代成[和]</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.translate(table)</div><div class="line"><span class="string">'!x &amp; [y % z]'</span></div></pre></td></tr></table></figure></p>
<p>　　使用<code>upper()</code>和<code>lower()</code>可以分别将字符串转换成为大写或小写，<code>capitalize()</code>会使字符串首字母大写，<code>swapcase()</code>则会将字符串中大写字符转换成为小写，并将小写字符转换成为大写，<code>title()</code>则会将每个单词变成首字母大写，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'hello'</span>.upper()</div><div class="line"><span class="string">'HELLO'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'HELLO'</span>.lower()</div><div class="line"><span class="string">'hello'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'hello'</span>.capitalize()</div><div class="line"><span class="string">'Hello'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'HelloWorld'</span>.swapcase()</div><div class="line"><span class="string">'hELLOwORLD'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'hello world'</span>.title()</div><div class="line"><span class="string">'Hello World'</span></div></pre></td></tr></table></figure></p>
<p>　　由于<code>str</code>是不可变的，但有时需要对<code>str</code>中的字符作出修改，这时可以考虑将<code>str</code>转化成<code>list</code>，通过<code>list</code>来修改字符串的内容，最后再把修改后的内容转换成为<code>str</code>对象：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>text = <span class="string">'hello, world'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>word_list = list(text)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>word_list[<span class="number">6</span>:] = []</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>word_list.reverse()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>text = <span class="string">''</span>.join(word_list)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>text</div><div class="line"><span class="string">',olleh'</span></div></pre></td></tr></table></figure></p>
<h3 id="判定方法与常量"><a href="#判定方法与常量" class="headerlink" title="判定方法与常量"></a>判定方法与常量</h3><p>　　可以使用一些常用方法来对字符串进行判定：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="string">'123'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.isdigit()</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.isalpha()</div><div class="line"><span class="keyword">False</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = <span class="string">'M'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y.isupper()</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y.islower()</div><div class="line"><span class="keyword">False</span></div></pre></td></tr></table></figure></p>
<p>　　<code>string</code>模块中定义了一些常量：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> string</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>string.digits</div><div class="line"><span class="string">'0123456789'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>string.octdigits</div><div class="line"><span class="string">'01234567'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>string.hexdigits</div><div class="line"><span class="string">'0123456789abcdefABCDEF'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>string.ascii_letters</div><div class="line"><span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>string.ascii_lowercase</div><div class="line"><span class="string">'abcdefghijklmnopqrstuvwxyz'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>string.ascii_uppercase</div><div class="line"><span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></div></pre></td></tr></table></figure></p>
<h3 id="将对象转换成为字符串"><a href="#将对象转换成为字符串" class="headerlink" title="将对象转换成为字符串"></a>将对象转换成为字符串</h3><p>　　可以使用<code>repr()</code>函数将对象转换成为字符串：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; 'the list is' + [1, 2, 3]</div><div class="line">Traceback (most recent call last):</div><div class="line">  File "&lt;pyshell#89&gt;", line 1, in &lt;module&gt;</div><div class="line">    'the list is' + [1, 2, 3]</div><div class="line">TypeError: Can't convert 'list' object to str implicitly</div><div class="line">&gt;&gt;&gt; 'the list is' + repr([1, 2, 3])</div><div class="line">'the list is[1, 2, 3]'</div></pre></td></tr></table></figure></p>
<p>　　几乎可以对所有的对象使用<code>repr()</code>函数，因此，可以在程序中使用<code>repr()</code>返回字符串以描述对象的内容：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>repr(len)</div><div class="line"><span class="string">'&lt;built-in function len&gt;'</span></div></pre></td></tr></table></figure></p>
<p>　　同样，<code>str()</code>函数也可以应用于任何类型的对象，用来返回字符串，与<code>repr()</code>不同的是，<code>str()</code>返回的字符串具有可读性。对于内置的对象，<code>str()</code>的调用结果和<code>repr()</code>一致，而对于自定义的对象，这两个函数的返回结果将有所区别。</p>
<h3 id="字符串格式化"><a href="#字符串格式化" class="headerlink" title="字符串格式化"></a>字符串格式化</h3><p>　　可以使用<code>str</code>的<code>format()</code>方法来格式化字符串的内容：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'&#123;0&#125; are my &#123;1&#125;.'</span>.format(<span class="string">'you'</span>, <span class="string">'friends'</span>)</div><div class="line"><span class="string">'you are my friends.'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'&#123;&#123;hello&#125;&#125;, &#123;0&#125;'</span>.format(<span class="string">'world'</span>)</div><div class="line"><span class="string">'&#123;hello&#125;, world'</span></div></pre></td></tr></table></figure></p>
<p>  还可以为<code>format()</code>传递命名参数，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'&#123;name&#125; is a good &#123;job&#125;.'</span>.format(name = <span class="string">'senlin'</span>, job = <span class="string">'student'</span>)</div><div class="line"><span class="string">'senlin is a good student.'</span></div></pre></td></tr></table></figure></p>
<p>　　也可以组合使用两种方式：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'&#123;name&#125; is a good &#123;job[1]&#125;.'</span>.format(name = <span class="string">'senlin'</span>, job = [<span class="string">'student'</span>, <span class="string">'programmer'</span>])</div><div class="line"><span class="string">'senlin is a good programmer.'</span></div></pre></td></tr></table></figure></p>
<p>　　<code>format()</code>还有其它的使用方式：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="string">'senlin is a good programmer.'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'&#123;0:10&#125; is a good programmer.'</span>.format(<span class="string">'senlin'</span>)             <span class="comment"># 0对应的参数占10个位置的宽度</span></div><div class="line"><span class="string">'senlin     is a good programmer.'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'&#123;0:&#123;1&#125;&#125; is a good programmer.'</span>.format(<span class="string">'senlin'</span>, <span class="number">10</span>)        </div><div class="line"><span class="string">'senlin     is a good programmer.'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'&#123;name:&#123;width&#125;&#125; is a good programmer.'</span>.format(name = <span class="string">'senlin'</span>, width = <span class="number">10</span>)</div><div class="line"><span class="string">'senlin     is a good programmer.'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'&#123;0:&gt;10&#125; is a good programmer.'</span>.format(<span class="string">'senlin'</span>)            <span class="comment"># 空格符出现在参数的左侧</span></div><div class="line"><span class="string">'    senlin is a good programmer.'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'&#123;0:&amp;&gt;10&#125; is a good programmer.'</span>.format(<span class="string">'senlin'</span>)           <span class="comment"># 以&amp;作为占位符</span></div><div class="line"><span class="string">'&amp;&amp;&amp;&amp;senlin is a good programmer.'</span></div></pre></td></tr></table></figure></p>
<p>　　也可以使用<code>%</code>来进行字符串的格式化：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'I am %s.'</span> % (<span class="string">'senlin'</span>)</div><div class="line"><span class="string">'I am senlin.'</span></div></pre></td></tr></table></figure></p>
<p>　　使用<code>%</code>的另一种格式化方式，这时需要给定一个<code>dict</code>对象，进行替代时将会使用这个<code>dict</code>中的键值对：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>num_dict = &#123;<span class="string">'e'</span>: <span class="number">2.718</span>, <span class="string">'pi'</span>: <span class="number">3.14159</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'%(pi).2f - %(pi).4f - %(e).2f'</span> % num_dict)</div><div class="line"><span class="number">3.14</span> - <span class="number">3.1416</span> - <span class="number">2.72</span></div></pre></td></tr></table></figure></p>
<p>　　在使用<code>print()</code>进行格式化输出时，可以指定分隔符和结束符：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, end = <span class="string">'\n\n'</span>)</div><div class="line">a b c</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, sep = <span class="string">'|'</span>)</div><div class="line">a|b|c</div></pre></td></tr></table></figure></p>
<h3 id="bytes"><a href="#bytes" class="headerlink" title="bytes"></a>bytes</h3><p>　　<code>str</code>对象中包含的是<code>Unicode</code>字符，而<code>bytes</code>中包含的则是字节序列，字节的取值范围是<code>0-256</code>，当需要从二进制数据文件中读取数据时，则需要处理字节序列。<br>　　可以使用<code>str</code>对象的<code>encode()</code>方法将字符串编码成为字节序列，使用<code>bytes</code>的<code>decode()</code>方法则可以将字节序列解码成为字符串：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; unicode_a_with_acute = '\N&#123;LATIN SMALL LETTER A WITH ACUTE&#125;'</div><div class="line">&gt;&gt;&gt; unicode_a_with_acute</div><div class="line">'á'</div><div class="line">&gt;&gt;&gt; xb = unicode_a_with_acute.encode()      # 将字符串编码成为字节序列</div><div class="line">&gt;&gt;&gt; xb</div><div class="line">b'\xc3\xa1'</div><div class="line">&gt;&gt;&gt; xb + 'A'                                # 无法将字节序列与字符串进行合并</div><div class="line">Traceback (most recent call last):</div><div class="line">  File "&lt;pyshell#10&gt;", line 1, in &lt;module&gt;</div><div class="line">    xb + 'A'</div><div class="line">TypeError: can't concat bytes to str</div><div class="line">&gt;&gt;&gt; xb.decode()                             # 将字节序列解码成字符序列        </div><div class="line">'á'</div></pre></td></tr></table></figure></p>
<h2 id="dict"><a href="#dict" class="headerlink" title="dict"></a>dict</h2><p>　　<code>dict</code>提供了类似于关联数组的功能，<code>dict</code>是使用散列表来实现的。</p>
<h3 id="基本操作-2"><a href="#基本操作-2" class="headerlink" title="基本操作"></a>基本操作</h3><p>　　<code>dict</code>中键的类型必须是不可变的<code>(immutable)</code>，但值的类型则可以是可变(mutable)类型，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = &#123;<span class="number">1</span>: <span class="string">"first"</span>, <span class="number">2</span>: <span class="string">"second"</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">3</span>] = <span class="string">"third"</span>                       <span class="comment"># 增加新的键值对，键为3，值为"third"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="string">"name"</span>] = <span class="string">"senlin"</span>                 <span class="comment"># 增加新的键值对，键为"name"，值为"senlin"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.keys()                                                       </div><div class="line">dict_keys([<span class="string">'name'</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list(x.keys())</div><div class="line">[<span class="string">'name'</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list(x.values())</div><div class="line">[<span class="string">'first'</span>, <span class="string">'second'</span>, <span class="string">'third'</span>, <span class="string">'senlin'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">1</span>]                                 <span class="comment"># 返回键1对应的值</span></div><div class="line"><span class="string">'first'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">4</span>]                                 <span class="comment"># 若指定的键值对不存在，则会出现错误</span></div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;pyshell#45&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">    x[<span class="number">4</span>]</div><div class="line">KeyError: <span class="number">4</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.get(<span class="number">2</span>, <span class="string">"not exist"</span>)                <span class="comment"># 返回键2对应的值，若不存在，则返回"not exist"</span></div><div class="line"><span class="string">'second'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.get(<span class="number">4</span>, <span class="string">"not exist"</span>)                <span class="comment"># 返回键4对应的值，若不存在，则返回"not exist"</span></div><div class="line"><span class="string">'not exist'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">4</span>] = [<span class="string">"senlin"</span>, <span class="string">"zhan"</span>]            <span class="comment"># 值可以是可变类型</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">4</span>].append(<span class="string">"home"</span>)                  <span class="comment"># 对值进行修改</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x[<span class="number">4</span>]) </div><div class="line">[<span class="string">'senlin'</span>, <span class="string">'zhan'</span>, <span class="string">'home'</span>]</div></pre></td></tr></table></figure></p>
<p>　　可以使用<code>items()</code>方法来获得包含键值对的<code>tuple</code>序列：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = &#123;<span class="number">1</span>: <span class="string">'one'</span>, <span class="number">2</span>: <span class="string">'two'</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list(x.items())</div><div class="line">[(<span class="number">1</span>, <span class="string">'one'</span>), (<span class="number">2</span>, <span class="string">'two'</span>)]</div></pre></td></tr></table></figure></p>
<p>　　可以使用<code>del</code>命令来移除键值对：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = &#123;<span class="number">1</span>: <span class="string">'one'</span>, <span class="number">2</span>: <span class="string">'two'</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">del</span> x[<span class="number">1</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list(x.items())</div><div class="line">[(<span class="number">2</span>, <span class="string">'two'</span>)]</div></pre></td></tr></table></figure></p>
<p>　　<code>keys()</code>、<code>values()</code>和<code>items()</code>方法返回的并不是<code>list</code>对象，而是返回一个试图<code>(view)</code>，当<code>dict</code>对象改变时，这个试图也会相应得到更新，可以使用<code>for</code>循环对这个试图进行迭代。<br>　　访问并不存在于<code>dict</code>的键时，将会抛出异常，可以使用<code>in</code>操作符判断键是否存在于<code>dict</code>中：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = &#123;<span class="number">1</span>: <span class="string">'one'</span>, <span class="number">2</span>: <span class="string">'two'</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">3</span>]</div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;pyshell#28&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">    x[<span class="number">3</span>]</div><div class="line">KeyError: <span class="number">3</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">1</span> <span class="keyword">in</span> x</div><div class="line"><span class="keyword">True</span></div></pre></td></tr></table></figure></p>
<p>　　此外，当需要获得指定键对应的值，同时确保若键值对不存在时，需要在<code>dict</code>中增加指定的键值对，可以使用<code>setdefault()</code>方法：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = &#123;<span class="number">1</span>: <span class="string">'one'</span>, <span class="number">2</span>: <span class="string">'two'</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.setdefault(<span class="number">1</span>)                           <span class="comment"># 获得1对应的值</span></div><div class="line"><span class="string">'one'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.setdefault( <span class="string">'name'</span>, <span class="string">'senlin'</span>)           <span class="comment">#	由于不存在键'name'，新的键值对将会插入 </span></div><div class="line"><span class="string">'senlin'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="string">'name'</span>]</div><div class="line"><span class="string">'senlin'</span></div></pre></td></tr></table></figure></p>
<p>　　可以使用<code>copy()</code>方法来拷贝<code>dict</code>对象，但实际进行的是浅拷贝：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = &#123;<span class="number">1</span>: <span class="string">'one'</span>, <span class="number">2</span>: <span class="string">'two'</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = x.copy()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y</div><div class="line">&#123;<span class="number">1</span>: <span class="string">'one'</span>, <span class="number">2</span>: <span class="string">'two'</span>&#125;</div></pre></td></tr></table></figure></p>
<p>　　当<code>dict</code>的值中包含可变<code>(mutable)</code>对象，例如<code>list</code>，则需要使用<code>copy.deepcopy()</code>来实现深度拷贝。<br>　　可以使用<code>update()</code>方法将<code>dict</code>更新成为另一个<code>dict</code>对象，对于相同的键，键对应的值将会被新的键值对所替代：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = &#123;<span class="string">'name'</span>: <span class="string">'senlin'</span>, <span class="number">1</span>: <span class="string">'one'</span>, <span class="number">2</span>: <span class="string">'two'</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = &#123;<span class="number">1</span>: <span class="string">'first'</span>, <span class="number">2</span>: <span class="string">'second'</span>, <span class="number">3</span>: <span class="string">'third'</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x.update(y)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x</div><div class="line">&#123;<span class="string">'name'</span>: <span class="string">'senlin'</span>, <span class="number">2</span>: <span class="string">'second'</span>, <span class="number">3</span>: <span class="string">'third'</span>, <span class="number">1</span>: <span class="string">'first'</span>&#125;</div></pre></td></tr></table></figure></p>
<h3 id="键的类型"><a href="#键的类型" class="headerlink" title="键的类型"></a>键的类型</h3><p>　　不可变<code>(immutable)</code>并且是可散列<code>(hashable)</code>的类型均可用作<code>dict</code>的键类型，由于<code>list</code>是可变类型，因此，不能将<code>list</code>用作<code>dict</code>的键，但<code>tuple</code>则可以用作<code>dict</code>的键，不过需要注意这里有一个限制：由于<code>dict</code>的键需要是可散列的，这表示对象的散列码<code>(hash code)</code>在对象的生命周期内都不会改变，这就要求当<code>tuple</code>作为<code>dict</code>的键时，<code>tuple</code>中需要包含<strong>不可变</strong>的对象。</p>
<h3 id="稀疏矩阵"><a href="#稀疏矩阵" class="headerlink" title="稀疏矩阵"></a>稀疏矩阵</h3><p>　　使用嵌套的<code>list</code>表示矩阵：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">matrix = [[<span class="number">3</span>, <span class="number">0</span>, <span class="number">-2</span>, <span class="number">11</span>], [<span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">-5</span>]]</div></pre></td></tr></table></figure></p>
<p>　　但在处理巨型矩阵时，有时矩阵中会包含部分的<code>0</code>值，为节省存储空间，这时可以使用<code>dict</code>来表示矩阵，键使用<code>tuple</code>类型，前面的矩阵可以等价成：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>matrix = &#123;(<span class="number">0</span>, <span class="number">0</span>): <span class="number">3</span>, (<span class="number">0</span>, <span class="number">2</span>): <span class="number">-2</span>, (<span class="number">0</span>, <span class="number">3</span>): <span class="number">11</span>,</div><div class="line">	      (<span class="number">1</span>, <span class="number">1</span>): <span class="number">9</span>, (<span class="number">2</span>, <span class="number">1</span>): <span class="number">7</span>, (<span class="number">3</span>, <span class="number">3</span>): <span class="number">-5</span>&#125;</div></pre></td></tr></table></figure></p>
<p>　　可以使用以下方式来获得稀疏矩阵中特定的值：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>row, col = <span class="number">3</span>, <span class="number">3</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>elements = matrix.get((row, col), <span class="number">0</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>elements</div><div class="line"><span class="number">-5</span></div></pre></td></tr></table></figure></p>
<h3 id="用作缓冲存储"><a href="#用作缓冲存储" class="headerlink" title="用作缓冲存储"></a>用作缓冲存储</h3><p>　　<code>dict</code>可以用作缓冲存储，例如，在计算任务中若需要对相同的值执行多次计算，可以考虑把计算所得的结果存储在<code>dict</code>中以减少重复计算的次数：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">sole_cache = &#123;&#125;                         <span class="comment"># 全局的dict对象</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sole</span><span class="params">(m, n, t)</span>:</span></div><div class="line">    <span class="keyword">if</span> (m, n, t) <span class="keyword">in</span> sole_cache:</div><div class="line">       <span class="keyword">return</span> sole_cache[(m, n, t)]</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">	<span class="comment"># . . . 这里需要执行一些计算任务</span></div><div class="line">	sole_cache[(m, n, t)] = result</div><div class="line">	<span class="keyword">return</span> result</div></pre></td></tr></table></figure></p>
<h3 id="dict的迭代"><a href="#dict的迭代" class="headerlink" title="dict的迭代"></a>dict的迭代</h3><p>　　通常，可以使用以下的方式进行<code>dict</code>的迭代：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = &#123;<span class="number">1</span>: <span class="string">'one'</span>, <span class="number">2</span>: <span class="string">'two'</span>, <span class="number">3</span>: <span class="string">'three'</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> key <span class="keyword">in</span> x:</div><div class="line">	print(<span class="string">'key = &#123;0&#125;, value = &#123;1&#125;'</span>.format(key, x[key]))</div><div class="line"></div><div class="line">key = <span class="number">1</span>, value = one</div><div class="line">key = <span class="number">2</span>, value = two</div><div class="line">key = <span class="number">3</span>, value = three</div><div class="line">```　　</div><div class="line">　　有时需要对原有的`dict`进行修改，而得到一个新的`dict`，这时可以使用以下的简化方式：</div><div class="line">```python</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x_square_dict = &#123;item: item * item <span class="keyword">for</span> item <span class="keyword">in</span> x&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x_square_dict</div><div class="line">&#123;<span class="number">1</span>: <span class="number">1</span>, <span class="number">2</span>: <span class="number">4</span>, <span class="number">3</span>: <span class="number">9</span>, <span class="number">4</span>: <span class="number">16</span>&#125;</div></pre></td></tr></table></figure></p>
<h1 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h1><p>　　使用<code>open()</code>可以打开文件用于读取或写入，而使用<code>close()</code>来关闭文件：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>f = open(<span class="string">"myfile"</span>, <span class="string">"w"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f.write(<span class="string">"First line"</span>)</div><div class="line"><span class="number">10</span>                                   <span class="comment"># 10表示写入的字符数</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f.close()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f = open(<span class="string">"myfile"</span>, <span class="string">"r"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>line = f.readline()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f.close()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(line)</div><div class="line">First line</div></pre></td></tr></table></figure></p>
<p>　　可以使用<code>os</code>模块中的函数来对文件系统进行操作，也可以用来处理文件或目录的路径名：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> os</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(os.getcwd())                                <span class="comment"># 输出当前目录</span></div><div class="line">/home/senlin </div><div class="line"><span class="meta">&gt;&gt;&gt; </span>os.chdir(os.path.join(<span class="string">"/home"</span>, <span class="string">"senlin"</span>, <span class="string">"work"</span>)) <span class="comment"># 改变当前目录</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(os.getcwd())</div><div class="line">/home/senlin/work</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>os.chdir(<span class="string">"/home/senlin/MyWork"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(os.getcwd())</div><div class="line">/home/senlin/MyWork</div></pre></td></tr></table></figure></p>
<h1 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h1><p>　　函数定义中的第一行通常用作文档说明，用来指明函数的功能及其接受的参数和返回的结果。通常使用<code>&quot;&quot;&quot;</code>作为字符串的界定符，以支持多行的文档说明：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">fact</span><span class="params">(n)</span>:</span></div><div class="line">	<span class="string">"""Return the factorial of the given number."""</span></div><div class="line">	r = <span class="number">1</span></div><div class="line">	<span class="keyword">while</span> n &gt; <span class="number">0</span>:</div><div class="line">		r = r * n</div><div class="line">		n -= <span class="number">1</span></div><div class="line">	<span class="keyword">return</span> r</div></pre></td></tr></table></figure></p>
<h2 id="传递参数"><a href="#传递参数" class="headerlink" title="传递参数"></a>传递参数</h2><p>　　<code>Python</code>中函数参数的传递方式比较灵活，可以根据参数的位置传递参数，也可以使用参数名来传递参数：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">fun1</span><span class="params">(x, y)</span>:</span></div><div class="line">	<span class="keyword">return</span> x**<span class="number">2</span> + y</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>u, v = <span class="number">10</span>, <span class="number">20</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fun1(u, v)                   <span class="comment"># 按位置传递参数</span></div><div class="line"><span class="number">120</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fun1(x = u, y = v)           <span class="comment"># 按参数名传递参数</span></div><div class="line"><span class="number">120</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fun1(y = u, x = v)           <span class="comment"># 按参数名传递参数</span></div><div class="line"><span class="number">410</span></div></pre></td></tr></table></figure></p>
<h2 id="默认参数"><a href="#默认参数" class="headerlink" title="默认参数"></a>默认参数</h2><p>　　函数也可以拥有默认参数：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">fun2</span><span class="params">(x, y = <span class="number">1</span>, z = <span class="number">1</span>)</span>:</span></div><div class="line">	<span class="keyword">return</span> x**<span class="number">2</span> + y*<span class="number">2</span> + z</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fun2(<span class="number">10</span>)                 <span class="comment"># x为10，y为1，z为1</span></div><div class="line"><span class="number">103</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fun2(<span class="number">10</span>, z = <span class="number">8</span>)          <span class="comment"># x为10，y为1，z为8</span></div><div class="line"><span class="number">110</span></div></pre></td></tr></table></figure></p>
<p>　　但注意，默认参数应该出现在参数列表的末尾，若在参数列表的开头使用默认参数，而在参数列表的末尾没有使用默认参数，则会发生错误：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">fun2</span><span class="params">(x = <span class="number">1</span>, y, z)</span>:</span></div><div class="line">	<span class="keyword">return</span> x ** <span class="number">2</span> + y * <span class="number">2</span> + z</div><div class="line">SyntaxError: non-default argument follows default argument</div></pre></td></tr></table></figure></p>
<h2 id="可变数目参数"><a href="#可变数目参数" class="headerlink" title="可变数目参数"></a>可变数目参数</h2><p>　　函数可以拥有特殊的参数，表示一个<code>tuple</code>对象，当传递给函数的实参数目多于形参数目时，这些额外的实参将会保存在这个<code>tuple</code>对象中，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">fun3</span><span class="params">(x, y = <span class="number">5</span>, z = <span class="number">10</span>, *tup)</span>:</span></div><div class="line">	print((x, y, z) + tup)</div><div class="line">	</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fun3(<span class="number">100</span>)                          <span class="comment"># x为100，y为5，z为10</span></div><div class="line">(<span class="number">100</span>, <span class="number">5</span>, <span class="number">10</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fun3(<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>)           <span class="comment"># x为10，y为20，z为30</span></div><div class="line">(<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>)</div></pre></td></tr></table></figure></p>
<p>　　同样，当传递的额外的参数是按参数名传递，并且这些参数名没有出现在函数的定义中，这时可以将这些额外的参数保存在<code>dict</code>中：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">fun4</span><span class="params">(x, y, **dictionary)</span>:</span></div><div class="line">	print(x, y, dictionary)</div><div class="line">	</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fun4(<span class="number">10</span>, <span class="number">20</span>)</div><div class="line"><span class="number">10</span> <span class="number">20</span> &#123;&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fun4(<span class="number">10</span>, <span class="number">20</span>, m = <span class="number">100</span>, n  =<span class="number">1000</span>)</div><div class="line"><span class="number">10</span> <span class="number">20</span> &#123;<span class="string">'m'</span>: <span class="number">100</span>, <span class="string">'n'</span>: <span class="number">1000</span>&#125;</div></pre></td></tr></table></figure></p>
<h2 id="实参是可变对象"><a href="#实参是可变对象" class="headerlink" title="实参是可变对象"></a>实参是可变对象</h2><p>　　参数是按照指针传递的，因此，当函数的实参是可变对象时，在函数中对可变对象作出修改都会影响到这个可变对象本来的值，但在函数中，对形参进行重新赋值，则不会改变实参的值。简而言之，对于可变对象，可以修改可变对象的值，但无法对其重新赋值：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">(n, list1, list2)</span>:</span></div><div class="line">	list1.append(<span class="number">100</span>)</div><div class="line">	list2 = []</div><div class="line">	n += <span class="number">1</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="number">5</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>z = [<span class="number">10</span>, <span class="number">20</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fun(x, y, z)                 </div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x, y, z)                </div><div class="line"><span class="number">5</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">100</span>] [<span class="number">10</span>, <span class="number">20</span>]                <span class="comment"># z执行的对象保持不变</span></div></pre></td></tr></table></figure></p>
<h2 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h2><p>　　在函数中可以使用<code>global</code>来表示变量是全局变量：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">()</span>:</span></div><div class="line">	<span class="keyword">global</span> a</div><div class="line">	a = <span class="number">0</span></div><div class="line">	b = <span class="number">1</span></div><div class="line">	</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="string">'hello'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b = <span class="string">'world'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fun()                          <span class="comment"># 将会改变a的值，b保持不变</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(a, b)</div><div class="line"><span class="number">0</span> world</div></pre></td></tr></table></figure></p>
<p>　　<code>nonlocal</code>语句与<code>global</code>语句类似，<code>nonlocal</code>语句用来引用其上一层作用域<code>(scope)</code>中的变量，<code>global</code>则用来引用顶层作用域<code>(top-level scope)</code>中的变量：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># nonlocal.py</span></div><div class="line">g_var = <span class="number">0</span></div><div class="line">nl_var = <span class="number">0</span></div><div class="line">print(<span class="string">"top level-&gt; g_var: &#123;0&#125; nl_var: &#123;1&#125;"</span>.format(g_var, nl_var))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">()</span>:</span></div><div class="line">    nl_var = <span class="number">2</span></div><div class="line">    print(<span class="string">"in test-&gt; g_var: &#123;0&#125; nl_var: &#123;1&#125;"</span>.format(g_var, nl_var))</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner_test</span><span class="params">()</span>:</span></div><div class="line">        <span class="keyword">global</span> g_var                      <span class="comment"># 引用到全部变量</span></div><div class="line">        <span class="keyword">nonlocal</span> nl_var                   <span class="comment"># 引用到其上一层作用域中的g_var</span></div><div class="line">        g_var = <span class="number">1</span>                         <span class="comment"># 将全局变量修改成为1</span></div><div class="line">        nl_var = <span class="number">4</span>                        <span class="comment"># 修改其上一层作用域中的nl_var，不会影响到全局变量</span></div><div class="line">        print(<span class="string">"in inner_test-&gt; g_var: &#123;0&#125; nl_var: &#123;1&#125;"</span>.format(g_var, nl_var))</div><div class="line"></div><div class="line">    inner_test()</div><div class="line">    print(<span class="string">"in test-&gt; g_var: &#123;0&#125; nl_var: &#123;1&#125;"</span>.format(g_var, nl_var))</div><div class="line">test()</div><div class="line">print(<span class="string">"top level-&gt; g_var: &#123;0&#125; nl_var: &#123;1&#125;"</span>.format(g_var, nl_var))</div></pre></td></tr></table></figure></p>
<p>　　运行文件，则会输出：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">top level-&gt; g_var: 0 nl_var: 0</div><div class="line">in test-&gt; g_var: 0 nl_var: 2</div><div class="line">in inner_test-&gt; g_var: 1 nl_var: 4</div><div class="line">in test-&gt; g_var: 1 nl_var: 4</div><div class="line">top level-&gt; g_var: 1 nl_var: 0</div></pre></td></tr></table></figure></p>
<p>　　可以发现，全局变量<code>nl_var</code>的值并没有改变，这是因为<code>inner_test()</code>中的<code>`nl_var</code>引用到的实际上是<code>test()</code>中的<code>nl_var</code>变量。</p>
<h2 id="函数赋值给变量"><a href="#函数赋值给变量" class="headerlink" title="函数赋值给变量"></a>函数赋值给变量</h2><p>　　可以将函数赋值给变量：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">(v)</span>:</span></div><div class="line">	<span class="keyword">return</span> v + <span class="number">10</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fun_var = fun</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fun_var(<span class="number">100</span>)</div><div class="line"><span class="number">110</span></div></pre></td></tr></table></figure></p>
<p>　　也可以将函数作为<code>list</code>、<code>tuple</code>或<code>dict</code>的成员：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">add10</span><span class="params">(v)</span>:</span></div><div class="line">	<span class="keyword">return</span> v + <span class="number">10</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">add20</span><span class="params">(v)</span>:</span></div><div class="line">	<span class="keyword">return</span> v + <span class="number">20</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>t = &#123;<span class="string">'add10'</span>: add10, <span class="string">'add20'</span>: add20&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>t[<span class="string">'add10'</span>](<span class="number">10</span>)</div><div class="line"><span class="number">20</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>t[<span class="string">'add20'</span>](<span class="number">20</span>)</div><div class="line"><span class="number">40</span></div></pre></td></tr></table></figure></p>
<h2 id="lambda表达式"><a href="#lambda表达式" class="headerlink" title="lambda表达式"></a>lambda表达式</h2><p>　　有时需要将一个函数作为另一函数的参数，这时可以使用<code>lambda</code>表达式：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>t = &#123;<span class="string">'add10'</span>: <span class="keyword">lambda</span> v: v + <span class="number">10</span>, <span class="string">'add20'</span>: <span class="keyword">lambda</span> v: v + <span class="number">20</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>t[<span class="string">'add10'</span>](<span class="number">100</span>)</div><div class="line"><span class="number">110</span></div></pre></td></tr></table></figure></p>
<p>　　<code>lambda</code>表达式并没有<code>return</code>语句，其值将会自动返回。</p>
<h2 id="生成器函数"><a href="#生成器函数" class="headerlink" title="生成器函数"></a>生成器函数</h2><p>　　生成器函数通常用在<code>for</code>循环中，用来在每次迭代时生成相应的值，函数中使用<code>yield</code>语句来返回所生成的值。与一般函数不同的是，在生成器函数中，局部变量在每次函数调用之后会得到保存而不会销毁：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">four</span><span class="params">()</span>:</span></div><div class="line">	x = <span class="number">0</span></div><div class="line">	<span class="keyword">while</span> x &lt; <span class="number">4</span>:</div><div class="line">		print(<span class="string">'in generator, x = '</span>, x)</div><div class="line">		<span class="keyword">yield</span> x</div><div class="line">		x += <span class="number">1</span></div><div class="line">		</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> four():</div><div class="line">	print(i)</div><div class="line"></div><div class="line"><span class="keyword">in</span> generator, x =  <span class="number">0</span></div><div class="line"><span class="number">0</span></div><div class="line"><span class="keyword">in</span> generator, x =  <span class="number">1</span></div><div class="line"><span class="number">1</span></div><div class="line"><span class="keyword">in</span> generator, x =  <span class="number">2</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="keyword">in</span> generator, x =  <span class="number">3</span></div></pre></td></tr></table></figure></p>
<p>　　可以使用<code>in</code>操作符来判断生成器函数是否会产生指定的值：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">2</span> <span class="keyword">in</span> four()</div><div class="line"><span class="keyword">in</span> generator, x =  <span class="number">0</span></div><div class="line"><span class="keyword">in</span> generator, x =  <span class="number">1</span></div><div class="line"><span class="keyword">in</span> generator, x =  <span class="number">2</span></div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">5</span> <span class="keyword">in</span> four()</div><div class="line"><span class="keyword">in</span> generator, x =  <span class="number">0</span></div><div class="line"><span class="keyword">in</span> generator, x =  <span class="number">1</span></div><div class="line"><span class="keyword">in</span> generator, x =  <span class="number">2</span></div><div class="line"><span class="keyword">in</span> generator, x =  <span class="number">3</span></div><div class="line"><span class="keyword">False</span></div></pre></td></tr></table></figure></p>
<h2 id="装饰器函数"><a href="#装饰器函数" class="headerlink" title="装饰器函数"></a>装饰器函数</h2><p>　　<code>Python</code>中的函数可以接受另一函数作为参数，将接受的函数包装成另一新的函数，并返回这个新的函数：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">decorate</span><span class="params">(func)</span>:</span></div><div class="line">	print(<span class="string">'in decorate function, decorating'</span>, func.__name__)</div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">wrapper_func</span><span class="params">(*args)</span>:</span></div><div class="line">		print(<span class="string">'Executing'</span>, func.__name__)</div><div class="line">		<span class="keyword">return</span> func(*args)</div><div class="line">	<span class="keyword">return</span> wrapper_func</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">myfunction</span><span class="params">(parameter)</span>:</span></div><div class="line">	print(parameter)</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>myfunction = decorate(myfunction)</div><div class="line"><span class="keyword">in</span> decorate function, decorating myfunction</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>myfunction(<span class="string">'hello'</span>)</div><div class="line">Executing myfunction</div><div class="line">hello</div></pre></td></tr></table></figure></p>
<p>　　使用装饰器函数涉及两个过程，首先，定义一个函数用来装饰另一个函数，其次，在被装饰函数前加上<code>@</code>和装饰器的函数名，其中，装饰器函数需要接受函数作为参数并且需要返回另一函数：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">decorate</span><span class="params">(func)</span>:</span></div><div class="line">	print(<span class="string">'in decorate function, decorating'</span>, func.__name__)</div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">wrapper_func</span><span class="params">(*args)</span>:</span></div><div class="line">		print(<span class="string">'Executing'</span>, func.__name__)</div><div class="line">		<span class="keyword">return</span> func(*args)</div><div class="line">	<span class="keyword">return</span> wrapper_func</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>@decorate</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">myfunction</span><span class="params">(parameter)</span>:</span></div><div class="line">	print(parameter)</div><div class="line">	</div><div class="line"><span class="keyword">in</span> decorate function, decorating myfunction</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>myfunction(<span class="string">'hello'</span>)</div><div class="line">Executing myfunction</div><div class="line">hello</div></pre></td></tr></table></figure></p>
<p>　　当被装饰函数<code>myfunction()</code>定义时，实际上<code>decorate()</code>函数将会被执行，因此，在<code>myfunction()</code>函数定义结束时，<code>myfunction</code>将会等价于<code>decorate(myfunction)</code>。</p>
<h1 id="模块与作用域"><a href="#模块与作用域" class="headerlink" title="模块与作用域"></a>模块与作用域</h1><p>　　模块是包含代码的文件，模块中可以定义函数和其它的类，文件名即为模块名。为了避免与其它模块产生名字冲突，每个模块定义了其自身的名字空间。</p>
<h2 id="创建模块"><a href="#创建模块" class="headerlink" title="创建模块"></a>创建模块</h2><p>　　创建模块，将其命名为<code>mymath.py</code>文件：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="string">"""mymath - our example math module"""</span></div><div class="line">pi = <span class="number">3.14159</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">area</span><span class="params">(r)</span>:</span></div><div class="line">    <span class="string">"""area(r): return the area of a circle with radius r."""</span></div><div class="line">    <span class="keyword">global</span> pi</div><div class="line">    <span class="keyword">return</span>(pi * r * r)</div></pre></td></tr></table></figure></p>
<p>　　可以使用<code>mymath</code>模块：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> mymath</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>mymath.pi</div><div class="line"><span class="number">3.14159</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>mymath.area(<span class="number">2</span>)</div><div class="line"><span class="number">12.56636</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>mymath.__doc__                     <span class="comment"># 模块的文档说明</span></div><div class="line"><span class="string">'mymath - our example math module'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>mymath.area.__doc__                <span class="comment"># 模块中函数的文档说明</span></div><div class="line"><span class="string">'area(r): return the area of a circle with radius r.'</span></div></pre></td></tr></table></figure></p>
<p>　　访问模块中的成员也可以不使用模块名作为修饰：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> mymath <span class="keyword">import</span> pi</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>pi</div><div class="line"><span class="number">3.14159</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>area(<span class="number">2</span>)</div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;pyshell#7&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">    area(<span class="number">2</span>)</div><div class="line">NameError: name <span class="string">'area'</span> <span class="keyword">is</span> <span class="keyword">not</span> defined</div></pre></td></tr></table></figure></p>
<p>　　也可以访问模块中的<code>public</code>名字而不需要模块名作为修饰：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> mymath <span class="keyword">import</span> *</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>area(<span class="number">2</span>)</div><div class="line"><span class="number">12.56636</span></div></pre></td></tr></table></figure></p>
<h2 id="模块搜索路径"><a href="#模块搜索路径" class="headerlink" title="模块搜索路径"></a>模块搜索路径</h2><p>　　可以使用<code>sys.path</code>来获得模块的搜索路径：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>sys.path</div><div class="line">[<span class="string">''</span>, <span class="string">'/home/senlin'</span>, <span class="string">'/usr/bin'</span>, <span class="string">'/usr/lib/python3.4'</span>, </div><div class="line"><span class="string">'/usr/lib/python3.4/plat-i386-linux-gnu'</span>, <span class="string">'/usr/lib/python3.4/lib-dynload'</span>, </div><div class="line"><span class="string">'/usr/local/lib/python3.4/dist-packages'</span>, <span class="string">'/usr/lib/python3/dist-packages'</span>]</div><div class="line">```　　</div><div class="line">　　搜索路径中的第一个路径为`<span class="string">''</span>`，表示`Python`首先会在当前目录中搜索模块。此外，在导入了`mymath`模块之后，若修改了`mymath.py`文件，此时再次使用`<span class="keyword">import</span> mymath`命令将无法立即使修改的内容起作用，这时需要使用`imp`模块中的`reload()`函数对`mymath`模块重新载入：</div></pre></td></tr></table></figure></p>
<blockquote>
<blockquote>
<blockquote>
<p>import imp<br>imp.reload(mymath)</p>
<p><module 'mymath'="" from="" '="" home="" senlin="" mymath.py'=""><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">　　若存在系统环境变量`PYTHONPATH`，则`sys.path`变量的值将根据这个环境变量来初始化。当运行`Python`脚本时，脚本所在的文件夹将会作为`sys.path`变量的第一个元素。</div><div class="line">　　为了使程序可以访问自定义的模块，可以使用以下几种方式：</div><div class="line">- 将自定义模块放在`Python`搜索模块的那些文件夹中。</div><div class="line">- 将`Python`程序使用的模块放在`Python`程序相同的文件夹中。</div><div class="line">- 创建文件夹来存放自定义模块，并修改`sys.path`的值使其包含新的文件夹。</div><div class="line">　　通常**不能使用**第一种方式，这是因为若文件存放在这些文件夹中，新版本的`Python`在安装时可能会将自定义的模块删除。最好的方式是使用第二种方式。</div><div class="line">　　而当自定义的模块需要在多个程序中使用时，则可以使用第三种方式，这时可以在代码中修改`sys.path`的值使其包含新的文件夹，但在代码中指定模块的路径较为不方便，因此，可以修改环境变量`PYTHONPATH`，使其包含自定义模块的路径，这样，自定义模块的路径就拼接在`sys.path`变量中其它路径之前，但需要保证自定义模块的名称不能与既存库的模块名称产生冲突。</div><div class="line">## 模块中的私有名字</div><div class="line">　　使用`from module import *`可以导入模块中几乎所有的名字，但以下划线`_`开头的名字则无法被导入：</div><div class="line">```python</div><div class="line">&gt;&gt;&gt; from modtest import *</div><div class="line">&gt;&gt;&gt; f(10)</div><div class="line">10</div><div class="line">&gt;&gt;&gt; _g(10)</div><div class="line">Traceback (most recent call last):</div><div class="line">  File &quot;&lt;pyshell#2&gt;&quot;, line 1, in &lt;module&gt;</div><div class="line">    _g(10)</div><div class="line">NameError: name &apos;_g&apos; is not defined</div><div class="line">&gt;&gt;&gt; a</div><div class="line">4</div><div class="line">&gt;&gt;&gt; _b</div><div class="line">Traceback (most recent call last):</div><div class="line">  File &quot;&lt;pyshell#4&gt;&quot;, line 1, in &lt;module&gt;</div><div class="line">    _b</div><div class="line">NameError: name &apos;_b&apos; is not defined</div></pre></td></tr></table></figure></module></p>
</blockquote>
</blockquote>
</blockquote>
<p>　　但可以显示地对模块中的私有名字进行访问：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> modtest</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>modtest._g(<span class="number">10</span>)</div><div class="line"><span class="number">10</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>modtest._b</div><div class="line"><span class="number">2</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> modtest <span class="keyword">import</span> _g</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>_g(<span class="number">10</span>)</div><div class="line"><span class="number">10</span></div></pre></td></tr></table></figure></p>
<h2 id="名字空间与作用域"><a href="#名字空间与作用域" class="headerlink" title="名字空间与作用域"></a>名字空间与作用域</h2><p>　　名字空间实际上是变量名到对象的映射，当代码块执行时，将同时存在<code>3</code>种名字空间，局部<code>(local)</code>名字空间、全局<code>(global)</code>名字空间和內置<code>(built-in)</code>名字空间。<code>Python</code>在处理变量名时，首先会在局部名字空间中寻找变量，若变量并存在于局部名字空间中，则在全局名字空间中寻找，若仍然无法找到，则在内置名字空间中寻找，若无法找到，则会抛出<code>NameError</code>异常。<br>　　在函数被调用时，其局部名字空间中将包含函数的参数和在函数中定义的变量。内置的名字空间则是定义在<code>__builtins__</code>模块中的函数和类。但实际上可以对<code>__builtins__</code>模块中的名字进行覆写<code>(override)</code>，例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>list((<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>))                <span class="comment"># 可以使用list()函数</span></div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]               <span class="comment"># list作为变量名</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list((<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>))                <span class="comment"># 无法再使用list函数</span></div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;pyshell#18&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">    list((<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>))</div><div class="line">TypeError: <span class="string">'list'</span> object <span class="keyword">is</span> <span class="keyword">not</span> callable</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">del</span> list                       <span class="comment"># 删除list变量</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list((<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>))                <span class="comment"># 可以重新使用list函数</span></div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</div></pre></td></tr></table></figure></p>
<p>　　可以使用<code>locals()</code>和<code>globals()</code>函数来分别查看当前的局部和全局名字空间：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; locals()</div><div class="line">&#123;'__spec__': None, '__doc__': None, '__loader__': &lt;class '_frozen_importlib.BuiltinImporter'&gt;,</div><div class="line"> '__package__': None, '__name__': '__main__', '__builtins__': &lt;module 'builtins' (built-in)&gt;&#125;</div><div class="line">&gt;&gt;&gt; globals()</div><div class="line">&#123;'__spec__': None, '__doc__': None, '__loader__': &lt;class '_frozen_importlib.BuiltinImporter'&gt;, </div><div class="line">'__package__': None, '__name__': '__main__', '__builtins__': &lt;module 'builtins' (built-in)&gt;&#125;</div></pre></td></tr></table></figure></p>
<p>　　在创建变量或导入模块之后，局部名字空间和全局名字空间将会发生改变：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; z = 2</div><div class="line">&gt;&gt;&gt; import math</div><div class="line">&gt;&gt;&gt; from cmath import cos</div><div class="line">&gt;&gt;&gt; globals()</div><div class="line">&#123;'__spec__': None, 'math': &lt;module 'math' (built-in)&gt;, '__doc__': None, </div><div class="line">'__loader__': &lt;class '_frozen_importlib.BuiltinImporter'&gt;, '__package__': None, </div><div class="line">'__name__': '__main__', 'z': 2, 'cos': &lt;built-in function cos&gt;, </div><div class="line">'__builtins__': &lt;module 'builtins' (built-in)&gt;&#125;</div><div class="line">&gt;&gt;&gt; locals()</div><div class="line">&#123;'__spec__': None, 'math': &lt;module 'math' (built-in)&gt;, '__doc__': None, </div><div class="line">'__loader__': &lt;class '_frozen_importlib.BuiltinImporter'&gt;, '__package__': None, </div><div class="line">'__name__': '__main__', 'z': 2, 'cos': &lt;built-in function cos&gt;, </div><div class="line">'__builtins__': &lt;module 'builtins' (built-in)&gt;&#125;</div></pre></td></tr></table></figure></p>
<p>　　这里全局名字空间与局部名字空间相同。可以使用<code>del</code>来移除变量和导入的模块：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; del z, math, cos</div><div class="line">&gt;&gt;&gt; locals()</div><div class="line">&#123;'__spec__': None, '__doc__': None, '__loader__': &lt;class '_frozen_importlib.BuiltinImporter'&gt;, </div><div class="line">'__package__': None, '__name__': '__main__', '__builtins__': &lt;module 'builtins' (built-in)&gt;&#125;</div><div class="line">&gt;&gt;&gt; globals()</div><div class="line">&#123;'__spec__': None, '__doc__': None, '__loader__': &lt;class '_frozen_importlib.BuiltinImporter'&gt;, </div><div class="line">'__package__': None, '__name__': '__main__', '__builtins__': &lt;module 'builtins' (built-in)&gt;&#125;</div><div class="line">&gt;&gt;&gt; math.ceil(4.9)</div><div class="line">Traceback (most recent call last):</div><div class="line">  File "&lt;pyshell#10&gt;", line 1, in &lt;module&gt;</div><div class="line">    math.ceil(4.9)</div><div class="line">NameError: name 'math' is not defined</div><div class="line">&gt;&gt;&gt; import math</div><div class="line">&gt;&gt;&gt; math.ceil(4.9)</div><div class="line">5</div></pre></td></tr></table></figure></p>
<p>　　定义函数并查看全局和局部名字空间：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; def f(x):</div><div class="line">	print('globals: ', globals())</div><div class="line">	print('Entry local: ', locals())</div><div class="line">	y = x</div><div class="line">	print('Exit local: ', locals())</div><div class="line"></div><div class="line">&gt;&gt;&gt; z = 2</div><div class="line">&gt;&gt;&gt; globals()</div><div class="line">&#123;'__doc__': None, 'f': &lt;function f at 0xb6cd480c&gt;, 'z': 2, '__package__': None, </div><div class="line">'__builtins__': &lt;module 'builtins' (built-in)&gt;, </div><div class="line">'__loader__': &lt;class '_frozen_importlib.BuiltinImporter'&gt;, '__name__': '__main__', </div><div class="line">'__spec__': None&#125;</div><div class="line">&gt;&gt;&gt; f(z)</div><div class="line">globals:  &#123;'__doc__': None, 'f': &lt;function f at 0xb6cd480c&gt;, 'z': 2, '__package__': None, </div><div class="line">'__builtins__': &lt;module 'builtins' (built-in)&gt;, </div><div class="line">'__loader__': &lt;class '_frozen_importlib.BuiltinImporter'&gt;, '__name__': '__main__', </div><div class="line">'__spec__': None&#125;</div><div class="line">Entry local:  &#123;'x': 2&#125;</div><div class="line">Exit local:  &#123;'y': 2, 'x': 2&#125;</div></pre></td></tr></table></figure></p>
<p>　　注意，在调用函数<code>f()</code>时，其全局名字空间中包含变量<code>z</code>，这时因为在<code>f()</code>调用之前，就已经定义了变量<code>z</code>了。当函数定义在模块中时，函数的全局名字空间就与模块的全局名字空间相同，例如，创建<code>scopetest</code>模块：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="string">"""scopetest: our scope test module"""</span></div><div class="line">v = <span class="number">6</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x)</span>:</span></div><div class="line">    <span class="string">"""f: scope test function"""</span></div><div class="line">    print(<span class="string">"global: "</span>, list(globals().keys()))</div><div class="line">    print(<span class="string">"entry local:"</span>, locals())</div><div class="line">    y = x</div><div class="line">    w = v</div><div class="line">    print(<span class="string">"exit local:"</span>, list(locals().keys()))</div></pre></td></tr></table></figure></p>
<p>　　测试<code>scopetest</code>模块：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> scopetest</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>z = <span class="number">2</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>scopetest.f(z)</div><div class="line"><span class="keyword">global</span>:  [<span class="string">'v'</span>, <span class="string">'__doc__'</span>, <span class="string">'f'</span>, <span class="string">'__builtins__'</span>, <span class="string">'__package__'</span>, <span class="string">'__file__'</span>, </div><div class="line"><span class="string">'__cached__'</span>, <span class="string">'__loader__'</span>, <span class="string">'__name__'</span>, <span class="string">'__spec__'</span>]</div><div class="line">entry local: &#123;<span class="string">'x'</span>: <span class="number">2</span>&#125;</div><div class="line">exit local: [<span class="string">'w'</span>, <span class="string">'y'</span>, <span class="string">'x'</span>]</div></pre></td></tr></table></figure></p>
<p>　　这里，在<code>f()</code>函数中，全局名字空间包含<code>scopetest</code>模块中的全局名字，也包含函数<code>f</code>和变量<code>v</code>，但注意，并没有包含变量<code>z</code>，因此，在创建模块时，<strong>拥有对模块函数其名字空间的控制权</strong>。<br>　　可以使用<code>dir()</code>函数列出<code>__builtins__</code>模块中的名字：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>dir(__builtins__)</div><div class="line">[<span class="string">'ArithmeticError'</span>, <span class="string">'AssertionError'</span>, <span class="string">'AttributeError'</span>, <span class="string">'BaseException'</span>, <span class="string">'BlockingIOError'</span>, </div><div class="line"><span class="string">'BrokenPipeError'</span>, <span class="string">'BufferError'</span>, <span class="string">'BytesWarning'</span>, <span class="string">'ChildProcessError'</span>, <span class="string">'ConnectionAbortedError'</span>,</div><div class="line"><span class="string">'ConnectionError'</span>, <span class="string">'ConnectionRefusedError'</span>, <span class="string">'ConnectionResetError'</span>, <span class="string">'DeprecationWarning'</span>, </div><div class="line"><span class="string">'EOFError'</span>, <span class="string">'Ellipsis'</span>, <span class="string">'EnvironmentError'</span>, <span class="string">'Exception'</span>, <span class="string">'False'</span>, <span class="string">'FileExistsError'</span>, </div><div class="line"><span class="string">'FileNotFoundError'</span>, <span class="string">'FloatingPointError'</span>, <span class="string">'FutureWarning'</span>, <span class="string">'GeneratorExit'</span>, <span class="string">'IOError'</span>, </div><div class="line"><span class="string">'ImportError'</span>, <span class="string">'ImportWarning'</span>, <span class="string">'IndentationError'</span>, <span class="string">'IndexError'</span>, <span class="string">'InterruptedError'</span>, </div><div class="line"><span class="string">'IsADirectoryError'</span>, <span class="string">'KeyError'</span>, <span class="string">'KeyboardInterrupt'</span>, <span class="string">'LookupError'</span>, <span class="string">'MemoryError'</span>, <span class="string">'NameError'</span>,</div><div class="line"><span class="string">'None'</span>, <span class="string">'NotADirectoryError'</span>, <span class="string">'NotImplemented'</span>, <span class="string">'NotImplementedError'</span>, <span class="string">'OSError'</span>, <span class="string">'OverflowError'</span>,</div><div class="line"><span class="string">'PendingDeprecationWarning'</span>, <span class="string">'PermissionError'</span>, <span class="string">'ProcessLookupError'</span>, <span class="string">'ReferenceError'</span>, </div><div class="line"><span class="string">'ResourceWarning'</span>, <span class="string">'RuntimeError'</span>, <span class="string">'RuntimeWarning'</span>, <span class="string">'StopIteration'</span>, <span class="string">'SyntaxError'</span>, </div><div class="line"><span class="string">'SyntaxWarning'</span>, <span class="string">'SystemError'</span>, <span class="string">'SystemExit'</span>, <span class="string">'TabError'</span>, <span class="string">'TimeoutError'</span>, <span class="string">'True'</span>, <span class="string">'TypeError'</span>, </div><div class="line"><span class="string">'UnboundLocalError'</span>, <span class="string">'UnicodeDecodeError'</span>, <span class="string">'UnicodeEncodeError'</span>, <span class="string">'UnicodeError'</span>, </div><div class="line"><span class="string">'UnicodeTranslateError'</span>, <span class="string">'UnicodeWarning'</span>, <span class="string">'UserWarning'</span>, <span class="string">'ValueError'</span>, <span class="string">'Warning'</span>, </div><div class="line"><span class="string">'ZeroDivisionError'</span>, <span class="string">'_'</span>, <span class="string">'__build_class__'</span>, <span class="string">'__debug__'</span>, <span class="string">'__doc__'</span>, <span class="string">'__import__'</span>, <span class="string">'__loader__'</span>,</div><div class="line"><span class="string">'__name__'</span>, <span class="string">'__package__'</span>, <span class="string">'__spec__'</span>, <span class="string">'abs'</span>, <span class="string">'all'</span>, <span class="string">'any'</span>, <span class="string">'ascii'</span>, <span class="string">'bin'</span>, <span class="string">'bool'</span>, <span class="string">'bytearray'</span>,</div><div class="line"><span class="string">'bytes'</span>, <span class="string">'callable'</span>, <span class="string">'chr'</span>, <span class="string">'classmethod'</span>, <span class="string">'compile'</span>, <span class="string">'complex'</span>, <span class="string">'copyright'</span>, <span class="string">'credits'</span>, </div><div class="line"><span class="string">'delattr'</span>, <span class="string">'dict'</span>, <span class="string">'dir'</span>, <span class="string">'divmod'</span>, <span class="string">'enumerate'</span>, <span class="string">'eval'</span>, <span class="string">'exec'</span>, <span class="string">'exit'</span>, <span class="string">'filter'</span>, <span class="string">'float'</span>, </div><div class="line"><span class="string">'format'</span>, <span class="string">'frozenset'</span>, <span class="string">'getattr'</span>, <span class="string">'globals'</span>, <span class="string">'hasattr'</span>, <span class="string">'hash'</span>, <span class="string">'help'</span>, <span class="string">'hex'</span>, <span class="string">'id'</span>, <span class="string">'input'</span>,</div><div class="line"><span class="string">'int'</span>, <span class="string">'isinstance'</span>, <span class="string">'issubclass'</span>, <span class="string">'iter'</span>, <span class="string">'len'</span>, <span class="string">'license'</span>, <span class="string">'list'</span>, <span class="string">'locals'</span>, <span class="string">'map'</span>, <span class="string">'max'</span>, </div><div class="line"><span class="string">'memoryview'</span>, <span class="string">'min'</span>, <span class="string">'next'</span>, <span class="string">'object'</span>, <span class="string">'oct'</span>, <span class="string">'open'</span>, <span class="string">'ord'</span>, <span class="string">'pow'</span>, <span class="string">'print'</span>, <span class="string">'property'</span>, </div><div class="line"><span class="string">'quit'</span>, <span class="string">'range'</span>, <span class="string">'repr'</span>, <span class="string">'reversed'</span>, <span class="string">'round'</span>, <span class="string">'set'</span>, <span class="string">'setattr'</span>, <span class="string">'slice'</span>, <span class="string">'sorted'</span>, <span class="string">'staticmethod'</span>,</div><div class="line"><span class="string">'str'</span>, <span class="string">'sum'</span>, <span class="string">'super'</span>, <span class="string">'tuple'</span>, <span class="string">'type'</span>, <span class="string">'vars'</span>, <span class="string">'zip'</span>]</div></pre></td></tr></table></figure></p>
<p>　　可以使用<code>help()</code>或<code>print()</code>來获得函数的文档说明：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(len.__doc__)</div><div class="line">len(module, object)</div><div class="line"></div><div class="line">Return the number of items of a sequence <span class="keyword">or</span> mapping.</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>help(len)</div><div class="line">Help on built-<span class="keyword">in</span> function len <span class="keyword">in</span> module builtins:</div><div class="line"></div><div class="line">len(...)</div><div class="line">    len(module, object)</div><div class="line">    </div><div class="line">    Return the number of items of a sequence <span class="keyword">or</span> mapping.</div></pre></td></tr></table></figure></p>
<p>　　<code>globals()</code>和<code>locals()</code>函数通常用来作为调试用，此外，在调用<code>dir()</code>函数时，若没有指定参数，则会返回一个有序的<code>list</code>对象，包含局部名字空间中的名字：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="number">10</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = x + <span class="number">10</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>dir()</div><div class="line">[<span class="string">'__builtins__'</span>, <span class="string">'__doc__'</span>, <span class="string">'__loader__'</span>, <span class="string">'__name__'</span>, <span class="string">'__package__'</span>, <span class="string">'__spec__'</span>, <span class="string">'x'</span>, <span class="string">'y'</span>]</div></pre></td></tr></table></figure></p>
<h1 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h1><p>　　创建模块<code>wo</code>，其中包含<code>words_occur()</code>函数。可以使用<code>try-except-else-finally</code>复合语句来捕获和处理异常，未捕获的异常将会导致程序提前终止：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="string">"""wo module. Contains function: words_occur()"""</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">EmptyFileError</span><span class="params">(Exception)</span>:</span>        <span class="comment"># 自定义的异常类</span></div><div class="line">    <span class="keyword">pass</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">words_occur</span><span class="params">()</span>:</span></div><div class="line">    <span class="string">"""words_occur() - count the occurrences of words in a file."""</span></div><div class="line">    file_name = input(<span class="string">"Enter the name of the file: "</span>)</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        f = open(file_name, <span class="string">"r"</span>)</div><div class="line">        contents = f.read()             <span class="comment"># read()返回字符串，包含文件中的所有字符</span></div><div class="line">        <span class="keyword">if</span> contents == <span class="string">""</span>:</div><div class="line">            <span class="keyword">raise</span> EmptyFileError(<span class="string">"%s: is empty."</span> % file_name)          <span class="comment"># 抛出异常</span></div><div class="line">        word_list = contents.split()</div><div class="line">        f.close()</div><div class="line">    <span class="keyword">except</span> IOError <span class="keyword">as</span> error:            <span class="comment"># 捕获IO异常</span></div><div class="line">        print(<span class="string">"%s: could not be open: %s."</span> % (file_name, error.strerror))</div><div class="line">    <span class="keyword">except</span> EmptyFileError <span class="keyword">as</span> error:     </div><div class="line">        print(error)</div><div class="line">    <span class="keyword">else</span>:                               <span class="comment"># 若没有发生异常，则执行else语句块</span></div><div class="line">        occurs_dict = &#123;&#125;</div><div class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> word_list:</div><div class="line">            occurs_dict[word] = occurs_dict.get(word, <span class="number">0</span>) + <span class="number">1</span></div><div class="line">        print(<span class="string">"File %s has %d words (%d are unique)"</span> \</div><div class="line">                % (file_name, len(word_list), len(occurs_dict)))</div><div class="line">        print(occurs_dict)</div><div class="line">    <span class="keyword">finally</span>:                           <span class="comment"># 不管异常是否出现，finally语句块始终会执行</span></div><div class="line">        print(<span class="string">"Process %s done!"</span> % file_name)</div><div class="line">        </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:             <span class="comment"># 在命令行执行 python wo.py时，则会执行words_occur()函数。 </span></div><div class="line">    words_occur()</div></pre></td></tr></table></figure></p>
<p>　　注意，在异常处理中，也可以不包含<code>else</code>语句块和<code>finally</code>语句块。</p>
<h1 id="面向对象编程"><a href="#面向对象编程" class="headerlink" title="面向对象编程"></a>面向对象编程</h1><p>　　创建自定义的模块<code>sh</code>，将其命名为<code>sh.py</code>，其中定义了<code>Shape</code>类，<code>Rectangle</code>类继承了<code>Shape</code>类，同时，<code>Square</code>类继承了<code>Rectangle</code>类。<code>__init()__</code>代表构造方法，在派生类的构造方法中，需要显式地调用其基类的构造方法来初始化类的数据成员：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="string">"""sh module. Contains classes Shape, Rectangle and Square"""</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Shape</span>:</span></div><div class="line">    <span class="string">"""Shape class: has method move"""</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, x, y)</span>:</span></div><div class="line">        self.x = x</div><div class="line">        self.y = y</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">move</span><span class="params">(self, deltaX, deltaY)</span>:</span></div><div class="line">        self.x += deltaX</div><div class="line">        self.y += deltaY</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span><span class="params">(Shape)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, width, height, x, y)</span>:</span></div><div class="line">        Shape.__init__(self, x, y)</div><div class="line">        self.width, self.height = width, height</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">area</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="string">"""Rectangle area method: reutrns the area of the rectangle."""</span></div><div class="line">        <span class="keyword">return</span> self.width * self.height</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">draw</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="string">"""Rectangle draw method: draw the rectangle."""</span></div><div class="line">        print(<span class="string">"draw a rectangle with width %d and height %d at (%d, %d)"</span> % \</div><div class="line">              (self.width, self.height, self.x, self.y))</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">"Rectangle of width %d and height %d at(%d, %d)"</span> \</div><div class="line">               % (self.width, self.height, self.x, self.y)</div><div class="line">    </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Square</span><span class="params">(Rectangle)</span>:</span></div><div class="line">    <span class="string">"""Square class: inherits from Shape"""</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, side = <span class="number">1</span>, x = <span class="number">0</span>, y = <span class="number">0</span>)</span>:</span></div><div class="line">        Rectangle.__init__(self, side, side, x, y)</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">area</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="string">"""Square area method: returns the area of the square."""</span></div><div class="line">        <span class="keyword">return</span> Rectangle.area(self)</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">draw</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="string">"""Square draw method: draw the Square."""</span></div><div class="line">        print(<span class="string">"draw a square with side %d at (%d, %d)"</span> % \</div><div class="line">              (self.width, self.x, self.y))</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> <span class="string">"Square of side %d at coordinates (%d, %d)"</span> \</div><div class="line">               % (self.width, self.x, self.y)</div></pre></td></tr></table></figure></p>
<p>　　由于<code>Rectangle</code>类继承了<code>Shape</code>类，因此，<code>Rectangle</code>类拥有从<code>Shape</code>继承而来的<code>move()</code>方法。派生也可以对基类中的方法进行覆写，例如，在<code>Square</code>类中重新定义了<code>draw()</code>和<code>area()</code>方法。<br>```python</p>
<blockquote>
<blockquote>
<blockquote>
<p>import sh<br>rec = sh.Rectangle(20, 10, 5, 5)<br>print(rec)<br>Rectangle of width 20 and height 10 at(5, 5)<br>rec.area()<br>200<br>rec.move(10, 20)<br>print(rec)<br>Rectangle of width 20 and height 10 at(15, 25)<br>square = sh.Square(10, 8, 8)<br>square.area()<br>100<br>print(square)<br>Square of side 10 at coordinates (8, 8)<br>square.draw()<br>draw a square with side 10 at (8, 8)<br>```　　</p>
<h1 id="编程风格"><a href="#编程风格" class="headerlink" title="编程风格"></a>编程风格</h1><p>　　<code>Python</code>的编程风格：</p>
<ul>
<li><code>module/package</code>的命名要求尽量短，使用小写字符，例如<code>imp</code>和<code>sys</code>，仅有在需要时才使用下划线。</li>
<li>函数命名使用小写字符，为增加可读性可使用下划线，例如<code>foo()</code>和<code>my_func()</code>。</li>
<li>变量命名使用小写字符，为增加可读性可使用下划线，例如<code>my_var</code>。</li>
<li>类的命名要求每个单词的首字母大写，不使用下划线，例如<code>MyClass</code>。</li>
<li>常量命名要求全部大写并使用下划线，例如<code>PI</code>和<code>SPEED</code>。</li>
<li>缩进使用<code>4</code>个空格键，不使用<code>tab</code>键。</li>
<li>在比较时，不显式将变量与<code>True</code>或<code>False</code>进行比较，例如，可以使用<code>if my_var:</code>和<code>if not my_var</code>。<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><a href="http://www.amazon.com/Quick-Python-Book-Second/dp/193518220X/ref=sr_1_1?ie=UTF8&amp;qid=1417962604&amp;sr=8-1&amp;keywords=the+quick+python" target="_blank" rel="external">The Quick Python Book Second Edition</a></li>
</ul>
</blockquote>
</blockquote>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/11/30/htdp1/" itemprop="url">
                  How to Design Programs（一）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-11-30T14:58:27+08:00" content="2014-11-30">
              2014-11-30
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/编程方法/" itemprop="url" rel="index">
                    <span itemprop="name">编程方法</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>　这是<a href="http://www.ccs.neu.edu/home/matthias/HtDP2e/Draft/index.html" target="_blank" rel="external">How to Design Programs</a>的学习笔记，在编写程序之前，首先需要安装<a href="http://racket-lang.org/download/" target="_blank" rel="external">DrRocket</a>编程环境，在<code>Ubuntu</code>可以使用以下命令来安装:</p>
<pre><code>sudo apt-get install racket
</code></pre><h2 id="模拟飞碟着陆"><a href="#模拟飞碟着陆" class="headerlink" title="模拟飞碟着陆"></a>模拟飞碟着陆</h2><p>　　首先，可以绘制飞碟着陆时的屏幕背景，先定义一些需要用到的常量：</p>
<pre><code>; 导入所需要的包
(require 2htdp/image)
(require 2htdp/universe)
; 窗口的高度和宽度
(define HEIGHT 300)
(define WIDTH 450)
; 飞碟水平位置
(define X (/ WIDTH 2))
; 飞碟
(define UFO (overlay (circle 10 &quot;solid&quot; &quot;green&quot;)
                        (rectangle 40 4 &quot;solid&quot; &quot;green&quot;)))
; 背景
(define BACKGROUND (rectangle WIDTH HEIGHT &quot;solid&quot; &quot;blue&quot;))
; 岩石层
(define ROCK-BED (rectangle WIDTH 10 &quot;solid&quot; &quot;red&quot;))
; 屏幕
(define SCREEN (place-image 
             ROCK-BED (/ WIDTH 2) (- HEIGHT (/ (image-height ROCK-BED) 2))
             (place-image BACKGROUND (/ WIDTH 2) (/ HEIGHT 2) (empty-scene WIDTH HEIGHT))))
</code></pre><p>　　我们可以使用以下语句来绘制飞碟刚开始降落时的场景：</p>
<pre><code>(place-image UFO X 0 SCREEN)
</code></pre><p>　　效果如下：<br><img src="/images/scheme/1.png" alt=""><br>　　    接下来需要模拟飞碟的降落运动，飞碟在位置<code>(X, 0)</code>开始减速，初速度为$v_0$，可以将飞碟的降落过程当作<strong>匀减速的直线运动</strong>，物理公式：  $$ s(t) = v_0 t - \frac{a t^2}{2}(0 &lt; t \leq t1)$$   $$ v(t) = v_0 - at(0 &lt;t&lt; t_1) $$ $$ v(t) = 0(t \ge t_1)$$<br>　　假定飞碟作匀减速运动，速度为<code>0</code>时刚好在岩石层着陆，我们使用$t_1$表示飞碟作减速运动所需要的时间。可以定义常量<code>UFO-CENTER-TO-BOTTOM</code>来表示$s(t_1)$的大小：</p>
<pre><code>; 飞碟着陆时的垂直位置
(define UFO-CENTER-TO-BOTTOM
  (- HEIGHT (/ (image-height UFO ) 2) (image-height ROCK-BED)))
</code></pre><p>  由物理知识可得：$$ 2s(t_1) = v_0 \cdot t_1$$ $$a = \frac{v_0}{t_1}$$<br>　　假定我们使用<code>SPEED</code>来表示初速度$v_0$，使用<code>DESEND-TIME</code>来表示下落时间$t_1$，<code>DECELERATION</code>表示加速度$a$，同时使用<code>distance</code>函数来表示$s(t)$，那么可以这样定义：</p>
<pre><code>; 初速度
(define SPEED 10)
; 下落的时间
(define DESEND-TIME (/ (* UFO-CENTER-TO-BOTTOM 2) SPEED))
; 减速时的加速度
(define DECELERATION (/ SPEED DESEND-TIME))
; 下落的位移公式
(define (distance t)
  (- (* SPEED t) (* 1/2 DECELERATION (sqr t))))
</code></pre><p>　　最后，使用<code>create-ufo-scene</code>来表示飞碟随时间变化的场景，同时使用<code>animate</code>函数来启动绘制动画，那么完整的程序如下：<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">require</span></span> <span class="number">2</span>htdp/image)</div><div class="line">(<span class="name"><span class="builtin-name">require</span></span> <span class="number">2</span>htdp/universe)</div><div class="line"></div><div class="line"><span class="comment">; 窗口的高度和宽度</span></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> HEIGHT <span class="number">300</span>)</div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> WIDTH <span class="number">450</span>)</div><div class="line"><span class="comment">; 飞碟</span></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> UFO (<span class="name">overlay</span> (<span class="name">circle</span> <span class="number">10</span> <span class="string">"solid"</span> <span class="string">"green"</span>)</div><div class="line">                        (<span class="name">rectangle</span> <span class="number">40</span> <span class="number">4</span> <span class="string">"solid"</span> <span class="string">"green"</span>)))</div><div class="line"><span class="comment">; 背景</span></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> BACKGROUND (<span class="name">rectangle</span> WIDTH HEIGHT <span class="string">"solid"</span> <span class="string">"blue"</span>))</div><div class="line"><span class="comment">; 岩石层</span></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> ROCK-BED (<span class="name">rectangle</span> WIDTH <span class="number">10</span> <span class="string">"solid"</span> <span class="string">"red"</span>))</div><div class="line"><span class="comment">; 屏幕</span></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> SCREEN (<span class="name">place-image</span> </div><div class="line">             ROCK-BED (<span class="name"><span class="builtin-name">/</span></span> WIDTH <span class="number">2</span>) (<span class="name"><span class="builtin-name">-</span></span> HEIGHT (<span class="name"><span class="builtin-name">/</span></span> (<span class="name">image-height</span> ROCK-BED) <span class="number">2</span>))</div><div class="line">             (<span class="name">place-image</span> BACKGROUND (<span class="name"><span class="builtin-name">/</span></span> WIDTH <span class="number">2</span>) (<span class="name"><span class="builtin-name">/</span></span> HEIGHT <span class="number">2</span>) (<span class="name">empty-scene</span> WIDTH HEIGHT))))</div><div class="line"><span class="comment">; 飞碟水平位置</span></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> X (<span class="name"><span class="builtin-name">/</span></span> WIDTH <span class="number">2</span>))</div><div class="line"><span class="comment">; 飞碟着陆时的垂直位置</span></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> UFO-CENTER-TO-BOTTOM</div><div class="line">  (<span class="name"><span class="builtin-name">-</span></span> HEIGHT (<span class="name"><span class="builtin-name">/</span></span> (<span class="name">image-height</span> UFO ) <span class="number">2</span>) (<span class="name">image-height</span> ROCK-BED)))</div><div class="line"><span class="comment">; 初速度</span></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> SPEED <span class="number">10</span>)</div><div class="line"><span class="comment">; 下落的时间</span></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> DESEND-TIME (<span class="name"><span class="builtin-name">/</span></span> (<span class="name"><span class="builtin-name">*</span></span> UFO-CENTER-TO-BOTTOM <span class="number">2</span>) SPEED))</div><div class="line"><span class="comment">; 减速时的加速度</span></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> DECELERATION (<span class="name"><span class="builtin-name">/</span></span> SPEED DESEND-TIME))</div><div class="line"></div><div class="line"><span class="comment">; 飞碟下落的画面</span></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">create-ufo-scene</span> t)</div><div class="line">   (<span class="name">place-image</span> UFO X (<span class="name"><span class="builtin-name">cond</span></span> </div><div class="line">                        [(<span class="name"><span class="builtin-name">&lt;=</span></span> t DESEND-TIME) (<span class="name">distance</span> t)]</div><div class="line">                        [(<span class="name"><span class="builtin-name">&gt;</span></span> t DESEND-TIME) UFO-CENTER-TO-BOTTOM])</div><div class="line">                        SCREEN))</div><div class="line"></div><div class="line"><span class="comment">; 下落的位移公式</span></div><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">distance</span> t)</div><div class="line">  (<span class="name"><span class="builtin-name">-</span></span> (<span class="name"><span class="builtin-name">*</span></span> SPEED t) (<span class="name"><span class="builtin-name">*</span></span> <span class="number">1/2</span> DECELERATION (<span class="name">sqr</span> t))))</div><div class="line"></div><div class="line"><span class="comment">; 绘制动画</span></div><div class="line">( animate create-ufo-scene )</div></pre></td></tr></table></figure></p>
<p>　　飞碟匀减速下降：<br><img src="/images/scheme/4.gif" alt=""></p>
<h2 id="定义结构"><a href="#定义结构" class="headerlink" title="定义结构"></a>定义结构</h2><p>　　可以使用以下方式来定义结构：</p>
<pre><code>(define-struct 结构名 [字段1 字段2 ...] )
</code></pre><p>　　例如，定义<code>student</code>结构：</p>
<pre><code>(define-struct student [account name])
</code></pre><p>　　我们可以使用创建一个<code>student</code>实例：</p>
<pre><code>(define me (make-student 1207400063 &quot;senlinzhan&quot;))
</code></pre><p>　　也可以访问<code>student</code>结构中的字段：</p>
<pre><code>&gt; (student-account me)
1207400063
&gt; (student-name me)
&quot;senlinzhan&quot;
</code></pre><p>　　此外，也可以判断一个实例是否是<code>student</code>实例：</p>
<pre><code>&gt; (student? &quot;home&quot;)
false
&gt; (student? me)
true
</code></pre><h2 id="行编辑器"><a href="#行编辑器" class="headerlink" title="行编辑器"></a>行编辑器</h2><p>　　编写一个行编辑器，可以对行内文本进行编辑，在光标指向位置增加文本或删除文本。程序运行效果如下：<br><img src="/images/scheme/editor.png" alt=""><br>　　　　<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div></pre></td><td class="code"><pre><div class="line">(require 2htdp/image)</div><div class="line">(require 2htdp/universe)</div><div class="line"></div><div class="line">; Editor = (make-editor String String)</div><div class="line">; interpretation (make-editor s t) means the text in the editor is</div><div class="line">; (string-append s t) with the cursor displayed between s and t</div><div class="line">(define-struct editor [pre post])</div><div class="line"></div><div class="line">; represent the height of background</div><div class="line">(define BG-HEIGHT 25)</div><div class="line"></div><div class="line">; represent the width of background</div><div class="line">(define BG-WIDTH 400)</div><div class="line"></div><div class="line">; represent the background of editor</div><div class="line">(define BACKGROUND (empty-scene BG-WIDTH BG-HEIGHT))</div><div class="line"></div><div class="line">; represent size of font</div><div class="line">(define FONT-SIZE (* BG-HEIGHT 4/5))</div><div class="line"></div><div class="line">; color of font</div><div class="line">(define FONT-COLOR &quot;black&quot;)</div><div class="line"></div><div class="line">; represent the cursor of editor</div><div class="line">(define CURSOR (rectangle 1 BG-HEIGHT &quot;solid&quot; &quot;red&quot;))</div><div class="line"></div><div class="line">; String -&gt; Number</div><div class="line">; compute the x coordinate of the cursor, s represent the string before cursor </div><div class="line">(define (cursor-x s)</div><div class="line">  (image-width (text s FONT-SIZE FONT-COLOR)))</div><div class="line"></div><div class="line">; y coordinate of the cursor</div><div class="line">(define CURSOR-Y (/ BG-HEIGHT 2))</div><div class="line"></div><div class="line">; Editor -&gt; Image</div><div class="line">; produces a text image from editor&apos;s text</div><div class="line">(check-expect (text-image (make-editor &quot;hello&quot; &quot;world&quot;))</div><div class="line">              (text &quot;helloworld&quot; FONT-SIZE FONT-COLOR))</div><div class="line">(define (text-image ed)</div><div class="line">  (text (string-append (editor-pre ed) (editor-post ed)) FONT-SIZE FONT-COLOR))</div><div class="line"></div><div class="line"></div><div class="line">; Editor -&gt; Image</div><div class="line">; procude an image to represent the contens of editor</div><div class="line">(check-expect (render (make-editor &quot;Hello&quot; &quot;World&quot;)) </div><div class="line">              (place-image CURSOR (cursor-x &quot;Hello&quot;) CURSOR-Y </div><div class="line">                           (overlay/align &quot;left&quot; &quot;center&quot; </div><div class="line">                                          (text-image (make-editor &quot;Hello&quot; &quot;World&quot;)) BACKGROUND)))</div><div class="line">(define (render ed)</div><div class="line">  (place-image CURSOR (cursor-x (editor-pre ed)) CURSOR-Y </div><div class="line">               (overlay/align &quot;left&quot; &quot;center&quot; (text-image ed) BACKGROUND)))</div><div class="line"></div><div class="line">; String -&gt; String</div><div class="line">; extracts the last character from s, if s is empty, return an empty string.</div><div class="line">(define (string-last s)</div><div class="line">  (if (&gt;= (string-length s) 1) (string-ith s (- (string-length s) 1)) &quot;&quot;))</div><div class="line"></div><div class="line">; String -&gt; String</div><div class="line">; extracts the first character from s, if s is empty, return an empty string.</div><div class="line">(define (string-first s)</div><div class="line">  (if (&gt;= (string-length s) 1) (string-ith s 0) &quot;&quot;))</div><div class="line"></div><div class="line">; String -&gt; String</div><div class="line">; remove the last character from s, if s is empty, do nothing.</div><div class="line">(define (string-remove-last s)</div><div class="line">  (if (&gt;= (string-length s) 1) (substring s 0 (- (string-length s) 1)) &quot;&quot;))</div><div class="line"></div><div class="line">; String -&gt; String</div><div class="line">; remove the first character from s, if s is empty, do nothing.</div><div class="line">(check-expect (string-remove-first &quot;hello&quot;) &quot;ello&quot;)</div><div class="line">(define (string-remove-first s)</div><div class="line">  (if (&gt;= (string-length s) 1) (substring s 1) &quot;&quot;))</div><div class="line"></div><div class="line">; Editor -&gt; Number</div><div class="line">; compute the text width of editor</div><div class="line">(define (text-width ed)</div><div class="line">  (image-width (text-image ed)))</div><div class="line"></div><div class="line">; Editor String -&gt; Editor</div><div class="line">; insert string after the cursor of editor, return the update editor</div><div class="line">(check-expect (insert-string-to-editor (make-editor &quot;hello&quot; &quot;world&quot;) &quot;!!&quot;)</div><div class="line">              (make-editor &quot;hello!!&quot; &quot;world&quot;))</div><div class="line">(define (insert-string-to-editor ed s)</div><div class="line">  (make-editor (string-append (editor-pre ed) s) (editor-post ed)))              </div><div class="line"></div><div class="line">; Editor KeyEvent -&gt; Editor</div><div class="line">; Produces new Editor when the key press event happen.</div><div class="line">; If the key event is &quot;left&quot;, move the cursor left one character.</div><div class="line">; If the key event is &quot;right&quot;, move the cursor right one character.</div><div class="line">; If the string of key event is one-character and not &quot;\t&quot; and &quot;\r&quot;,</div><div class="line">; append the string to the end of text before cursor.</div><div class="line">; Ignores other cases.</div><div class="line">(check-expect (edit (make-editor &quot;hello&quot; &quot;world&quot;) &quot;left&quot;) (make-editor &quot;hell&quot; &quot;oworld&quot;))</div><div class="line">(check-expect (edit (make-editor &quot;hello&quot; &quot;world&quot;) &quot;right&quot;) (make-editor &quot;hellow&quot; &quot;orld&quot;))</div><div class="line">(check-expect (edit (make-editor &quot;hello&quot; &quot;world&quot;) &quot;\b&quot;) (make-editor &quot;hell&quot; &quot;world&quot;))</div><div class="line">(check-expect (edit (make-editor &quot;hello&quot; &quot;world&quot;) &quot;a&quot;) (make-editor &quot;helloa&quot; &quot;world&quot;))</div><div class="line">(define (edit ed ke)</div><div class="line">  (cond [(= (string-length ke) 1) </div><div class="line">         (cond </div><div class="line">           [(or (string=? ke &quot;\t&quot;) (string=? ke &quot;\r&quot;)) ed]</div><div class="line">           [(string=? ke &quot;\b&quot;) (make-editor </div><div class="line">                             (string-remove-last (editor-pre ed)) </div><div class="line">                             (editor-post ed))]</div><div class="line">           [else (if (&gt;= (text-width (insert-string-to-editor ed ke)) BG-WIDTH) ed </div><div class="line">                     (insert-string-to-editor ed ke))])]</div><div class="line">        [(string=? ke &quot;left&quot;) </div><div class="line">         (make-editor </div><div class="line">          (string-remove-last (editor-pre ed)) </div><div class="line">          (string-append (string-last (editor-pre ed)) (editor-post ed)))]</div><div class="line">        [(string=? ke &quot;right&quot;) </div><div class="line">         (make-editor</div><div class="line">          (string-append (editor-pre ed) (string-first (editor-post ed)))</div><div class="line">          (string-remove-first (editor-post ed)))]</div><div class="line">        [else ed]))</div><div class="line"></div><div class="line">; launch the editor</div><div class="line">(define (main ed)</div><div class="line">  (big-bang ed</div><div class="line">            (to-draw render)</div><div class="line">            (on-key edit)))</div></pre></td></tr></table></figure></p>
<p>　　使用以下语句来启动程序，将显示一个空白的行编辑器：</p>
<pre><code>(main (make-editor &quot;&quot; &quot;&quot;))
</code></pre><h2 id="移动的变色龙"><a href="#移动的变色龙" class="headerlink" title="移动的变色龙"></a>移动的变色龙</h2><p>　　这是变色龙的图案：<img src="/images/scheme/cham.png" alt="">。编写一个程序，模拟变色龙的移动：</p>
<pre><code>(require 2htdp/image)
(require 2htdp/universe)
</code></pre><p><img src="/images/scheme/cham1.png" alt=""></p>
<pre><code>(define BG-WIDTH 500)
(define BG-HEIGHT 200)
(define MOVE-STEP 3)
(define CHAM-Y (/ BG-HEIGHT 2))
(define BACKGROUND
  (beside (empty-scene (/ BG-WIDTH 3) BG-HEIGHT &quot;green&quot;)
          (empty-scene (/ BG-WIDTH 3) BG-HEIGHT &quot;yellow&quot;)
          (empty-scene (/ BG-WIDTH 3) BG-HEIGHT &quot;red&quot;)))

(define (cham-center-x state)
  (+ state (/ (image-width CHAM) 2)))

(define (render state)
  (place-image CHAM (cham-center-x state) CHAM-Y BACKGROUND))

(define (move state)
  (if (&gt;= (+ state MOVE-STEP) (image-width BACKGROUND)) 0 (+ state MOVE-STEP)))
(define (main state)
   (big-bang state
             [on-tick move]
             [to-draw render]))
</code></pre><p>程序的运行情况：<br><img src="/images/scheme/dd1.png" width="400" height="160"> <img src="/images/scheme/dd2.png" width="400" height="160"></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="http://www.ccs.neu.edu/home/matthias/HtDP2e/Draft/index.html" target="_blank" rel="external">How to Design Programs, Second Edition</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/11/20/归并排序/" itemprop="url">
                  排序算法（一）-- 归并排序
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-11-20T19:23:52+08:00" content="2014-11-20">
              2014-11-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/算法分析/" itemprop="url" rel="index">
                    <span itemprop="name">算法分析</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>　　归并排序的处理过程：</p>
<ul>
<li>将数组等分成两个子数组，分别递归地对这两个子数组执行归并排序，因此，这两个子数组中的元素都是有序的。</li>
<li>对这两个子数组执行合并操作，从而得到一个数组，这个数组中的元素就是有序的。</li>
</ul>
<p>　　对<strong>任意的数组</strong>执行归并排序，所需的时间复杂度是$O(N\log N)$，而空间复杂度则是$O(N)$。显然，归并排序是高效的，但却需要额外消耗较多的内存。另外，归并排序是<code>stable</code>的排序算法，而快速排序和堆排序则不是，因此，当数组的元素包含相同的<code>key</code>时，对于这些含有相同<code>key</code>的元素，归并排序并不会改变这些元素之间的次序。</p>
<h2 id="自顶而下归并排序"><a href="#自顶而下归并排序" class="headerlink" title="自顶而下归并排序"></a>自顶而下归并排序</h2><p>　　首先，我们可以考虑对两个有序的子数组执行合并操作，假定需要将两个子数组<code>left</code>和<code>right</code>合并到数组<code>des</code>中，<code>leftSize</code>和<code>rightSize</code>分别代表这两个子数组的大小，那么可以这样表示合并操作：</p>
<ul>
<li>首先，使用下标<code>i</code>和<code>j</code>分别记录两个子数组中的第一个元素。</li>
<li>将这两个元素的较小者移动到<code>des</code>的末尾，并相应地执行<code>i++</code>或<code>j++</code>。</li>
<li>不断重复上一个操作，直到其中一个子数组为空。</li>
<li>将不为空的另一子数组中的元素按顺序移动到<code>des</code>的末尾。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Comp&gt;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">( T des[], T left[], <span class="keyword">unsigned</span> leftSize, T right[], <span class="keyword">unsigned</span> rightSize, Comp comp )</span> </span>&#123;</div><div class="line">    <span class="keyword">auto</span> size = leftSize + rightSize;</div><div class="line">    <span class="keyword">for</span>( <span class="keyword">unsigned</span> i = <span class="number">0</span>, j = <span class="number">0</span>, k = <span class="number">0</span>; k &lt; size; ++k ) &#123;</div><div class="line">        <span class="keyword">if</span>( i == leftSize ) &#123;</div><div class="line">            des[k] = <span class="built_in">std</span>::move( right[j++] );</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>( j == rightSize ) &#123;</div><div class="line">            des[k] = <span class="built_in">std</span>::move( left[i++] );</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>( comp( right[j], left[i] ) ) &#123;</div><div class="line">            des[k] = <span class="built_in">std</span>::move( right[j++] );</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            des[k] = <span class="built_in">std</span>::move( left[i++] );</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>　　实际上，我们可以通过判断<code>merge()</code>来判断归并排序是否为<code>stable</code>的排序算法，很显然，使用<code>merge()</code>来合并具有相同<code>key</code>的元素，这些元素之间的次序并不会改变，因此，归并排序是<code>stable</code>的。<br>　　但注意，要是我们将<code>merge()</code>的第<code>9</code>到第<code>13</code>行改成以下内容：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>( comp( left[i], right[j] ) ) &#123;</div><div class="line">    des[k] = <span class="built_in">std</span>::move( left[i++] );</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    des[k] = <span class="built_in">std</span>::move( right[j++] );</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>　　那么，此时归并排序算法就<strong>不是</strong><code>stable</code>的。</p>
<p>　　自顶而下归并排序的执行过程：</p>
<ul>
<li>首先创建两个子数组，将原来数组中的元素移动到两个子数组中。</li>
<li>递归地对这两个子数组进行排序。</li>
<li>对两个有序的子数组执行合并操作。<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Comp = <span class="built_in">std</span>::less&lt;T&gt;&gt;</div><div class="line"><span class="keyword">void</span> merge_sort( T arr[], <span class="keyword">unsigned</span> lo, <span class="keyword">unsigned</span> hi, Comp comp = Comp&#123;&#125; ) &#123;</div><div class="line">    <span class="keyword">if</span>( hi &lt;= lo ) &#123; <span class="keyword">return</span>; &#125;                            <span class="comment">// 若元素数目小于 2，则返回</span></div><div class="line"></div><div class="line">    <span class="keyword">auto</span> mid = lo + (hi - lo) / <span class="number">2</span>;</div><div class="line">    <span class="keyword">auto</span> left = <span class="keyword">new</span> T[mid - lo + <span class="number">1</span>];                      <span class="comment">// 子数组 left</span></div><div class="line">    <span class="keyword">auto</span> right = <span class="keyword">new</span> T[hi - mid];                         <span class="comment">// 子数组 right</span></div><div class="line">    <span class="keyword">for</span>( <span class="keyword">unsigned</span> cnt = <span class="number">0</span>, i = lo; i &lt;= mid; ++i ) &#123;</div><div class="line">        left[cnt++] = <span class="built_in">std</span>::move( arr[i] );</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>( <span class="keyword">unsigned</span> cnt = <span class="number">0</span>, i = mid + <span class="number">1</span>; i &lt;= hi; ++i ) &#123;</div><div class="line">        right[cnt++] = <span class="built_in">std</span>::move( arr[i] );</div><div class="line">    &#125;</div><div class="line">    merge_sort( left, <span class="number">0</span>, mid - lo, comp );</div><div class="line">    merge_sort( right, <span class="number">0</span>, hi - mid <span class="number">-1</span>, comp );</div><div class="line">    merge( arr, left, mid - lo + <span class="number">1</span>, right, hi - mid, comp );</div><div class="line">    <span class="keyword">delete</span>[] left;</div><div class="line">    <span class="keyword">delete</span>[] right;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="抽象原位归并"><a href="#抽象原位归并" class="headerlink" title="抽象原位归并"></a>抽象原位归并</h2><p>　　如前面所示，每次调用<code>merge_sort()</code>时，都需要动态创建两个自数组，并且在<code>merge_sort()</code>的末尾需要将这两个子数组销毁。<br>　　我们可以对算法进行改进，其实，要是一开始就动态创建一个数组，并且将这个动态数组传递给<code>merge_sort()</code>，那么在整个算法的执行过程中，这个动态数组就能作为数组元素挪动的缓冲区。<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Comp = <span class="built_in">std</span>::less&lt;T&gt;&gt;</div><div class="line"><span class="keyword">void</span> merge_sort( T arr[], <span class="keyword">unsigned</span> lo, <span class="keyword">unsigned</span> hi, Comp comp = Comp&#123;&#125; ) &#123;</div><div class="line">    <span class="keyword">if</span>( hi &lt;= lo ) &#123;  <span class="keyword">return</span>;  &#125;</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> buffer = <span class="keyword">new</span> T[hi - lo + <span class="number">1</span>];              <span class="comment">// 创建动态数组用作缓冲区</span></div><div class="line">    merge_sort( arr, lo, hi, buffer, comp );</div><div class="line">    <span class="keyword">delete</span>[] buffer;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Comp&gt;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge_sort</span><span class="params">( T arr[], <span class="keyword">unsigned</span> lo, <span class="keyword">unsigned</span> hi, T buffer[], Comp comp )</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>( hi &lt;= lo ) &#123;  <span class="keyword">return</span>;  &#125;</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> mid = lo + (hi - lo) / <span class="number">2</span>;                               </div><div class="line">    merge_sort( arr, lo, mid, buffer, comp );</div><div class="line">    merge_sort( arr, mid + <span class="number">1</span>, hi, buffer, comp );</div><div class="line">    merge( arr, lo, mid, hi, buffer, comp );</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>　　此外，还需要对<code>merge()</code>进行改进，首先，我们将需要合并的所有元素都移动到缓冲区中，其后，再根据元素的大小，将元素从缓冲区中移动到原来的数组中。<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 合并操作：stable</span></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Comp&gt;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">( T arr[], <span class="keyword">unsigned</span> lo, <span class="keyword">unsigned</span> mid, <span class="keyword">unsigned</span> hi, T buffer[], Comp comp )</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span>( <span class="keyword">auto</span> i = lo; i &lt;= hi; ++i ) &#123;</div><div class="line">        buffer[i] = <span class="built_in">std</span>::move( arr[i] );</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>( <span class="keyword">unsigned</span> i = lo, j = mid + <span class="number">1</span>, k = lo; k &lt;= hi; ++k ) &#123;</div><div class="line">        <span class="keyword">if</span>( i &gt; mid ) &#123;</div><div class="line">            arr[k] = <span class="built_in">std</span>::move( buffer[j++] );</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>( j &gt; hi ) &#123;</div><div class="line">            arr[k] = <span class="built_in">std</span>::move( buffer[i++] );</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>( comp( buffer[j], buffer[i] ) ) &#123;</div><div class="line">            arr[k] = <span class="built_in">std</span>::move( buffer[j++] );</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            arr[k] = <span class="built_in">std</span>::move( buffer[i++] );</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>　　可以看到，假定数组的元素数目是<code>N</code>，那么改进之后的归并排序中，仅需要在一开始就动态创建一个大小为<code>N</code>的数组用作缓冲区就可以了。此外，这个<code>merge()</code>操作也是<code>stable</code>的。<br>　　注意到，在<code>merge()</code>操作中，需要执行<code>i &gt; mid</code>和<code>j &gt; hi</code>的判断，实际上，要是<code>buffer[lo]</code>到<code>buffer[mid]</code>之间的元素是按升序排列的，而<code>buffer[mid + 1]</code>到<code>`buffer[hi]</code>之间的元素是按降序排列的，那么我们就不需要判断<code>i &gt; mid</code>和<code>j &gt; hi</code>了：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 合并操作：非stable</span></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Comp&gt;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">( T arr[], <span class="keyword">unsigned</span> lo, <span class="keyword">unsigned</span> mid, <span class="keyword">unsigned</span> hi, T buffer[],Comp comp)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> i, j;</div><div class="line">    <span class="keyword">for</span>( i = mid + <span class="number">1</span>; i &gt; lo; --i ) &#123;</div><div class="line">        buffer[i - <span class="number">1</span>] = <span class="built_in">std</span>::move( arr[i - <span class="number">1</span>] );</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>( j = mid; j &lt; hi; ++j ) &#123;</div><div class="line">        buffer[hi + mid - j] = <span class="built_in">std</span>::move( arr[j + <span class="number">1</span>] );</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>( <span class="keyword">int</span> index = lo; index &lt;= hi; ++index ) &#123;</div><div class="line">        <span class="keyword">if</span>( comp( buffer[j], buffer[i] ) ) &#123;</div><div class="line">            arr[index] = <span class="built_in">std</span>::move( buffer[j--] );</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            arr[index] = <span class="built_in">std</span>::move( buffer[i++] );</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>　　尽管在循环中省去了不必要的判断，但改进后的<code>merge()</code>操作<strong>不是</strong><code>stable</code>的。</p>
<h2 id="自底而上归并排序"><a href="#自底而上归并排序" class="headerlink" title="自底而上归并排序"></a>自底而上归并排序</h2><p>　　自底而上的归并排序是一种非递归的排序算法，在这种算法中，我们首先对小的数组执行<code>merge()</code>从而得到大的有序数组，同样，再对大的数组执行<code>merge()</code>操作得到更大的有序数组。例如，假定我们需要对以下数组进行排序：<br><img src="/images/data-structure/pp1.png" alt=""><br>　　那么需要从左到右处理数组，按照<code>1-by-1</code>的方式执行合并操作：<br><img src="/images/data-structure/pp2.png" alt=""><br>　　接着，同样需要从左到右处理数组，执行一次<code>2-by-2</code>和一次<code>2-by-1</code>的合并操作：<br><img src="/images/data-structure/pp3.png" alt=""><br>　　最后，我们执行一次<code>4-by-3</code>的合并操作就得到有序的数组了：<br><img src="/images/data-structure/pp4.png" alt=""><br>　　这种方式实际上称为<code>combine-and-conquer</code>策略，即首先解决小的问题，接着，将这些小的问题合并成为大的问题，再解决这些大的问题。<br>　　非递归的归并排序执行的过程：</p>
<ul>
<li>首先，将每个元素当成是<code>size</code>为<code>1</code>的子数组。从左到右对每两个子数组执行合并操作。</li>
<li>接着，将每两个元素当成是<code>size</code>为<code>2</code>的子数组，从左到右对每两个子数组执行合并操作。</li>
<li>不断重复这个过程，直到数组中的元素都是有序的。<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Comp = <span class="built_in">std</span>::less&lt;T&gt;&gt;</div><div class="line"><span class="keyword">void</span> merge_sort( T arr[], <span class="keyword">unsigned</span> lo, <span class="keyword">unsigned</span> hi, Comp comp = Comp&#123;&#125; ) &#123;</div><div class="line">    <span class="keyword">auto</span> buffer = <span class="keyword">new</span> T[hi - lo + <span class="number">1</span>];</div><div class="line">    <span class="keyword">for</span>( <span class="keyword">unsigned</span> size = <span class="number">1</span>; size &lt;= hi - lo; size *= <span class="number">2</span> ) &#123;</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">unsigned</span> i = lo; i &lt;= hi - size; i += size * <span class="number">2</span> ) &#123;</div><div class="line">            merge( arr, i, i + size - <span class="number">1</span>, <span class="built_in">std</span>::min( i + size * <span class="number">2</span> - <span class="number">1</span>, hi ), buffer, comp );</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">delete</span>[] buffer;</div><div class="line">&#125;</div><div class="line"><span class="comment">// merge()函数保持不变</span></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Comp&gt;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">( T arr[], <span class="keyword">unsigned</span> lo, <span class="keyword">unsigned</span> mid, <span class="keyword">unsigned</span> hi, T buffer[], Comp comp )</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span>( <span class="keyword">auto</span> i = lo; i &lt;= hi; ++i ) &#123;</div><div class="line">        buffer[i] = <span class="built_in">std</span>::move( arr[i] );</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>( <span class="keyword">unsigned</span> i = lo, j = mid + <span class="number">1</span>, k = lo; k &lt;= hi; ++k ) &#123;</div><div class="line">        <span class="keyword">if</span>( i &gt; mid ) &#123;</div><div class="line">            arr[k] = <span class="built_in">std</span>::move( buffer[j++] );</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>( j &gt; hi ) &#123;</div><div class="line">            arr[k] = <span class="built_in">std</span>::move( buffer[i++] );</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>( comp( buffer[j], buffer[i] ) ) &#123;</div><div class="line">            arr[k] = <span class="built_in">std</span>::move( buffer[j++] );</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            arr[k] = <span class="built_in">std</span>::move( buffer[i++] );</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>　　非递归版本的归并排序与递归版本的一样，对于任意的数组进行排序，算法复杂度为$O(N\log N)$，空间复杂度为$O(N)$。同时应该注意到，无论是递归版本或是非递归版本，只要保证<code>merge()</code>操作是<code>stable</code>的，那么归并排序就是<code>stable</code>的。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="http://www.amazon.com/Algorithms-Parts-1-4-Fundamentals-Structure/dp/0201350882" target="_blank" rel="external">Algorithms in C++ 3rd Edition by Robert Sedgewick</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/11/12/java8/" itemprop="url">
                  Java 高级特性（二）-- Java 8 新特性
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-11-12T15:30:18+08:00" content="2014-11-12">
              2014-11-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/编程语言/" itemprop="url" rel="index">
                    <span itemprop="name">编程语言</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="接口中的默认方法"><a href="#接口中的默认方法" class="headerlink" title="接口中的默认方法"></a>接口中的默认方法</h2><p>　　在接口中允许定义带有具体实现的默认<code>(default)</code>方法，例如:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Formula</span> </span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">double</span> <span class="title">calculate</span><span class="params">( <span class="keyword">int</span> a )</span></span>;</div><div class="line">    <span class="function"><span class="keyword">default</span> <span class="keyword">double</span> <span class="title">sqrt</span><span class="params">( <span class="keyword">int</span> a )</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> Math.sqrt( a );</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>　　由于已经实现了接口中的默认方法,因此,在那些实现接口的类中,仅需给出抽象方法<code>calculate()</code>的实现,例如:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Formula formula = <span class="keyword">new</span> Formula() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">calculate</span><span class="params">( <span class="keyword">int</span> value )</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> sqrt( value );</div><div class="line">    &#125; </div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<h2 id="lambda-表达式"><a href="#lambda-表达式" class="headerlink" title="lambda 表达式"></a>lambda 表达式</h2><p>　　对字符串进行排序的一种方式:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">List&lt;String&gt; name = Arrays.asList( ”senlin”, ”zhan” );</div><div class="line">Collections.sort( name, <span class="keyword">new</span> Comparator&lt;String&gt;() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">( String a, String b )</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> a.compareTo( b );</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>　　使用<code>lambda</code>表达式,简化代码:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Collections.sort( name, ( String a, String b ) −&gt; &#123;</div><div class="line">    <span class="keyword">return</span> a.compareTo( b );</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>　　此外,也可以省略<code>lambda</code>表达式的参数类型,例如:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Collections.sort( name, ( a, b ) −&gt; a.compareTo( b ) );</div></pre></td></tr></table></figure></p>
<h2 id="函数式接口"><a href="#函数式接口" class="headerlink" title="函数式接口"></a>函数式接口</h2><p>　　<code>lambda</code>表达式的类型即是函数式接口,接口中仅声明一个抽象方法，<code>lambda</code>表达式会与这个抽象方法相匹配,由于默认方法并不是抽象的,因此,接口中可以具备多个默认方法。<br>　　为确保函数式接口满足要求,可以在接口声明之前放置<code>@FunctionalInterface</code>注解,因此,当接口中多个一个抽象方法时,编译将会报错。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@FunctionalInterface</span></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Converter</span>&lt; <span class="title">F</span>, <span class="title">T</span> &gt;</span></div><div class="line">&#123;</div><div class="line">    convert( F from );</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>　　创建<code>lambda</code>表达式:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Converter&lt;String, Integer&gt; converter = ( from ) −&gt; Integer.valueOf( from );</div><div class="line"><span class="keyword">int</span> converted = converter.convert( ”<span class="number">12345</span>” );</div></pre></td></tr></table></figure></p>
<h2 id="方法引用"><a href="#方法引用" class="headerlink" title="方法引用"></a>方法引用</h2><p>　　使用方法引用,创建<code>lambda</code>表达式的另一种等价方式:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Converter&lt;String, Integer&gt; converter = Integer::valueof;</div></pre></td></tr></table></figure></p>
<p>　　方法引用能作用于静态方法,此外,也能作用于非静态方法,例如:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Something</span></span></div><div class="line">&#123;</div><div class="line">    <span class="function">String <span class="title">startsWith</span><span class="params">( String s )</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> String.valueOf( s.charAt( <span class="number">0</span> ) );</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// ...</span></div><div class="line">Something something = <span class="keyword">new</span> Something();</div><div class="line">Converter&lt;String, String&gt; converter = something::startsWith;</div><div class="line">String converted = converter.convert( ”Java” );</div></pre></td></tr></table></figure></p>
<p>　　另外,也可以对构造方法使用方法引用,例如:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></div><div class="line">&#123;</div><div class="line">    String firstName;</div><div class="line">    String lastName;</div><div class="line">    Person() &#123; &#125;</div><div class="line">    Person( String firstName, String lastName )</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">this</span>.firstName = firstName;</div><div class="line">        <span class="keyword">this</span>.lastName = lastName;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">PersonFactory</span>&lt; <span class="title">T</span> <span class="keyword">extends</span> <span class="title">Person</span> &gt;</span></div><div class="line">&#123;</div><div class="line">    <span class="function">T <span class="title">create</span><span class="params">( String firstName, String lastName )</span></span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ...</span></div><div class="line">PersonFactory&lt;Person&gt; factory = Person::<span class="keyword">new</span>;</div><div class="line">Person me = factory.create( ”senlin”, ”zhan” );</div></pre></td></tr></table></figure></p>
<p>　　编译器会根据签名选择正确的构造方法。</p>
<h2 id="在-lambda-访问外部变量"><a href="#在-lambda-访问外部变量" class="headerlink" title="在 lambda 访问外部变量"></a>在 lambda 访问外部变量</h2><p>　　<code>lambda</code>表达式中可以访问外部域的<code>final</code>局部变量、实例的字段和静态变量。</p>
<h3 id="访问局部变量"><a href="#访问局部变量" class="headerlink" title="访问局部变量"></a>访问局部变量</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">final</span> <span class="keyword">int</span> num = <span class="number">10</span>;</div><div class="line">Converter&lt;Integer, String&gt; stringConverter = ( from ) −&gt; String.valueOf( from + num );</div><div class="line">stringConverter.convert( <span class="number">100</span> );           <span class="comment">// return ”110”</span></div></pre></td></tr></table></figure>
<p>　　这里，可以省略<code>final</code>，但仍需将<code>num</code>当作<code>final</code>变量来使用，即在<code>lambda</code>表达式中不能修改变量<code>num</code>，此外，在其它位置亦不能修改<code>num</code>。</p>
<h3 id="访问字段与静态变量"><a href="#访问字段与静态变量" class="headerlink" title="访问字段与静态变量"></a>访问字段与静态变量</h3><p>　　与访问局部变量不同,在<code>lambda</code>表达式中可以对实例的字段及静态变量执行读写操作,例如:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">LambdaTest</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">int</span> outerStaticNum;</div><div class="line">    <span class="keyword">int</span> outerNum;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">testScpoes</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        Converter&lt;Integer, String&gt; stringConverter1 = ( from ) −&gt; &#123;</div><div class="line">            outerNum = <span class="number">100</span>;</div><div class="line">            <span class="keyword">return</span> String.valueOf( from );</div><div class="line">        &#125;;</div><div class="line">        Converter&lt;Integer, String&gt; stringConverter2 = ( from ) −&gt; &#123;</div><div class="line">            outerStaticNum = <span class="number">100</span>;</div><div class="line">            <span class="keyword">return</span> String.valueOf( from );</div><div class="line">        &#125;;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="访问函数式接口中的默认方法"><a href="#访问函数式接口中的默认方法" class="headerlink" title="访问函数式接口中的默认方法"></a>访问函数式接口中的默认方法</h3><p>　　注意,在<code>lambda</code>表达式中不能访问函数式接口中的默认方法,例如,以下语句将无法通过编译:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Formula formula = ( a ) −&gt; sqrt( a );        <span class="comment">// ERROR</span></div></pre></td></tr></table></figure></p>
<h2 id="内置函数式接口"><a href="#内置函数式接口" class="headerlink" title="内置函数式接口"></a>内置函数式接口</h2><p>　　<code>Comparator</code>和<code>Runnable</code>函数式接口均通过使用<code>@FunctionalInterface</code>注解来支持<code>lambda</code>表达式,除此之外,还有以下的函数式接口:</p>
<h3 id="Predicate接口"><a href="#Predicate接口" class="headerlink" title="Predicate接口"></a>Predicate接口</h3><p>　　<code>Predicate</code>接口中的<code>test()</code>方法接受一个参数,并返回<code>boolean</code>类型的值,此外,还包含了一些默认方法用于支持复杂的逻辑运算:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Predicate&lt;String&gt; predicate = ( str ) −&gt; str.length() &gt; <span class="number">0</span>;</div><div class="line">predicate.test( ”Hello!” );                      <span class="comment">// return true</span></div><div class="line">predicate.negate().test( ”Hello!” );             <span class="comment">// return false</span></div><div class="line">Predicate&lt;String&gt; isEmpty = String::isEmpty;</div><div class="line">Predicate&lt;String&gt; isNotEmpty = isEmpty.negate();</div></pre></td></tr></table></figure></p>
<h3 id="Function接口"><a href="#Function接口" class="headerlink" title="Function接口"></a>Function接口</h3><p>　　<code>Function</code>函数式接口中定义了<code>apply()</code>方法,第<code>1</code>个泛型参数表示<code>apply()</code>方法的参数类型,第<code>2</code>个泛型参数表示<code>apply()</code>方法的返回值类型。其默认方法可用于支持多个<code>Function</code>的链式操作,例如:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Function&lt;String, Integer&gt; toInteger = Integer::valueOf;</div><div class="line">Function&lt;String, String&gt; backToInteger = toInteger.andThen( String::valueOf );</div><div class="line">backToInteger.apply( ”<span class="number">12345</span>” );             <span class="comment">// return ”12345”</span></div></pre></td></tr></table></figure></p>
<h3 id="Supplier接口"><a href="#Supplier接口" class="headerlink" title="Supplier接口"></a>Supplier接口</h3><p>　　<code>Supplier</code>中的<code>get()</code>方法并不接受参数,<code>Supplier</code>函数式接口的泛型参数将作为<code>get()</code>方法的返回值类型。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Supplier&lt;Person&gt; personSupplier = Person::<span class="keyword">new</span>;</div><div class="line">personSupplier.get();</div></pre></td></tr></table></figure></p>
<h3 id="Consumer接口"><a href="#Consumer接口" class="headerlink" title="Consumer接口"></a>Consumer接口</h3><p>　　<code>Consumer</code>函数式接口中的<code>accept()</code>方法接受一个输入参数,并不返回任何值,例如:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Consumer&lt;Person&gt; greeter = ( person ) −&gt; System.out.println( ”Hello ” + person.firstName + ”!” );</div><div class="line">greeter.accept( <span class="keyword">new</span> Person( ”Senlin”, ”Zhan” ) );</div></pre></td></tr></table></figure></p>
<h3 id="Comparator接口"><a href="#Comparator接口" class="headerlink" title="Comparator接口"></a>Comparator接口</h3><p>　　<code>Comparator</code>函数式接口中的<code>compare()</code>方法接受<code>2</code>个参数,其参数类型为接口的泛型参数,<code>compare()</code>返回<code>int</code>类型值,此外,<code>Comparator</code>中还增加了其它的默认方法。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Comparator&lt;Person&gt; comparator = ( p1, p2 ) −&gt; p1.firstName.compareTo( p2.firstName );</div><div class="line">Person p1 = <span class="keyword">new</span> Person( ”Senlin”, ”Zhan” ); <span class="number">4</span> Person p2 = <span class="keyword">new</span> Person( ”Mei”, ”Zhan” );</div><div class="line">comparator.compare( p1, p2 );                  <span class="comment">// return value &gt; 0</span></div><div class="line">comparator.reversed().compare( p1, p2 );       <span class="comment">// return value &lt; 0</span></div></pre></td></tr></table></figure></p>
<h3 id="Optional值"><a href="#Optional值" class="headerlink" title="Optional值"></a>Optional值</h3><p>　　<code>Optional</code>并不是函数式接口, <code>Optional</code>可以用来作为其它值的容器,其包含的值可以是<code>null</code>或非<code>null</code>,使用<code>Optional</code>可以用来防止出现<code>NullPointerException</code>异常。设想,当一个方法有时返回一个非<code>null</code>值,而当这个方法不返回任何值时,在这种情况下,应当返回一个<code>Optional</code>值而不是返回<code>null</code>。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Optional&lt;String&gt; optional = Optional.of( ”my” );</div><div class="line">optional.isPresent();                                          <span class="comment">// return true</span></div><div class="line">optional.get();                                                <span class="comment">// return ”my”</span></div><div class="line">optional.orElse( ”me” );                                       <span class="comment">// return ”me”</span></div><div class="line">optional.ifPresent( (s) −&gt; System.out.println(s.charAt(<span class="number">0</span>)) );  <span class="comment">// print ”m”</span></div></pre></td></tr></table></figure></p>
<p>　　使用<code>Optional</code>的<code>orElse()</code>方法, 当<code>Optional</code>中不包含任何值时, 将返回<code>orElse()</code>方法的参数。</p>
<h3 id="Stream接口"><a href="#Stream接口" class="headerlink" title="Stream接口"></a>Stream接口</h3><p>　　<code>java.util.Stream</code>表示由一个或多个元素组成的序列,并且包含了对这些元素所执行的相关操作。<code>Stream</code>的操作可分为中间<code>(intermediate)</code>操作和终端<code>(terminal)</code>操作,终端操作能返回确切类型的结果,而中间操作则返回<code>Stream</code>本身,以支持链式方法调用。<code>Stream</code>的操作可以按顺序执行或按并行的方式执行。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">List&lt;String&gt; coll = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">coll.add( ”hello” );</div><div class="line">coll.add( ”world” );</div><div class="line">coll.add( ”senlin” );</div><div class="line">coll.add( ”mei” );</div></pre></td></tr></table></figure></p>
<h4 id="filter操作"><a href="#filter操作" class="headerlink" title="filter操作"></a>filter操作</h4><p>　　<code>filter</code>为中间操作,操作接受一个<code>Predicate</code>类型的参数。而<code>forEach</code>为终端操作,接受一个<code>Consumer</code>类型的参数。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">coll.stream()</div><div class="line">    .filter( ( s ) −&gt; s.startsWith( ”s” ) )</div><div class="line">    .forEach( System.out::println );               <span class="comment">// print ”senlin”</span></div></pre></td></tr></table></figure></p>
<h4 id="sorted操作"><a href="#sorted操作" class="headerlink" title="sorted操作"></a>sorted操作</h4><p>　　<code>sorted</code>为中间操作,用来返回一个排序元素的视图<code>(view)</code>,默认情况下,元素按照自然顺序排序,此外,也可以传递<code>Comparator</code>对象,用于指定特定的排序方式。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">coll.stream()</div><div class="line">    .sorted()</div><div class="line">    .forEach( System.out::println );</div></pre></td></tr></table></figure></p>
<p>　　注意,<code>sorted</code>操作仅作用于其创建的视图，因此，<code>coll</code>中元素的顺序并没有发生改变。</p>
<h4 id="map操作"><a href="#map操作" class="headerlink" title="map操作"></a>map操作</h4><p>　　<code>map</code>操作为中间操作,通过给定的<code>lambda</code>表达式,可以将<code>Stream</code>中每一个元素转换成为其它类型的对象。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">coll.stream()</div><div class="line">    .map( String::toUpperCase )</div><div class="line">    .sorted( ( a, b ) −&gt; b.compareTo( a ) )</div><div class="line">    .forEach( System.out::println );</div></pre></td></tr></table></figure></p>
<h4 id="match操作"><a href="#match操作" class="headerlink" title="match操作"></a>match操作</h4><p>　　使用不同的<code>match</code>操作,可以判断<code>Stream</code>中的元素是否与指定的<code>Predicate</code>相匹配,这些<code>match</code>操作均为终端操作,并返回<code>boolean</code>类型值,例如:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">boolean</span> anyStartsWithS = coll.stream()</div><div class="line">                             .anyMatch( ( s ) −&gt; s.startsWith( ”s” ) );</div><div class="line">System.out.println( anyStartsWithS );             <span class="comment">// print true</span></div><div class="line"></div><div class="line"><span class="keyword">boolean</span> allStartsWithS = coll.stream()</div><div class="line">                             .allMatch( ( s ) −&gt; s.startsWith( ”s” ) );</div><div class="line">System.out.println( allStartsWithS );             <span class="comment">// print false</span></div><div class="line"></div><div class="line"><span class="keyword">boolean</span> noneStartsWithS = coll.stream()</div><div class="line">                              .noneMatch( ( s ) −&gt; s.startsWith( ”s” ) );</div><div class="line">System.out.println( noneStartsWithS );            <span class="comment">// print false</span></div></pre></td></tr></table></figure></p>
<h4 id="count操作"><a href="#count操作" class="headerlink" title="count操作"></a>count操作</h4><p>　　<code>count</code>是终端操作,返回一个<code>long</code>类型值表示<code>Stream</code>中元素的数目。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">long</span> numOfStartsWithS = coll.stream()</div><div class="line">                            .filter( ( s ) −&gt; s.startsWith( ”s” ) )</div><div class="line">                            .count();             <span class="comment">// return 1</span></div></pre></td></tr></table></figure></p>
<h4 id="reduce操作"><a href="#reduce操作" class="headerlink" title="reduce操作"></a>reduce操作</h4><p>　　<code>reduce</code>为终端操作,其返回值为<code>Optional</code>类型:<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Optional&lt;String&gt; reduced = coll.stream()</div><div class="line">                               .sorted()</div><div class="line">                               .reduce( ( s1, s2 ) −&gt; s1 + ”#” + s2 );</div><div class="line">reduced.ifPresent( System.out::println );        // print ”hello#mei#senlin#world”</div></pre></td></tr></table></figure></p>
<h2 id="Parallel-Stream"><a href="#Parallel-Stream" class="headerlink" title="Parallel Stream"></a>Parallel Stream</h2><p>　　对于并行<code>Stream</code>来说,其操作均在多条线程中并发地执行。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> max = <span class="number">1000000</span>;</div><div class="line">List&lt;String&gt; values = <span class="keyword">new</span> ArrayList&lt;&gt;( max );</div><div class="line"><span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; max; i++ ) &#123;</div><div class="line">    UUID uuid = UUID.randomUUID();</div><div class="line">    values.add( uuid.toString() );</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="顺序排序"><a href="#顺序排序" class="headerlink" title="顺序排序"></a>顺序排序</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">long</span> time1 = System.nanoTime();</div><div class="line"><span class="keyword">long</span> count = values.stream()</div><div class="line">                   .sorted()</div><div class="line">                   .count();</div><div class="line"><span class="keyword">long</span> time2 = System.nanoTime();</div><div class="line"><span class="keyword">long</span> millis = TimeUnit.NANOSECONDS.toMillis( time2 − time1 );</div><div class="line">System.out.println( String.format( ”sequential sort took: %d ms”, millis ) );</div><div class="line"><span class="comment">// print ”sequential sort took: 1147 ms”</span></div></pre></td></tr></table></figure>
<h3 id="并行排序"><a href="#并行排序" class="headerlink" title="并行排序"></a>并行排序</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">long</span> time1 = System.nanoTime();</div><div class="line"><span class="keyword">long</span> count = values.parallelStream()</div><div class="line">                   .sorted()</div><div class="line">                   .count();</div><div class="line"><span class="keyword">long</span> time2 = System.nanoTime();</div><div class="line"><span class="keyword">long</span> millis = TimeUnit.NANOSECONDS.toMillis( time2 − time1 );</div><div class="line">System.out.println( String.format( ”parallel sort took: %d ms”, millis ) );</div><div class="line"><span class="comment">// print ”parallel sort took: 767 ms”</span></div></pre></td></tr></table></figure>
<h2 id="集合Map"><a href="#集合Map" class="headerlink" title="集合Map"></a>集合Map</h2><p>　　<code>Map</code>并不支持<code>Stream</code>的操作,因此,在<code>Map</code>中提供了新的方法用于支持类似于<code>Stream</code>的操作。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Map&lt;Integer, String&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line"><span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ ) &#123;</div><div class="line">    map.putIfAbsent( i, ”val” + i );</div><div class="line">&#125;</div><div class="line">map.forEach( ( id, value ) −&gt; System.out.println( value ) );</div></pre></td></tr></table></figure></p>
<p>　　使用<code>Map</code>的<code>putIfAbsent()</code>方法为<code>Map</code>增加新的元素,但注意,仅有当元素的键在<code>Map</code>中不存在时,这个元素才会被加入到<code>Map</code>中。这可以防止对<code>Map</code>中既存的元素进行修改。此外,<code>Map</code>的<code>forEach()</code>方法接受一个带有<code>2</code>个参数的<code>lambda</code>表达式,用来对<code>Map</code>进行历遍,其中,这<code>2</code>个参数分别表示键和值。<br>　　可以使用<code>Map</code>的<code>computeIfPresent()</code>方法,当键存在时,可以对这个键所对应的值进行修改,例如:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">map.computeIfPresent( <span class="number">5</span>, ( num, value ) −&gt; value + num );</div><div class="line">map.get( <span class="number">5</span> );            <span class="comment">// return ”value55”</span></div></pre></td></tr></table></figure></p>
<p>但需注意,当<code>lambda</code>表达式中的语句为<code>null</code>时,若这个键存在,则这个键值对将被移除,例如:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">map.computeIfPresent( <span class="number">2</span>, ( num, value ) −&gt; <span class="keyword">null</span> );</div><div class="line">map.containsKey( <span class="number">2</span> );    <span class="comment">// return false</span></div></pre></td></tr></table></figure></p>
<p>　　使用<code>computeIfAbsent()</code>方法,当这个方法第<code>1</code>个参数指定的键不存在时,则<code>lambda</code>表达式将计算这个键所对应的值,并将这个键值对增加到<code>Map</code>中,例如:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">map.computeIfAbsent( <span class="number">20</span>, num −&gt; ”val” + num );</div><div class="line">map.get( <span class="number">20</span> );            <span class="comment">// return ”val20”</span></div></pre></td></tr></table></figure></p>
<p>　　注意,当指定的键不存在时,则<code>Map</code>中这个键并不存在相对应的值,因此,<code>lambda</code>表达式仅有一个参数,用来表示键。<br>　　而当<code>computeIfAbsent()</code>指定的键已经存在时,则这个方法将不对这个键值对做出修改,例如:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">map.computeIfAbsent( <span class="number">6</span>, num −&gt; ”hello” );</div><div class="line">map.get( <span class="number">6</span> );             <span class="comment">// return ”val6”</span></div></pre></td></tr></table></figure></p>
<p>　　此外,使用<code>Map</code>的<code>remove()</code>方法可以用来在<code>Map</code>中删除指定的键值对,但需注意,只有当指定的键值对在<code>Map</code>中存在时,这个键值对才会被移除,例如:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">map.remove( <span class="number">20</span>, ”val2” );</div><div class="line">map.get( <span class="number">20</span> );                    <span class="comment">// return ”val20”</span></div><div class="line">map.remove( <span class="number">20</span>, ”val20” );</div><div class="line">map.get( <span class="number">20</span> );                    <span class="comment">// return null</span></div></pre></td></tr></table></figure>
<p>　　另外一个有用的操作<code>getOrDefault()</code>的使用方式:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">map.getOrDefault( <span class="number">100</span>, ”not found” );        <span class="comment">// return ”not found”</span></div></pre></td></tr></table></figure></p>
<p>　　使用<code>merge()</code>来改变键对应的值:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">map.merge( <span class="number">50</span>, ”val50”, ( value, newValue ) −&gt; value.concat( newValue ) );</div><div class="line">map.get( <span class="number">50</span> );                               <span class="comment">// return ”val50”</span></div></pre></td></tr></table></figure></p>
<p>　　注意,键<code>50</code>在<code>Map</code>并不存在,因此,<code>Map</code>会增加新的键值对,而不会执行<code>merge()</code>中的<code>lambda</code>表达式。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">map.merge( <span class="number">50</span>, ”concat”, ( value, newValue ) −&gt; value.concat( newValue ) );</div><div class="line">map.get( <span class="number">50</span> );                              <span class="comment">// return ”val50concat”</span></div></pre></td></tr></table></figure></p>
<p>　　当键存在时,则将执行<code>lambda</code>表达式,因此,与这个键相对应的值将会被修改,注意,<code>newValue</code>表示的即是<code>”concat”</code>。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/10/28/Java-network/" itemprop="url">
                  Java 网络编程（一）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-10-28T10:13:36+08:00" content="2014-10-28">
              2014-10-28
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/网络编程/" itemprop="url" rel="index">
                    <span itemprop="name">网络编程</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="客户端与服务端"><a href="#客户端与服务端" class="headerlink" title="客户端与服务端"></a>客户端与服务端</h2><p>　　可以根据给定的端口号来创建<code>ServerSocket</code>对象，当调用<code>accept()</code>方法时，<code>ServerSocket</code>将会处于阻塞状态，等待客户端的连接，当客户端请求连接成功之后，<code>accept()</code>方法将会返回<code>Socket</code>对象。端口号小于或等于<code>1024</code>的端口将作为其它目的而被使用，通常，<code>ServerSocket</code>所监听的端口号应当大于<code>1024</code>，若需要监听小于或等于<code>1024</code>的端口，则程序应当获得管理员权限:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.*;</div><div class="line"><span class="keyword">import</span> java.net.*;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Listen</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> PORT = <span class="number">1234</span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">( String[] args )</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">try</span>( ServerSocket server = <span class="keyword">new</span> ServerSocket( PORT ) ) &#123;</div><div class="line">            <span class="keyword">while</span>( <span class="keyword">true</span> ) &#123;</div><div class="line">                <span class="keyword">try</span>( Socket connection = server.accept() ) &#123;</div><div class="line">                    System.out.println( <span class="string">"Accept from client "</span> + </div><div class="line">                                        connection.getInetAddress() );</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">catch</span>( IOException e ) &#123;</div><div class="line">            System.err.println( e );</div><div class="line">        &#125;        </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>　　此外，当需要创建客户端时，可以创建<code>Socket</code>对象:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.net.*;</div><div class="line"><span class="keyword">import</span> java.io.*;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> PORT = <span class="number">1234</span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">( String[] args )</span> </span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">try</span>( Socket connection = <span class="keyword">new</span> Socket( <span class="string">"localhost"</span>, PORT ) )&#123;</div><div class="line">            System.out.println( <span class="string">"Client connect successfully!"</span> );</div><div class="line">        &#125; <span class="keyword">catch</span>( IOException e ) &#123;</div><div class="line">            System.err.println( e );</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="网络地址"><a href="#网络地址" class="headerlink" title="网络地址"></a>网络地址</h2><p>　　<code>InetAddress</code>对象用来表示网络地址，<code>InetAddress</code>并没有<code>public</code>的构造方法，但可以通过调用<code>static</code>的<code>getByName()</code>方法，这个方法接受<code>String</code>类型参数，参数可以是域名或<code>IP</code>地址，这个方法会抛出<code>UnknownHostException</code>异常，由于这个方法并不会与远程主机建立连接，因此，并不会抛出其它与网络连接相关的异常:</p>
<pre><code>public static InetAddress getByName(String host) throws UnknownHostException
</code></pre><p>　　<code>getHostAddress()</code>方法则会返回<code>String</code>对象，包含<code>IP</code>地址，而<code>getHostName()</code>方法则会返回<code>String</code>对象，包含域名:</p>
<pre><code>public String getHostAddress()
public String getHostName()
</code></pre><p>　　此外，可以通过<code>Socket</code>对象的<code>getInetAddress()</code>方法来获得相应的<code>InetAddress</code>对象:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.*;</div><div class="line"><span class="keyword">import</span> java.net.*;</div><div class="line"><span class="keyword">import</span> java.util.stream.*;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FindInetAddress</span> </span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">( String[] args )</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">        <span class="comment">// 通过域名获得地址</span></div><div class="line">        String hostName = <span class="string">"www.google.cn"</span>;</div><div class="line">        System.out.println( hostName + <span class="string">"'s address is "</span> + </div><div class="line">                            InetAddress.getByName( hostName ).getHostAddress() );</div><div class="line"></div><div class="line">        <span class="comment">// 通过地址来获得域名</span></div><div class="line">        String ipNumber = <span class="string">"8.8.8.8"</span>;          <span class="comment">// 谷歌DNS服务器的地址</span></div><div class="line">        System.out.println( ipNumber + <span class="string">"'s name is "</span> + </div><div class="line">                            InetAddress.getByName( ipNumber ).getHostName() );</div><div class="line"></div><div class="line">        <span class="keyword">final</span> InetAddress localhost = InetAddress.getLocalHost();</div><div class="line">        System.out.println( <span class="string">"My localhost is "</span> + localhost );       </div><div class="line">	</div><div class="line">        String serverName = <span class="string">"www.google.cn"</span>;</div><div class="line">        Socket connection = <span class="keyword">new</span> Socket( serverName, <span class="number">80</span> );</div><div class="line">        InetAddress remoteAddress = connection.getInetAddress();</div><div class="line">        System.out.printf( <span class="string">"The Address for %s is %s\n"</span>, </div><div class="line">                           serverName, remoteAddress );</div><div class="line">        </div><div class="line">        System.out.println( <span class="string">"All Address for "</span> + serverName + <span class="string">" is :"</span> );</div><div class="line">        InetAddress[] allAddress = InetAddress.getAllByName( serverName );</div><div class="line"></div><div class="line">        <span class="comment">// 输出www.google.cn对应的所有地址</span></div><div class="line">        Stream.of( allAddress )                <span class="comment">// 使用 Java 8的 Stream 类</span></div><div class="line">              .map( InetAddress::getHostAddress )</div><div class="line">              .forEach( System.out::println );</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>　　程序的输出：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">www.google.cn's address is 203.208.41.145</div><div class="line">8.8.8.8's name is google-public-dns-a.google.com</div><div class="line">My localhost is senlin-Aspire-4752/127.0.1.1</div><div class="line">The Address for www.google.cn is www.google.cn/203.208.41.145</div><div class="line">All Address for www.google.cn is :</div><div class="line">203.208.41.145</div><div class="line">203.208.41.147</div><div class="line">203.208.41.148</div><div class="line">203.208.41.144</div><div class="line">203.208.41.146</div><div class="line">2404:6800:4008:c02:0:0:0:a0</div></pre></td></tr></table></figure></p>
<p>　　此外，可以通过<code>InetAddress</code>对象和端口号来构造<code>Socket</code>对象:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">final</span> <span class="keyword">int</span> PORT = <span class="number">80</span>;</div><div class="line">    InetAddress address = InetAddress.getByName( <span class="string">"www.google.cn"</span> );</div><div class="line">    Socket connection = <span class="keyword">new</span> Socket( address, PORT );</div><div class="line">&#125; <span class="keyword">catch</span>( IOException e ) &#123;</div><div class="line">    System.err.println( e );</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="处理网络错误"><a href="#处理网络错误" class="headerlink" title="处理网络错误"></a>处理网络错误</h2><p>　　有时需要了解更多的关于网络异常的细节，而不仅是捕获<code>IOException</code>异常。<code>SocketException</code>存在<code>ConnectException</code>和<code>NoRouteToHostException</code>子类，前者表示连接被远程主机所拒绝，后者表示无法连接到远程主机:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.*;</div><div class="line"><span class="keyword">import</span> java.net.*;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HandleException</span></span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">( String[] args )</span> </span>&#123;</div><div class="line">        <span class="keyword">final</span> String serverName = <span class="string">"www.google.cn"</span>;</div><div class="line">        <span class="keyword">final</span> <span class="keyword">int</span> port  = <span class="number">80</span>;</div><div class="line">        <span class="keyword">try</span>( Socket connection = <span class="keyword">new</span> Socket( serverName, port ) ) &#123;</div><div class="line">                System.out.println( <span class="string">"Connection to "</span> + serverName );</div><div class="line">            &#125; <span class="keyword">catch</span>( UnknownHostException e ) &#123;</div><div class="line">            System.err.println( serverName + <span class="string">" Unknown host"</span> );</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125; <span class="keyword">catch</span>( NoRouteToHostException e) &#123;</div><div class="line">            System.err.println( serverName + <span class="string">" Unreachable"</span> );</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125; <span class="keyword">catch</span>( ConnectException e ) &#123;</div><div class="line">            System.err.println( serverName + <span class="string">"connect refused"</span> );</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125; <span class="keyword">catch</span>( IOException e ) &#123;</div><div class="line">            System.err.println( serverName + e.getMessage() );</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="获得InputStream和OutputStream"><a href="#获得InputStream和OutputStream" class="headerlink" title="获得InputStream和OutputStream"></a>获得InputStream和OutputStream</h2><p>　　<code>ServerSocket</code>的<code>accept()</code>方法将会返回<code>Socket</code>对象，通过<code>Socket</code>的<code>getInputStream()</code>方法可以获得<code>InputStream</code>对象，而其<code>getOutputStream()</code>方法则返回<code>OutputStream</code>对象:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.*;</div><div class="line"><span class="keyword">import</span> java.net.*;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EchoServer</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> PORT = <span class="number">7</span>;</div><div class="line">    <span class="keyword">protected</span> ServerSocket server = <span class="keyword">null</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">( String[] args )</span></span>&#123;</div><div class="line">        ( <span class="keyword">new</span> EchoServer() ).handle();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EchoServer</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            server = <span class="keyword">new</span> ServerSocket( PORT );</div><div class="line">        &#125; <span class="keyword">catch</span>( IOException e ) &#123;</div><div class="line">            System.err.println( <span class="string">"I/O error in setup"</span> );</div><div class="line">            System.err.println( e );</div><div class="line">            System.exit( <span class="number">1</span> );</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">()</span> </span>&#123;</div><div class="line">        Socket connection = <span class="keyword">null</span>;</div><div class="line">        BufferedReader reader = <span class="keyword">null</span>;</div><div class="line">        PrintWriter writer = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">while</span>( <span class="keyword">true</span> ) &#123;</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                System.out.println( <span class="string">"Waiting for client..."</span> );</div><div class="line">                connection = server.accept();</div><div class="line">                System.out.println( <span class="string">"Accepted from "</span> +</div><div class="line">                                    connection.getInetAddress().getHostName());</div><div class="line">                reader = <span class="keyword">new</span> BufferedReader( <span class="keyword">new</span> InputStreamReader( </div><div class="line">                                                 connection.getInputStream(), <span class="string">"UTF-8"</span>));</div><div class="line">                writer = <span class="keyword">new</span> PrintWriter( <span class="keyword">new</span> OutputStreamWriter(</div><div class="line">                                              connection.getOutputStream(), <span class="string">"UTF-8"</span>), <span class="keyword">true</span>);</div><div class="line">                String echoLine;</div><div class="line">                <span class="keyword">while</span>( ( echoLine = reader.readLine() ) != <span class="keyword">null</span> ) &#123;</div><div class="line">                    System.out.println( <span class="string">"Read: "</span> + echoLine );</div><div class="line">                    writer.print( echoLine + <span class="string">"\r\n"</span> );</div><div class="line">                    writer.flush();</div><div class="line">                    System.out.println( <span class="string">"Write: "</span> + echoLine );</div><div class="line">                &#125;</div><div class="line">                System.err.println( <span class="string">"All done!"</span> );</div><div class="line">            &#125; <span class="keyword">catch</span>( IOException e ) &#123;</div><div class="line">                System.err.println( e );</div><div class="line">            &#125; <span class="keyword">finally</span> &#123;</div><div class="line">                <span class="keyword">try</span> &#123;</div><div class="line">                    <span class="keyword">if</span>( reader != <span class="keyword">null</span> ) &#123;</div><div class="line">                        reader.close();</div><div class="line">                    &#125; </div><div class="line">                    <span class="keyword">if</span>( writer != <span class="keyword">null</span> ) &#123;</div><div class="line">                        writer.close();</div><div class="line">                    &#125;</div><div class="line">                    <span class="keyword">if</span>( connection != <span class="keyword">null</span> ) &#123;</div><div class="line">                        connection.close();</div><div class="line">                    &#125;</div><div class="line">                &#125; <span class="keyword">catch</span>( IOException e ) &#123;</div><div class="line">                    System.err.println( <span class="string">"IO error in close"</span> );</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>　　当通过网络发送字符串时，许多协议指定使用<code>&quot;\r\n&quot;</code>作为换行符:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.*;</div><div class="line"><span class="keyword">import</span> java.io.*;</div><div class="line"><span class="keyword">import</span> java.net.*;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EchoClient</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> PORT = <span class="number">7</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String remoteServer = <span class="string">"localhost"</span>;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">( String[] args )</span> </span>&#123;</div><div class="line">        ( <span class="keyword">new</span> EchoClient() ).process();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">try</span>( Socket connection = <span class="keyword">new</span> Socket( remoteServer, PORT ) ) &#123;</div><div class="line">            BufferedReader reader = <span class="keyword">new</span> BufferedReader( <span class="keyword">new</span> InputStreamReader(</div><div class="line">                connection.getInputStream(), <span class="string">"UTF-8"</span> ) );</div><div class="line">            PrintWriter writer = <span class="keyword">new</span> PrintWriter( <span class="keyword">new</span> OutputStreamWriter( </div><div class="line">                connection.getOutputStream(), <span class="string">"UTF-8"</span> ), <span class="keyword">true</span> );</div><div class="line"></div><div class="line">            Scanner scanner = <span class="keyword">new</span> Scanner( System.in );</div><div class="line">            System.out.print( <span class="string">"Enter One Line: "</span> );</div><div class="line"></div><div class="line">            <span class="keyword">while</span>( scanner.hasNextLine() ) &#123;</div><div class="line">                String inputLine = scanner.nextLine();</div><div class="line">                writer.print( inputLine + <span class="string">"\r\n"</span> );</div><div class="line">                writer.flush();</div><div class="line">                System.out.println( <span class="string">"Sent: "</span> + inputLine );</div><div class="line">                String receivedLine = reader.readLine();</div><div class="line">                System.out.println( <span class="string">"Got: "</span> + receivedLine );</div><div class="line">                System.out.print( <span class="string">"Enter One Line: "</span> );</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">catch</span>( IOException e ) &#123;</div><div class="line">            System.err.println( e );</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>　　此外，可以通过<code>InputStream</code>和<code>OutputStream</code>来分别构造<code>DataInputStream</code>和<code>DataOutputStream</code>对象，以此来写入二进制数据:</p>
<pre><code>Socket connection = ...;
DataInputStream in = new DataInputStream(connection.getInputStream());
DataInputStream in = new DataInputStream(connection.getInputStream());
</code></pre><p>　　若需要传输的数据量较大，则可以组合使用<code>BufferedInputStream</code>和<code>BufferedOutputStream</code>对象:</p>
<pre><code>DataInputStream in = new DataInputStream( new BufferedInputStream( connection.getInputStream() ) );
DataOutputStream out = new DataOutputStream( new BufferedOutputStream( connection.getOutputStream() ) );
</code></pre><h2 id="简单的时间服务器"><a href="#简单的时间服务器" class="headerlink" title="简单的时间服务器　　"></a>简单的时间服务器　　</h2><p>　　通常，时间服务器所返回的是从<code>1900</code>年至今的秒数，而<code>Java</code>中的<code>Date</code>类则是基于<code>1970</code>年的，因此，若客户端从时间服务器得到了从<code>1900</code>年至今的秒数，则这个秒数需要减去<code>1900</code>年到<code>1970</code>年之间的秒数，此外，由于<code>Date</code>类的构造方法接受的是毫秒单位，因此，需将秒数乘以<code>1000</code>则可。此外，对于时间服务器来说，所返回的是<code>unsigned int</code>类型，而<code>DataInputStream</code>的<code>readInt()</code>方法所读取的则是<code>signed int</code>类型，并且并不存在<code>readUnsignedInt()</code>方法，因此，需要使用位操作将时间服务器所返回的秒数保存在<code>long</code>类型的变量中:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.*;</div><div class="line"><span class="keyword">import</span> java.net.*;</div><div class="line"><span class="keyword">import</span> java.time.*;</div><div class="line"><span class="keyword">import</span> java.util.*;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RDateClient</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> PORT = <span class="number">37</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String serverName = <span class="string">"localhost"</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> BASE_DAYS = (<span class="keyword">long</span>)( (<span class="number">1970</span> - <span class="number">1900</span>) * <span class="number">365</span> + (<span class="number">1970</span> - <span class="number">1900</span> - <span class="number">1</span>) / <span class="number">4</span> );</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> BASE_DIFF = BASE_DAYS * <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MSEC = <span class="number">1000</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">( String[] args )</span></span>&#123;</div><div class="line">        <span class="keyword">try</span>( Socket connection = <span class="keyword">new</span> Socket( serverName, PORT ) ) &#123;</div><div class="line">            DataInputStream in = <span class="keyword">new</span> DataInputStream( </div><div class="line">                <span class="keyword">new</span> BufferedInputStream( connection.getInputStream() ) );</div><div class="line"></div><div class="line">            <span class="keyword">long</span> remoteTime = (</div><div class="line">                ( (<span class="keyword">long</span>)(in.readUnsignedByte()) &lt;&lt; <span class="number">24</span> ) |</div><div class="line">                ( (<span class="keyword">long</span>)(in.readUnsignedByte()) &lt;&lt; <span class="number">16</span> ) |</div><div class="line">                ( (<span class="keyword">long</span>)(in.readUnsignedByte()) &lt;&lt; <span class="number">8</span> ) |</div><div class="line">                ( (<span class="keyword">long</span>)(in.readUnsignedByte()) &lt;&lt; <span class="number">0</span> ) );            </div><div class="line"></div><div class="line">            System.out.println( <span class="string">"Remote time is "</span> + remoteTime );</div><div class="line">            System.out.println( <span class="string">"BASE_DIFF is "</span> + BASE_DIFF );</div><div class="line">            System.out.println( <span class="string">"Time diff == "</span> + (remoteTime - BASE_DIFF) );</div><div class="line">            Date d = <span class="keyword">new</span> Date( ( remoteTime - BASE_DIFF ) * MSEC );</div><div class="line">            System.out.println( <span class="string">"Time on "</span> + serverName + <span class="string">" is "</span> + d );</div><div class="line">            System.out.println( <span class="string">"Local data/time = "</span> + LocalDateTime.now() );</div><div class="line">        &#125; <span class="keyword">catch</span>( IOException e ) &#123;</div><div class="line">            System.err.println( e );</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>　　在服务端，由于<code>System.currentTimeMillis()</code>方法所返回的是<code>1970</code>年至今的毫秒数，需要将其转换成为秒数，其次再转换成为从<code>1900</code>年至今的秒数:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.*;</div><div class="line"><span class="keyword">import</span> java.net.*;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DaytimeServer</span></span></div><div class="line">&#123;</div><div class="line">    ServerSocket server;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> PORT = <span class="number">37</span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">( String[] args )</span></span>&#123;</div><div class="line">        ( <span class="keyword">new</span> DaytimeServer( PORT ) ).runService();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DaytimeServer</span><span class="params">( <span class="keyword">int</span> port )</span></span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            server = <span class="keyword">new</span> ServerSocket( port );</div><div class="line">        &#125; <span class="keyword">catch</span>( IOException e ) &#123;</div><div class="line">            System.err.println( <span class="string">"I/O error in setup\n"</span> + e );</div><div class="line">            System.exit( <span class="number">1</span> );</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">runService</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">while</span>( <span class="keyword">true</span> ) &#123;</div><div class="line">            System.out.println( <span class="string">"Waiting for connection on port "</span> + PORT );</div><div class="line">            <span class="keyword">try</span>( Socket connection = server.accept() ) &#123;</div><div class="line">                System.out.println( <span class="string">"Accepted from "</span> + </div><div class="line">                    connection.getInetAddress().getHostName() );</div><div class="line">                DataOutputStream out = <span class="keyword">new</span> DataOutputStream( </div><div class="line">                    connection.getOutputStream() );</div><div class="line"></div><div class="line">                <span class="keyword">long</span> time = System.currentTimeMillis();</div><div class="line">                time /= RDateClient.MSEC;</div><div class="line">                time += RDateClient.BASE_DIFF;</div><div class="line"></div><div class="line">                out.writeByte( (<span class="keyword">int</span>)( time &gt;&gt; <span class="number">24</span> ) );</div><div class="line">                out.writeByte( (<span class="keyword">int</span>)( time &gt;&gt; <span class="number">16</span> ) );</div><div class="line">                out.writeByte( (<span class="keyword">int</span>)( time &gt;&gt; <span class="number">8</span> ) );</div><div class="line">                out.writeByte( (<span class="keyword">int</span>)( time &gt;&gt; <span class="number">0</span> ) );</div><div class="line">            &#125; <span class="keyword">catch</span>( IOException e ) &#123;</div><div class="line">                System.err.println( e );</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="传输对象"><a href="#传输对象" class="headerlink" title="传输对象"></a>传输对象</h2><p>　　可以使用<code>ObjectInputStream</code>和<code>ObjectOutputStream</code>在客户端和服务端之间传递对象:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">import java.net.*;</div><div class="line">import java.io.*;</div><div class="line">import java.util.*;</div><div class="line"></div><div class="line">public class DaytimeObjectServer</div><div class="line">&#123;</div><div class="line">    public static final int PORT = 1234;</div><div class="line">    public static void main( String[] args )&#123;</div><div class="line">        try( ServerSocket server = new ServerSocket( PORT ) ) &#123;</div><div class="line">            while( true )&#123;</div><div class="line">                try( Socket connection = server.accept() ) &#123;</div><div class="line">                        System.out.println( &quot;Accepted from &quot; + connection.getInetAddress() );</div><div class="line">                        ObjectOutputStream out = new ObjectOutputStream(connection.getOutputStream());</div><div class="line">                        out.writeObject( new Date() );</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125; catch( IOException e ) &#123;</div><div class="line">            System.out.println( e );</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>　　客户端程序:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.*;</div><div class="line"><span class="keyword">import</span> java.net.*;</div><div class="line"><span class="keyword">import</span> java.util.*;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DaytimeObjectClient</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> PORT = <span class="number">1234</span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">( String[] args )</span></span>&#123;</div><div class="line">        <span class="keyword">try</span>( Socket connection = <span class="keyword">new</span> Socket( <span class="string">"localhost"</span>, PORT  ) ) &#123;</div><div class="line">            ObjectInputStream in = <span class="keyword">new</span> ObjectInputStream( connection.getInputStream() );</div><div class="line">            Object obj = in.readObject();</div><div class="line">            <span class="keyword">if</span>( obj == <span class="keyword">null</span> ) &#123;</div><div class="line">                System.err.println( <span class="string">"Read null from server!"</span> );                </div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>( obj <span class="keyword">instanceof</span> Date ) &#123;</div><div class="line">                Date date = (Date)obj;</div><div class="line">                System.out.println( <span class="string">"Time from server is "</span> + date );</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException( <span class="string">"Wanted Date, got "</span> + obj );</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">catch</span>( ClassNotFoundException e ) &#123;</div><div class="line">            System.err.println(<span class="string">"Wanted date, got INVALID CLASS ("</span> + e + <span class="string">")"</span>);</div><div class="line">        &#125; <span class="keyword">catch</span>( IOException e ) &#123;</div><div class="line">            System.err.println( e );</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="多线程服务端"><a href="#多线程服务端" class="headerlink" title="多线程服务端"></a>多线程服务端</h2><p>　　在多线程服务端中，主线程中未每一个请求连接的客户端分配一条线程:<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line">import java.io.*;</div><div class="line">import java.net.*;</div><div class="line"></div><div class="line">public class EchoServerThreaded</div><div class="line">&#123;</div><div class="line">    public static final int PORT = 7;</div><div class="line">    public static void main( String[] args ) &#123;</div><div class="line">        ( new EchoServerThreaded() ).runServer();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    public void runServer() &#123;</div><div class="line">        try( ServerSocket server = new ServerSocket( PORT ) ) &#123;</div><div class="line">            System.out.println( "EchoServerThreaded ready for connections." );</div><div class="line">            while( true ) &#123;</div><div class="line">                Socket connection = server.accept();</div><div class="line">                ( new Thread( new Handler( connection ) ) ).start();</div><div class="line">            &#125;</div><div class="line">        &#125; catch( IOException e ) &#123;</div><div class="line">            System.err.println( "Could not accept " + e );</div><div class="line">            System.exit( 1 );</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    private class Handler implements Runnable</div><div class="line">    &#123;</div><div class="line">        private Socket connection;</div><div class="line">        public Handler( Socket connection ) &#123;</div><div class="line">            this.connection = connection;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        @Override</div><div class="line">        public void run() &#123;</div><div class="line">            System.out.println( "Socket starting: " + connection );</div><div class="line">            try &#123;</div><div class="line">                BufferedReader reader = new BufferedReader( </div><div class="line">                    new InputStreamReader( connection.getInputStream(), "UTF-8" ) );</div><div class="line">                PrintWriter writer = new PrintWriter( </div><div class="line">                    new OutputStreamWriter( connection.getOutputStream(), UTF-8" ), true );</div><div class="line"></div><div class="line">                String receivedLine;</div><div class="line">                while( ( receivedLine = reader.readLine() ) != null ) &#123;</div><div class="line">                    writer.print( receivedLine );</div><div class="line">                    writer.print( "\r\n" );</div><div class="line">                    writer.flush();</div><div class="line">                &#125;</div><div class="line">            &#125; catch( IOException e ) &#123;</div><div class="line">                System.out.println( "IO Error on socket " + e );</div><div class="line">            &#125; finally &#123;</div><div class="line">                try &#123;</div><div class="line">                    if( connection != null ) &#123;</div><div class="line">                        connection.close();</div><div class="line">                    &#125;</div><div class="line">                &#125; catch( IOException e ) &#123;</div><div class="line">                    System.err.println( e );</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            System.out.println( "Socket ENDED: " + connection );</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>　　由于程序需要为每一请求连接的客户端创建一条线程，因此，将带来较大的开销，则此时可以考虑预先分配固定数目的线程，在每一条线程中访问<code>ServerSocket</code>对象，但由于<code>ServerSocket</code>的<code>accept()</code>方法不是同步的，因此，应当在<code>synchronized</code>语句块中调用<code>ServerSockt</code>的<code>accept()</code>方法。当没有客户端请求连接时，仅有一条线程可以调用<code>ServerSocket</code>的<code>accept()</code>方法，其它线程则由于无法访问到<code>ServerSocket</code>对象而处于阻塞状态。当其中一条线程的<code>accept()</code>方法返回时，这条线程则与客户端建立起了连接，此时，另一的一条线程将得以访问<code>ServerSocket</code>对象，同时，调用<code>ServerSocket</code>的<code>accept()</code>方法等待客户端的连接。由于线程的数目是固定的，因此，服务端同时时间最多只能处理固定数目的客户端的连接。每一线程的<code>run()</code>方法中都包含循环，这使得一条线程在处理完与某一客户端的连接之后，可以继续处理另一客户端的连结。<br>　　创建拥有固定线程数的服务端:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.*;</div><div class="line"><span class="keyword">import</span> java.net.*;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FixedThreadEchoServer</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> PORT = <span class="number">7</span>;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> NUM_THREADS = <span class="number">4</span>;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">( String[] args )</span> </span>&#123;</div><div class="line">        <span class="keyword">new</span> FixedThreadEchoServer( PORT, NUM_THREADS );</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FixedThreadEchoServer</span><span class="params">( <span class="keyword">int</span> port, <span class="keyword">int</span> num )</span> </span>&#123;</div><div class="line">        ServerSocket server = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            server = <span class="keyword">new</span> ServerSocket( port );</div><div class="line">        &#125; <span class="keyword">catch</span>( IOException e ) &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException( <span class="string">"Could not create ServerSocket "</span>, e );</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; num; ++i ) &#123;</div><div class="line">            ( <span class="keyword">new</span> Handler( server, i ) ).start();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Handler</span> <span class="keyword">extends</span> <span class="title">Thread</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">private</span> ServerSocket server;</div><div class="line">        <span class="keyword">private</span> <span class="keyword">int</span> threadNumber;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Handler</span><span class="params">( ServerSocket server, <span class="keyword">int</span> threadNumber )</span> </span>&#123;</div><div class="line">            <span class="keyword">this</span>.server = server;</div><div class="line">            <span class="keyword">this</span>.threadNumber = threadNumber;</div><div class="line">            setName( <span class="string">"Thread "</span> + threadNumber );</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">while</span>( <span class="keyword">true</span> ) &#123;</div><div class="line">                System.out.println( getName() + <span class="string">" waiting"</span> );</div><div class="line">                Socket connection = <span class="keyword">null</span>;</div><div class="line">                <span class="keyword">try</span> &#123;</div><div class="line">                    <span class="keyword">synchronized</span>( server ) &#123;</div><div class="line">                        connection = server.accept();</div><div class="line">                    &#125;</div><div class="line"></div><div class="line">                    System.out.println(getName() + <span class="string">" starting, IP = "</span> + connection.getInetAddress());</div><div class="line">                    BufferedReader reader = <span class="keyword">new</span> BufferedReader( </div><div class="line">                        <span class="keyword">new</span> InputStreamReader( connection.getInputStream(), <span class="string">"UTF-8"</span> ) );</div><div class="line">                    PrintWriter writer = <span class="keyword">new</span> PrintWriter(<span class="keyword">new</span> OutputStreamWriter( </div><div class="line">                        connection.getOutputStream(), <span class="string">"UTF-8"</span>), <span class="keyword">true</span>);</div><div class="line"></div><div class="line">                    String receivedLine = <span class="keyword">null</span>;</div><div class="line">                    <span class="keyword">while</span>( ( receivedLine = reader.readLine() ) != <span class="keyword">null</span> ) &#123;</div><div class="line">                        writer.print( receivedLine + <span class="string">"\r\n"</span> );</div><div class="line">                        writer.flush();</div><div class="line">                    &#125;</div><div class="line">                    System.out.println( getName() + <span class="string">" ENDED "</span> );</div><div class="line">                &#125; <span class="keyword">catch</span>( IOException e ) &#123;</div><div class="line">                    System.err.println(getName() + <span class="string">": IO Error on socket "</span> + e);</div><div class="line">                    <span class="keyword">return</span>;</div><div class="line">                &#125; <span class="keyword">finally</span> &#123;</div><div class="line">                    <span class="keyword">try</span> &#123;</div><div class="line">                        <span class="keyword">if</span>( connection != <span class="keyword">null</span> ) &#123;</div><div class="line">                            connection.close();</div><div class="line">                        &#125;</div><div class="line">                    &#125; <span class="keyword">catch</span>( IOException e ) &#123;</div><div class="line">                        System.err.println( getName() + <span class="string">": IO Error when closing socket "</span> + e );</div><div class="line">                        <span class="keyword">return</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="http://www.amazon.com/Java-Cookbook-Ian-F-Darwin/dp/144933704X/ref=sr_1_1?ie=UTF8&amp;qid=1416926568&amp;sr=8-1&amp;keywords=java+cookbook" target="_blank" rel="external">Java Cookbook 3rd Edition</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/10/25/java-thread/" itemprop="url">
                  Java 并发编程（一） -- Fork-Join框架
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-10-25T21:54:55+08:00" content="2014-10-25">
              2014-10-25
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/并发编程/" itemprop="url" rel="index">
                    <span itemprop="name">并发编程</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Fork-Join框架"><a href="#Fork-Join框架" class="headerlink" title="Fork-Join框架"></a>Fork-Join框架</h2><p>　　通常，为了执行计算量较大的任务，可以使用<code>fork-join</code>框架，这能充分利用多核计算机的优势，使程序的计算任务能并行地执行。为实现这个目标，需要使用一个类来表示需要执行的任务，这个类则需要继承自<code>RecursiveTask&lt;T&gt;</code>类或<code>RecursiveAction</code>类，并覆写其<code>compute()</code>方法，这两个类的区别在于，<code>RecursiveTask&lt;T&gt;</code>的<code>compute()</code>方法的返回值类型为<code>T</code>，而<code>RecursiveAction</code>的<code>compute()</code>方法并不返回任何值:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.concurrent.*;</div><div class="line"><span class="keyword">import</span> java.util.function.*;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ForkJoinTest</span></span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">( String[] args )</span> </span>&#123;</div><div class="line">        <span class="keyword">final</span> <span class="keyword">int</span> SIZE = <span class="number">10000000</span>;</div><div class="line">        <span class="keyword">double</span>[] numbers = <span class="keyword">new</span> <span class="keyword">double</span>[SIZE];</div><div class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; SIZE; ++i ) &#123;</div><div class="line">            numbers[i] = Math.random();</div><div class="line">        &#125;</div><div class="line">        Counter counter = <span class="keyword">new</span> Counter( numbers, <span class="number">0</span>, SIZE - <span class="number">1</span>, n -&gt; n &gt; <span class="number">0.5</span> );</div><div class="line">        ForkJoinPool pool = <span class="keyword">new</span> ForkJoinPool();</div><div class="line">        pool.invoke( counter );</div><div class="line">        System.out.println( counter.join() );</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span> <span class="keyword">extends</span> <span class="title">RecursiveTask</span>&lt;<span class="title">Integer</span>&gt; </span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> THRESHOLD = <span class="number">1000</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">double</span>[] values;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> from;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> to;</div><div class="line">    <span class="keyword">private</span> DoublePredicate predicate;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Counter</span><span class="params">( <span class="keyword">double</span>[] values, <span class="keyword">int</span> from, <span class="keyword">int</span> to, DoublePredicate predicate )</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.values = values;</div><div class="line">        <span class="keyword">this</span>.from = from;</div><div class="line">        <span class="keyword">this</span>.to = to;</div><div class="line">        <span class="keyword">this</span>.predicate = predicate;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> Integer <span class="title">compute</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>( to - from &lt; THRESHOLD ) &#123;</div><div class="line">            <span class="keyword">int</span> count = <span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span>( <span class="keyword">int</span> i = from; i &lt;= to; ++i ) &#123;</div><div class="line">                <span class="keyword">if</span>( predicate.test( values[i] ) ) &#123;</div><div class="line">                    ++count;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> count;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">int</span> mid = ( from + to ) / <span class="number">2</span>;</div><div class="line">            Counter first = <span class="keyword">new</span> Counter( values, from, mid, predicate );</div><div class="line">            Counter second = <span class="keyword">new</span> Counter( values, mid + <span class="number">1</span>, to, predicate );</div><div class="line">            invokeAll( first, second );</div><div class="line">            <span class="keyword">return</span> first.join() + second.join();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>　　<code>RecursiveTask&lt;T&gt;</code>和<code>RecursiveAction</code>类的<code>invokeAll()</code>方法:</p>
<pre><code class="java"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">invokeAll</span><span class="params">( ForkJoinTask&lt;?&gt; t1, ForkJoinTask&lt;?&gt; t2 )</span>
<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">invokeAll</span><span class="params">( ForkJoinTask&lt;?&gt;... tasks )</span></span>
</code></pre>
<p>　　<code>invokeAll()</code>方法在调用之后将会一直阻塞，当<code>invokeAll()</code>所调用的所有任务均执行结束之后，<code>invokeAll()</code>方法才会返回。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/8/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/10/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="John Doe" />
          <p class="site-author-name" itemprop="name">John Doe</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">97</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">17</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  




  
  

  

  

  

</body>
</html>
